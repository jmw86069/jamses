<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Jam SummarizedExperiment Stats methods to
   normalize SummarizedExperiment data, define
   experiment design, visualize the experiment design,
   define statistical contrasts,
   perform differential analysis (via other packages).
   S4 object SEDesign enforces relationship between
   individual samples, design groups, and groups involved
   in statistical contrasts.">
<title>Jam SummarizedExperiment Stats • jamses</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Jam SummarizedExperiment Stats">
<meta property="og:description" content="Jam SummarizedExperiment Stats methods to
   normalize SummarizedExperiment data, define
   experiment design, visualize the experiment design,
   define statistical contrasts,
   perform differential analysis (via other packages).
   S4 object SEDesign enforces relationship between
   individual samples, design groups, and groups involved
   in statistical contrasts.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">jamses</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.69.900</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="http://github.com/jmw86069/jamses/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><ul>
<li>
<a href="#jam-summarizedexperiment-stats-jamses">Jam SummarizedExperiment Stats (jamses)</a>
<ul>
<li><a href="#goals-of-jamses">Goals of jamses</a></li>
<li><a href="#approach-for-statistical-contrasts">Approach for Statistical Contrasts</a></li>
<li>
<a href="#design-and-contrasts---sedesign">Design and contrasts - SEDesign</a>
<ul>
<li><a href="#sedesign-s4-object-details">SEDesign S4 Object Details</a></li>
<li><a href="#example-sedesign-object">Example SEDesign object</a></li>
</ul>
</li>
<li><a href="#data-normalization">Data normalization</a></li>
<li>
<a href="#statistical-comparisons">Statistical comparisons</a>
<ul>
<li><a href="#se_contrast_stats-is-the-central-function"><code>se_contrast_stats()</code> is the central function</a></li>
</ul>
</li>
<li><a href="#heatmaps">Heatmaps</a></li>
<li><a href="#future-work">Future work:</a></li>
</ul>
</li>
</ul>
<!-- README.md is generated from README.Rmd. Please edit that file --><div class="section level1">
<div class="page-header"><h1 id="jam-summarizedexperiment-stats-jamses">Jam SummarizedExperiment Stats (jamses)<a class="anchor" aria-label="anchor" href="#jam-summarizedexperiment-stats-jamses"></a>
</h1></div>
<p>This package is under active development, these functions make up a core set of methods currently used across active Omics analysis projects. A summary of goals and relevant features are described below.</p>
<p><a href="https://jmw86069.github.io/jamses" class="external-link">Full jamses command reference</a></p>
<div class="section level2">
<h2 id="goals-of-jamses">Goals of jamses<a class="anchor" aria-label="anchor" href="#goals-of-jamses"></a>
</h2>
<p>The core goal is to make data analysis and visualization of <code>SummarizedExperiment</code> objects straightforward for common scenarios. It also accepts <code>SingleCellExperiment</code> and <code>Seurat</code> objects.</p>
<ul>
<li><p><strong>Define a design matrix</strong> using <code>~ 0 + group</code> syntax, see below.</p></li>
<li><p><strong>Define statistical contrasts</strong> to compare one or more factors, see <code><a href="reference/groups_to_sedesign.html">groups_to_sedesign()</a></code>.</p></li>
<li><p><strong>Plot contrasts</strong> as defined, see <code><a href="reference/plot_sedesign.html">plot_sedesign()</a></code>.</p></li>
<li><p><strong>Confirm design,contrast matrices</strong> are always in sync, see <code>SEDesign-class</code>.</p></li>
<li><p><strong>Automate analysis of multiple contrasts</strong>, using limma/limmavoom/DEqMS, see <code><a href="reference/se_contrast_stats.html">se_contrast_stats()</a></code>.</p></li>
<li>
<p><strong>Convenient “short hand” for contrasts</strong>, see <code>contrasts2comp()</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a> (B_treated<span class="sc">-</span>B_control)<span class="sc">-</span>(A_treated<span class="sc">-</span>A_control)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a> <span class="co"># "comp" format:</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a> B<span class="sc">-</span>A<span class="sc">:</span>treated<span class="sc">-</span>control</span></code></pre></div>
</li>
<li>
<p><strong>Integrate with other tools</strong>.</p>
<ul>
<li>
<code><a href="https://rdrr.io/pkg/venndir/man/venndir.html" class="external-link">venndir::venndir()</a></code> - see Github <code>"jmw86069/venndir"</code> to create directional Venn diagrams.</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="approach-for-statistical-contrasts">Approach for Statistical Contrasts<a class="anchor" aria-label="anchor" href="#approach-for-statistical-contrasts"></a>
</h2>
<p><a href="https://www.bioconductor.org/packages/devel/bioc/vignettes/limma/inst/doc/" class="external-link">The Limma User’s Guide</a> (LUG) is an amazing resource which describes alternate approaches for one-way and two-way contrasts, <strong>which are mathematically equivalent</strong>. For a more thorough discussion please review these approaches to confirm that <code>~0 + x</code> is mathematically identical to <code>~ x</code>, and only differs in how estimates are reported.</p>
<ul>
<li><p>The approach used in <code>jamses</code> uses the <code>~0 + x</code> strategy.<br> Each experiment group is defined using independent replicates.<br> This approach <em>does not imply</em> that there is “no intercept” during the model fit, see LUG for details.</p></li>
<li>
<p>One-way contrasts must compare only one factor change per contrast.<br> For example, a valid one-way contrast is shown below:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>(A_treated <span class="sc">-</span> A_control) <span class="co"># valid one-way contrast</span></span></code></pre></div>
<p>It compares <strong><code>(treated-control)</code></strong> with factor level <strong><code>A</code></strong> unchanged.<br> However, an invalid one-way contrast is shown below:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>(A_treated <span class="sc">-</span> B_control) <span class="co"># not a valid one-way contrast</span></span></code></pre></div>
<p>It is invalid because allows two factor changes: <strong><code>treated-control</code></strong> and <strong><code>A-B</code></strong>.</p>
</li>
<li>
<p>A two-way contrast is defined as the fold change of two <strong><em>compatible</em></strong> one-way fold changes, and in the proper order.<br> Consider the following:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>(A_treated <span class="sc">-</span> A_control)  <span class="co"># one-way contrast</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>                         <span class="co"># "treated-control" for A</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>(B_treated <span class="sc">-</span> B_control)  <span class="co"># compatible one-way contrast</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>                         <span class="co"># "treated-control" for B</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>(B_treated <span class="sc">-</span> B_knockout) <span class="co"># incompatible one-way contrast</span></span></code></pre></div>
</li>
<li><p>Caveat: Specific contrasts can be added manually when necessary.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="design-and-contrasts---sedesign">Design and contrasts - SEDesign<a class="anchor" aria-label="anchor" href="#design-and-contrasts---sedesign"></a>
</h2>
<ul>
<li>
<p><code><a href="reference/groups_to_sedesign.html">groups_to_sedesign()</a></code> takes by default a <code>data.frame</code> where each column represents an experiment factor, and creates the following:</p>
<ul>
<li>
<code>design</code> matrix</li>
<li>
<code>contrast</code> matrix using only appropriate changes in single experiment factor levels for one-way contrasts, and equivalent contrasts across secondary factor levels where appropriate for two-way contrasts, up to <code>max_depth</code> factor depth.</li>
<li>
<code>samples</code> vector representing individual sample columns used from the input data.</li>
</ul>
</li>
<li>
<p>Output is <code>SEDesign</code> as an S4 object with slot names:</p>
<ul>
<li>
<code>sedesign@design</code> - the design matrix.</li>
<li>
<code>sedesign@contrasts</code> - the contrasts matrix.</li>
<li>
<code>sedesign@samples</code> - vector of samples.</li>
</ul>
</li>
</ul>
<div class="section level3">
<h3 id="sedesign-s4-object-details">SEDesign S4 Object Details<a class="anchor" aria-label="anchor" href="#sedesign-s4-object-details"></a>
</h3>
<p><code>SEDesign</code> is an S4 object that contains the following slots:</p>
<ul>
<li>
<p><strong><code>samples</code></strong>: a <code>character</code> vector of sample names, derived from <code><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames()</a></code> of the SummarizedExperiment` object.</p>
<ul>
<li>When <code>samples</code> are subset, it has a cascade effect on <code>design</code> and <code>contrasts</code>. When groups are no longer represented, they are removed from <code>design</code> and <code>contrasts</code> as relevant.</li>
</ul>
</li>
<li>
<p><strong><code>design</code></strong>: a <code>matrix</code> representing the design matrix, with additional constraints:</p>
<ul>
<li>
<code><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames()</a></code> are always maintained, so they can be aligned with <code><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames()</a></code> of the <code>SummarizedExperiment</code> object. This requirement helps ensure that the design and assay data are always in proper sync.</li>
<li>
<code><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames()</a></code> are defined as sample groups, equivalent to using <code>model.matrix( ~ 0 + groups )</code> for example from the <a href="https://www.bioconductor.org/packages/devel/bioc/vignettes/limma/inst/doc/" class="external-link">The Limma User’s Guide</a> from the <code>limma</code> Bioconductor package.</li>
<li>All values are always <code>1</code> or <code>0</code> with no fractions. More complicated designs require manual adjustment, beyond the scope of <code>jamses</code>.</li>
</ul>
</li>
<li>
<p><strong><code>contrasts</code></strong>: a <code>matrix</code> representing the contrast matrix used for statistical comparisons, with additional constraints:</p>
<ul>
<li>
<code>rownames(contrasts)</code> are always defined, and always equal <code>colnames(contrasts)</code> to ensure contrasts and design are always properly synchronized.</li>
</ul>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="example-sedesign-object">Example SEDesign object<a class="anchor" aria-label="anchor" href="#example-sedesign-object"></a>
</h3>
<p>The example below uses a <code>character</code> vector of group names per sample, with two factors separated by underscore <code>"_"</code>. The same data can be provided as a <code>data.frame</code> with two columns.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://github.com/jmw86069/jamses" class="external-link">jamses</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/" class="external-link">kableExtra</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">igroups</span> <span class="op">&lt;-</span> <span class="fu">jamba</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jamba/man/nameVector.html" class="external-link">nameVector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WT"</span>, <span class="st">"KO"</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">6</span><span class="op">)</span>,</span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"Treated"</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>   sep<span class="op">=</span><span class="st">"_"</span><span class="op">)</span>,</span>
<span>   suffix<span class="op">=</span><span class="st">"_rep"</span><span class="op">)</span>;</span>
<span><span class="va">igroups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">igroups</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">igroups</span><span class="op">)</span><span class="op">)</span>;</span>
<span><span class="co"># jamba::kable_coloring(color_cells=FALSE,</span></span>
<span><span class="co">#    format="markdown",</span></span>
<span><span class="co">#    caption="Sample to group association",</span></span>
<span><span class="co">#    data.frame(groups=igroups))</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>groups<span class="op">=</span><span class="va">igroups</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">groups</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">WT_Control_rep1</td>
<td align="left">WT_Control</td>
</tr>
<tr class="even">
<td align="left">WT_Control_rep2</td>
<td align="left">WT_Control</td>
</tr>
<tr class="odd">
<td align="left">WT_Control_rep3</td>
<td align="left">WT_Control</td>
</tr>
<tr class="even">
<td align="left">WT_Treated_rep1</td>
<td align="left">WT_Treated</td>
</tr>
<tr class="odd">
<td align="left">WT_Treated_rep2</td>
<td align="left">WT_Treated</td>
</tr>
<tr class="even">
<td align="left">WT_Treated_rep3</td>
<td align="left">WT_Treated</td>
</tr>
<tr class="odd">
<td align="left">KO_Control_rep1</td>
<td align="left">KO_Control</td>
</tr>
<tr class="even">
<td align="left">KO_Control_rep2</td>
<td align="left">KO_Control</td>
</tr>
<tr class="odd">
<td align="left">KO_Control_rep3</td>
<td align="left">KO_Control</td>
</tr>
<tr class="even">
<td align="left">KO_Treated_rep1</td>
<td align="left">KO_Treated</td>
</tr>
<tr class="odd">
<td align="left">KO_Treated_rep2</td>
<td align="left">KO_Treated</td>
</tr>
<tr class="even">
<td align="left">KO_Treated_rep3</td>
<td align="left">KO_Treated</td>
</tr>
</tbody>
</table>
<p>The resulting design and contrasts matrices are shown below:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sedesign</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/groups_to_sedesign.html">groups_to_sedesign</a></span><span class="op">(</span><span class="va">igroups</span><span class="op">)</span>;</span>
<span><span class="fu">jamba</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jamba/man/kable_coloring.html" class="external-link">kable_coloring</a></span><span class="op">(</span></span>
<span><span class="co"># knitr::kable(</span></span>
<span>   colorSub<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>`-1`<span class="op">=</span><span class="st">"dodgerblue"</span>, `1`<span class="op">=</span><span class="st">"firebrick"</span><span class="op">)</span>,</span>
<span>   caption<span class="op">=</span><span class="st">"Design matrix output from design(sedesign)."</span>,</span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>check.names<span class="op">=</span><span class="cn">FALSE</span>, <span class="fu">design</span><span class="op">(</span><span class="va">sedesign</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>;</span></code></pre></div>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<caption>
Design matrix output from design(sedesign).
</caption>
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
WT_Control
</th>
<th style="text-align:right;">
WT_Treated
</th>
<th style="text-align:right;">
KO_Control
</th>
<th style="text-align:right;">
KO_Treated
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;">
WT_Control_rep1
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(255, 255, 255, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: firebrick !important;">1</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
</tr>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;">
WT_Control_rep2
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(255, 255, 255, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: firebrick !important;">1</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
</tr>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;">
WT_Control_rep3
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(255, 255, 255, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: firebrick !important;">1</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
</tr>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;">
WT_Treated_rep1
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(255, 255, 255, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: firebrick !important;">1</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
</tr>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;">
WT_Treated_rep2
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(255, 255, 255, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: firebrick !important;">1</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
</tr>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;">
WT_Treated_rep3
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(255, 255, 255, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: firebrick !important;">1</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
</tr>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;">
KO_Control_rep1
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(255, 255, 255, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: firebrick !important;">1</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
</tr>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;">
KO_Control_rep2
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(255, 255, 255, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: firebrick !important;">1</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
</tr>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;">
KO_Control_rep3
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(255, 255, 255, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: firebrick !important;">1</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
</tr>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;">
KO_Treated_rep1
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(255, 255, 255, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: firebrick !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;">
KO_Treated_rep2
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(255, 255, 255, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: firebrick !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;">
KO_Treated_rep3
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(255, 255, 255, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: firebrick !important;">1</span>
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># knitr::kable(</span></span>
<span><span class="fu">jamba</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jamba/man/kable_coloring.html" class="external-link">kable_coloring</a></span><span class="op">(</span></span>
<span>   colorSub<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>`-1`<span class="op">=</span><span class="st">"dodgerblue"</span>, `1`<span class="op">=</span><span class="st">"firebrick"</span><span class="op">)</span>,</span>
<span>   caption<span class="op">=</span><span class="st">"Contrast matrix output from contrasts(sedesign)."</span>,</span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>check.names<span class="op">=</span><span class="cn">FALSE</span>, <span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></span><span class="op">(</span><span class="va">sedesign</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>;</span></code></pre></div>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<caption>
Contrast matrix output from contrasts(sedesign).
</caption>
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
KO_Control-WT_Control
</th>
<th style="text-align:right;">
KO_Treated-WT_Treated
</th>
<th style="text-align:right;">
WT_Treated-WT_Control
</th>
<th style="text-align:right;">
KO_Treated-KO_Control
</th>
<th style="text-align:right;">
(KO_Treated-WT_Treated)-(KO_Control-WT_Control)
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;">
WT_Control
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(255, 255, 255, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: dodgerblue !important;">-1</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(255, 255, 255, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: dodgerblue !important;">-1</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(255, 255, 255, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: firebrick !important;">1</span>
</td>
</tr>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;">
WT_Treated
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(255, 255, 255, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: dodgerblue !important;">-1</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(255, 255, 255, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: firebrick !important;">1</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(255, 255, 255, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: dodgerblue !important;">-1</span>
</td>
</tr>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;">
KO_Control
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(255, 255, 255, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: firebrick !important;">1</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(255, 255, 255, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: dodgerblue !important;">-1</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(255, 255, 255, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: dodgerblue !important;">-1</span>
</td>
</tr>
<tr>
<td style="text-align:left;border-left:1px solid #DDDDDD;white-space: nowrap;">
KO_Treated
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(255, 255, 255, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: firebrick !important;">1</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(0, 0, 0, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: transparent !important;">0</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(255, 255, 255, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: firebrick !important;">1</span>
</td>
<td style="text-align:right;border-left:1px solid #DDDDDD;white-space: nowrap;">
<span style="     color: rgba(255, 255, 255, 255) !important;border-radius: 4px; padding-right: 4px; padding-left: 4px; background-color: firebrick !important;">1</span>
</td>
</tr>
</tbody>
</table>
<p>For convenience, SEDesign can be visualized using <code><a href="reference/plot_sedesign.html">plot_sedesign()</a></code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot the design and contrasts</span></span>
<span><span class="fu"><a href="reference/plot_sedesign.html">plot_sedesign</a></span><span class="op">(</span><span class="va">sedesign</span><span class="op">)</span>;</span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span>main<span class="op">=</span><span class="st">"plot_sedesign(sedesign)\noutput:"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-plot_sedesign-1.png"><!-- --></p>
<ul>
<li>Two-way contrasts are indicated by the “squiggly curved line” which connects the end of one contrast to the beginning of the next contrast. This connection describes the first contrast, subtracted by the second contrast.</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="data-normalization">Data normalization<a class="anchor" aria-label="anchor" href="#data-normalization"></a>
</h2>
<p><code>SummarizedExperiment</code> objects are normalized using:</p>
<ul>
<li>
<p><code><a href="reference/se_normalize.html">se_normalize()</a></code> - lightweight wrapper to several normalization functions:</p>
<ul>
<li>
<code>method="jammanorm"</code>: calls <code><a href="https://rdrr.io/pkg/jamma/man/jammanorm.html" class="external-link">jamma::jammanorm()</a></code> which normalizes the median log fold change to zero. This method is also used in <code>DESeq2::estimateSizeFactors()</code> for example. When using <code><a href="https://rdrr.io/pkg/jamma/man/jammaplot.html" class="external-link">jamma::jammaplot()</a></code> for MA-plots, the <code>jammanorm()</code> method is conceptually equivalent to shifting the y-axis values to zero, so the median log fold change is zero. (Assumptions apply.)</li>
<li>
<code>method="quantile</code>: calls <code><a href="https://rdrr.io/pkg/limma/man/normalizequantiles.html" class="external-link">limma::normalizeQuantiles()</a></code> for quantile normalization.</li>
<li>
<code>method="limma_batch_adjust"</code> or <code>method="lba"</code>: calls <code><a href="https://rdrr.io/pkg/limma/man/removeBatchEffect.html" class="external-link">limma::removeBatchEffect()</a></code> to adjust of batch effects. This normalization is only recommended for visualization and clustering, not recommended prior to statistical comparisons. Instead, the recommendation is to define a blocking factor passed to <code><a href="reference/se_contrast_stats.html">se_contrast_stats()</a></code> with argument <code>block</code>.</li>
</ul>
</li>
<li><p><code><a href="reference/matrix_normalize.html">matrix_normalize()</a></code> - is the core function for <code><a href="reference/se_normalize.html">se_normalize()</a></code> and operates on individual numeric data matrices.</p></li>
</ul>
<blockquote>
<p>Normalization can be reviewed with MA-plots, recommended by using <code><a href="https://rdrr.io/pkg/jamma/man/jammaplot.html" class="external-link">jamma::jammaplot()</a></code>. See Github repository <code>"jmw86069/jamma"</code>.</p>
</blockquote>
</div>
<div class="section level2">
<h2 id="statistical-comparisons">Statistical comparisons<a class="anchor" aria-label="anchor" href="#statistical-comparisons"></a>
</h2>
<div class="section level3">
<h3 id="se_contrast_stats-is-the-central-function">
<code>se_contrast_stats()</code> is the central function<a class="anchor" aria-label="anchor" href="#se_contrast_stats-is-the-central-function"></a>
</h3>
<ul>
<li><p>Applies <code>SEDesign</code> (design and contrasts) to <code>SummarizedExperiment</code> data.</p></li>
<li>
<p>Calls the appropriate <code>limma</code> functions one or more <code>assays</code> in the <code>SummarizedExperiment</code> object.</p>
<ul>
<li>
<code>use_voom=TRUE</code> will enable <code>limmavoom</code> methodology for count data.</li>
<li>
<code>posthoc_test="DEqMS"</code> will enable <code>limma-DEqMS</code> methodology for proteomics mass spec data, which defines an error model based upon PSM counts per row.</li>
<li>
<code>block</code> will define blocking factor for <code>limma</code>. When also applying <code>limmavoom</code>, it performs the appropriate two-step process as described by Dr. Smyth.</li>
</ul>
</li>
<li>
<p>Applies statistical thresholds to mark statistical hits:</p>
<ul>
<li>
<code>adjp_cutoff</code>: adjusted P-value threshold</li>
<li>
<code>fold_cutoff</code>: normal space fold change threshold</li>
<li>
<code>mgm_cutoff</code>: “mgm” is an abbreviation for “max group mean”. This threshold requires at least one experiment group involved in the contrast to have group mean at or above this threshold in order to mark a statistical hit. It does not subset data prior to testing.</li>
</ul>
</li>
<li>
<p>Additional threshold options:</p>
<ul>
<li>
<code>p_cutoff</code>: unadjusted P-value threshold</li>
<li>
<code>ave_cutoff</code>: average expression threshold, using the equivalent of <code>limma</code> column <code>AveExpr</code> with the mean group expression. Note this <code>AveExpr</code> value is calculated mean per row across all groups, and may be subject to skewing.</li>
<li>
<code>int_adjp_cutoff</code>, <code>int_fold_cutoff</code>, <code>int_mgm_cutoff</code>: optional thresholds only used for interaction contrasts, intended for data mining purposes. For example, data mining may filter for two-way contrast results with no fold change threshold, or slightly relaxed <code>int_adjp_cutoff=0.1</code>.</li>
</ul>
</li>
<li>
<p>Options:</p>
<ul>
<li>
<code>use_voom=TRUE</code>: enable limmavoom workflow for count data</li>
<li>
<code>posthoc_test="DEqMS"</code>: enable DEqMS post-hoc adjustment to the limma empirical Bayes model fit.</li>
<li>
<code>floor_min</code>, <code>floor_value</code>: logic to handle numeric values below a defined noise threshold, values below this threshold become <code>floor_value</code>. This filtering can also convert values from <code>0</code> zero to <code>NA</code>, where appropriate. For data with substantial missing measurements, this option may be beneficial.</li>
<li>
<code>handle_na</code>, <code>na_value</code>: logic to handle <code>NA</code> values, particularly when an entire group is <code>NA</code>. For proteomics, or platforms with a defined “noise floor”, it may be useful to use <code>handle_na="full1"</code> and <code>na_value=noise_floor</code>. This specific scenario assigns <code>noise_floor</code> to one value in any completely <code>NA</code> group to <code>noise_floor</code> so that its variability is not used, however the fold change can still be calculated relative to the platform minimum signal</li>
<li>
<code>block</code>: optional blocking factor, which enables the <code><a href="https://rdrr.io/pkg/limma/man/dupcor.html" class="external-link">limma::duplicateCorrelation()</a></code> calculation, which is applied to the model fit per the <a href="https://www.bioconductor.org/packages/devel/bioc/vignettes/limma/inst/doc/" class="external-link">The Limma User’s Guide</a>.</li>
</ul>
</li>
<li>
<p>Returns a <code>list</code> referred to as <code>sestats</code>:</p>
<ul>
<li>
<p><code>"hit_array"</code>: <code>array</code> of named numeric vectors indicating direction of statistical hits after applying the relevant threshold cutoffs:</p>
<ul>
<li>
<code>1</code> up-regulated</li>
<li>
<code>-1</code> down-regulated</li>
</ul>
</li>
<li><p><code>"stats_dfs"</code>: <code>list</code> of <code>data.frame</code> for each contrast, where column headers also include the statistical contrast to help confirm the identity of each analysis result.</p></li>
<li><p><code>"stats_df"</code>: one super-wide <code>data.frame</code> with results across all contrasts, assay data matrices, and hit thresholds. This matrix is intended to help filter for hits across the various different contrasts and thresholds.</p></li>
</ul>
</li>
<li>
<p>Save to excel with <code><a href="reference/save_sestats.html">save_sestats()</a></code>:</p>
<ul>
<li>This function helps automate saving every statistical contrast in table format, into individual Excel worksheets. It may include additional <code>rowData()</code> annotations.</li>
<li>Each worksheet is styled consistently, making it easy to flip through each worksheet.</li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="heatmaps">Heatmaps<a class="anchor" aria-label="anchor" href="#heatmaps"></a>
</h2>
<p><code><a href="reference/heatmap_se.html">heatmap_se()</a></code> is a wrapper for the amazing <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code>, intended to automate frequently-used options that represent repetitive work.</p>
<p>Common rules:</p>
<ul>
<li>All data is centered by default. It can be customized.</li>
<li>All data is assumed to be <code>log2</code> or otherwise “appropriately transformed”. (The typical transform is <code>log2(1 + x)</code>.)</li>
<li>The heatmap can also be displayed as sample correlations (<code>correlation=TRUE</code>) which re-uses the same data centering options (critical aspect of these plots).</li>
<li>The heatmap can be subset using <code>rows</code> or <code>sestats</code> to show stat hit annotations on the left side.</li>
<li>Column and row annotations can be added using <code>colData(se)</code> and <code>rowData(se)</code>
</li>
<li>Columns and rows can be split using <code>colData(se)</code> and <code>rowData(se)</code> colnames.</li>
<li>The heatmap title includes a summary of data.</li>
</ul>
<p>Common arguments:</p>
<ul>
<li><p><code>se</code>: the <code>SummarizedExperiment</code> data for the heatmap</p></li>
<li><p><code>assay_name</code>: define a specific data matrix to display</p></li>
<li><p><code>rows</code>: choose a specific subset of rows (optional)</p></li>
<li>
<p><code>sestats</code>: optional stat hits in one of these formats:</p>
<ul>
<li>output from <code><a href="reference/se_contrast_stats.html">se_contrast_stats()</a></code>
</li>
<li>incidence <code>matrix</code> with values <code>c(-1, 0, 1)</code>
</li>
<li>
<code>list</code> of numeric values using <code>c(-1, 0, 1)</code>, with names representing <code>rownames(se)</code>
</li>
<li>
<code>list</code> of <code>rownames(se)</code>
</li>
</ul>
</li>
<li><p><code>top_colnames</code>: column annotations in <code>colData(se)</code> to display across the top.</p></li>
<li><p><code>rowData_colnames</code>: optional row annotations to display on the left.</p></li>
<li><p><code>sample_color_list</code>: <code>list</code> named by colnames from <code>colData(se)</code> or <code>rowData(se)</code> to define colors.</p></li>
<li>
<p><code>centerby_colnames</code>: optional sub-groups for data centering</p>
<ul>
<li>Useful to center multiple tissue types, or sample classes, batches, etc.</li>
<li>Set <code>centerby_colnames=FALSE</code> to turn off data centering altogether.</li>
</ul>
</li>
<li><p><code>controlSamples</code>: custom subset of control samplesfor data centering.</p></li>
<li><p><code>row_split</code>: split rows using colnames in <code>rowData(se)</code>, or by number of dendrogram sub-tree clusters.</p></li>
<li><p><code>column_split</code>: split columns using colnames in <code>colData(se)</code>, or by number of dendrogram sub-tree clusters.</p></li>
<li><p><code>mark_rows</code>: optional subset of rows for callout labels.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="future-work">Future work:<a class="anchor" aria-label="anchor" href="#future-work"></a>
</h2>
<ul>
<li>Convert <code>sestats</code> to proper <code>SEStats</code> S4 object, with convenient accessor functions.</li>
<li>Enable equivalent analysis using <code>DESeq2</code> or <code>edgeR</code> methodology.</li>
</ul>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="http://github.com/jmw86069/jamses/" class="external-link">Browse source code</a></li>
<li><a href="http://github.com/jmw86069/jamses/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing jamses</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>James M. Ward <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by James M. Ward.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
