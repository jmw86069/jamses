<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Mark statistical hits by threshold cutoffs — mark_stat_hits • jamses</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Mark statistical hits by threshold cutoffs — mark_stat_hits"><meta property="og:description" content="Mark statistical hits by threshold cutoffs"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">jamses</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.48.900</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="http://github.com/jmw86069/jamses/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Mark statistical hits by threshold cutoffs</h1>
    <small class="dont-index">Source: <a href="http://github.com/jmw86069/jamses/blob/HEAD/R/jam_statutil.R" class="external-link"><code>R/jam_statutil.R</code></a></small>
    <div class="hidden name"><code>mark_stat_hits.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Mark statistical hits by threshold cutoffs</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">mark_stat_hits</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  adjp_cutoff <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  p_cutoff <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fold_cutoff <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mgm_cutoff <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ave_cutoff <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  adjp_colname <span class="op">=</span> <span class="st">"adj.P.Val"</span>,</span>
<span>  p_colname <span class="op">=</span> <span class="st">"P.Value"</span>,</span>
<span>  logfc_colname <span class="op">=</span> <span class="st">"logFC"</span>,</span>
<span>  mgm_colname <span class="op">=</span> <span class="st">"mgm"</span>,</span>
<span>  ave_colname <span class="op">=</span> <span class="st">"AveExpr"</span>,</span>
<span>  assign_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sign"</span>, <span class="st">"fold"</span>, <span class="st">"logfc"</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p><code>data.frame</code> containing one or more statistical columns</p></dd>


<dt>adjp_cutoff, p_cutoff, fold_cutoff, mgm_cutoff, ave_cutoff</dt>
<dd><p><code>numeric</code>
value for each cutoff to be enforced, or <code>NULL</code> or <code>NA</code> to ignore
each threshold. Each argument must have only 1 value assigned to
be enforced.</p></dd>


<dt>adjp_colname, p_colname, logfc_colname, mgm_colname, ave_colname</dt>
<dd><p><code>character</code> string for each colname in <code>x</code> to be used for the
appropriate statistical threshold.</p></dd>


<dt>assign_value</dt>
<dd><p><code>character</code> string indicating the value assigned
to hits: <code>"sign"</code> uses the sign of the log2 fold change; <code>"fold"</code>
uses the normal space fold change, by <code><a href="log2fold_to_fold.html">log2fold_to_fold()</a></code>;
<code>"logfc"</code> uses the log2 fold change value. If there is no
matching colname for <code>logfc_colname</code> then all hits are assigned <code>1</code>.
In all cases, entries which are not hits are assigned <code>0</code>.</p></dd>


<dt>verbose</dt>
<dd><p><code>logical</code> indicating whether to print verbose output.</p></dd>


<dt>...</dt>
<dd><p>additional arguments are ignored.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p><code>numeric</code> vector with length <code>nrow(x)</code> and values
defined by argument <code>assign_value</code>. The order is identical
to the order of rows in <code>x</code> input. The output vector
will be named by <code>rownames(x)</code> if rownames exist.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function is lightweight method of applying one or more
statistical thresholds to define "statistical hits". The
thresholds are based upon three questions:</p><ul><li><p>Is it "detected"? (above minimum signal)</p></li>
<li><p>Is it "changing"? (above minimum fold change)</p></li>
<li><p>Is it "significant"? (below defined P-value threshold)</p></li>
</ul><p>The reasoning is roughly described:</p><ul><li><p>If the signal for a measurement is not above a noise threshold,
or above a defined level of signature required for adequate
confirmation experiments, the other statistical measurements
are not relevant.</p></li>
<li><p>If the change between two experimental groups is not sufficient
for follow-up experiments, or is below a biologically meaningful
level of change, the other statistical measures are not relevant.</p></li>
<li><p>If the signal is detected, and the change is potentially sufficient
for follow-up confirmation experiments, and/or to induce biologically
meaningful effects, it must also be statistically robust as
defined by the relevant adjusted P-value.</p></li>
</ul><p>These thresholds are dependent upon the experiment itself,
and each threshold, if used, must be well-defined and defensible.</p>
<p>That is, in order to define a signal threshold, one should evaluate
the level of noise below which a measured value is no longer
sufficient for follow-up experiments, or no longer reliable
based upon the technology being used.</p>
<p>In order to impost a minimum fold change threshold, one should
have some clear indication of any limitations in follow-up assay
techniques, and some indication of the magnitude of change expected
for a biologically meaningful response. In some cases, a biologically
meaningful change may be defined in other experiments, ideally showing
small changes not associated with biologically meaningful effects
and changes which are associated with biollogically meaningful effects.</p>
<p>A useful technique to review statistical thresholds is a volcano plot,
which depicts the relationship of log fold change versus adjusted P-value.
The plot can indicate the range of fold changes for which the statistical
model found significance. Some technologies or protocols naturally
compress the effective fold change, yielding a very narrow volcano plot,
while others with high variability may result in a relatively short
and wide volcano plot. The range of fold changes with no significant
P-value may indicate a reasonable expectation for inherent variability,
thus a fold change threshold may be defined above that observed for
the majority of non-significant entries.</p>
<p>Entries which meet the statistical criteria are marked:</p><ul><li><p><code>-1</code> for entries that meet all criteria, with negative fold change</p></li>
<li><p><code>0</code> for entries that do not meet all thresholds</p></li>
<li><p><code>1</code> for entries that meet all criteria, with positive fold change</p></li>
</ul><p>"Detected" is defined either by the "max group mean", representing
the highest group mean signal intensity, or by "average signal",
representing the average group mean signal intensity across all
groups. These columns should already be present in the input
data <code>x</code>.</p>
<p>"Changing" is defined by the log2 fold change, which must
meet the criteria defined by <code>fold_cutoff</code> which is in normal
space. For example, <code>fold_cutoff=1.5</code> represents 1.5-fold change,
and would be applied <code>abs(log2fc) &gt;= log2(fold_cutoff)</code>. Most
statistical results are reported using log2 fold change, but
scientists usually define fold changes in normal space.</p>
<p>"Significant" is define using the P-value, and/or adjusted P-value,
and requires entries to be at or below the threshold.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other jamses utilities: 
<code><a href="fold_to_log2fold.html">fold_to_log2fold</a>()</code>,
<code><a href="log2fold_to_fold.html">log2fold_to_fold</a>()</code>,
<code><a href="se_collapse_by_column.html">se_collapse_by_column</a>()</code>,
<code><a href="se_collapse_by_row.html">se_collapse_by_row</a>()</code>,
<code><a href="shrinkDataFrame.html">shrinkDataFrame</a>()</code>,
<code><a href="shrink_df.html">shrink_df</a>()</code>,
<code><a href="strsplitOrdered.html">strsplitOrdered</a>()</code>,
<code><a href="update_function_params.html">update_function_params</a>()</code>,
<code><a href="update_list_elements.html">update_list_elements</a>()</code></p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by James M. Ward.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

