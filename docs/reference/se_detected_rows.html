<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="SummarizedExperiment heuristics to define detected rows"><title>SummarizedExperiment heuristics to define detected rows — se_detected_rows • jamses</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="SummarizedExperiment heuristics to define detected rows — se_detected_rows"><meta property="og:description" content="SummarizedExperiment heuristics to define detected rows"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">jamses</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.69.900</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="http://github.com/jmw86069/jamses/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>SummarizedExperiment heuristics to define detected rows</h1>
      <small class="dont-index">Source: <a href="http://github.com/jmw86069/jamses/blob/HEAD/R/jam_se_detectrows.R" class="external-link"><code>R/jam_se_detectrows.R</code></a></small>
      <div class="d-none name"><code>se_detected_rows.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>SummarizedExperiment heuristics to define detected rows</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">se_detected_rows</span><span class="op">(</span></span>
<span>  <span class="va">se</span>,</span>
<span>  assay_name <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">group_colnames</span>,</span>
<span>  normgroup_colname <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  detect_mincounts <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  detect_totalreps <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  detect_minreps <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  detect_minpct <span class="op">=</span> <span class="fl">0.65</span>,</span>
<span>  detect_mingroups <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  isamples <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>se</dt>
<dd><p><code>SummarizedExperiment</code> object</p></dd>


<dt>assay_name</dt>
<dd><p><code>character</code> or <code>integer</code> index, referring to the
entry in <code>assays(se)</code> to use when determining valid measurements.</p></dd>


<dt>group_colnames</dt>
<dd><p><code>character</code> vector of colnames in <code>colData(se)</code> which
defines sample grouping.</p></dd>


<dt>normgroup_colname</dt>
<dd><p><code>character</code> string with optional colname
in <code>colData(se)</code> to use for normgroups.</p></dd>


<dt>detect_mincounts</dt>
<dd><p><code>numeric</code> value at or above which a measurement
is considered "valid".</p></dd>


<dt>detect_totalreps</dt>
<dd><p><code>numeric</code> minimum total number of replicates
that must contain "valid" measurements.</p></dd>


<dt>detect_minreps</dt>
<dd><p><code>numeric</code> minimum replicates which must contain
"valid" measurements in any given sample group.</p></dd>


<dt>detect_minpct</dt>
<dd><p><code>numeric</code> minimum fraction of available replicates
in a sample group that must contain "valid" measurements.</p></dd>


<dt>detect_mingroups</dt>
<dd><p><code>numeric</code> minimum number of sample groups that
are considered "valid" based upon other criteria.</p></dd>


<dt>isamples</dt>
<dd><p><code>character</code> optional vector of <code>colnames(se)</code> to use
during this analysis. This vector is useful for example, when excluding
outlier samples that were defined by other methods.</p></dd>


<dt>verbose</dt>
<dd><p><code>logical</code> indicating whether to print verbose output.</p></dd>


<dt>...</dt>
<dd><p>additional arguments are ignored.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>list</code> with the following elements:</p><ul><li><p><code>detected_rows</code> is a <code>character</code> vector of detected <code>rownames(se)</code></p></li>
<li><p><code>detected_normgroup</code> is a <code>list</code> of <code>logical</code> vectors for each normgroup,
where the vectors encode whether a row is detected within each normgroup.</p></li>
<li><p><code>detected_df</code> is a <code>data.frame</code> with summary information for each
normgroup.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function is intended to help apply common logical rules
to define valid, "detected" rows for downstream analysis.</p>
<p>The rules:</p><ul><li><p>minimum value at or above which a measurement is "valid"</p></li>
<li><p>minimum total replicates with "valid" measurement, across all sample columns</p></li>
<li><p>minimum replicates with "valid" measurement required in any sample group</p></li>
<li><p>minimum percent replicates with "valid" measurement required in any sample group</p></li>
<li><p>minimum sample groups with "valid" criteria above required</p></li>
</ul><div class="section">
<h3 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a></h3>


<p>Consider an experiment with 7 groups, and n=3 replicates, which
contains 21 total samples.</p>
<p>Assume one row of data that contains 6 "valid" measurements.</p><ul><li><p>If these 6 "valid" measurements are found in only 2 groups,
both groups contain n=3 "valid" measurements. This row may have
sufficient data for a statistical comparison across these two groups.</p></li>
<li><p>However, if the 6 "valid" measurements are also found across
6 different groups, it may not be suitable for statistical testing.</p></li>
</ul></div>

<div class="section">
<h3 id="use-of-normgroups">Use of normgroups<a class="anchor" aria-label="anchor" href="#use-of-normgroups"></a></h3>


<p>Detection can be carried out within <code>"normgroups"</code>, which are
independent subsets of sample columns. In most cases this method
is not necessary, but is intended when the detected rows should
be independently calculated for two or more subsets of sample
columns.</p>
<p>A specific example might be an experiment that measures treatment
effects in two very different tissue types, like lung and muscle.
The detected genes in lung may well not be the same as detected
genes in lung. And in fact, statistical comparisons may not be intended
to compare muscle and lung directly. (That judgement is left
to the analyst.) One may define a column in <code>colData(se)</code> that represents
tissue type, with values <code>"muscle"</code>, and <code>"lung"</code>, then define
this column with argument <code>normgroup_colname</code>. The detection will
be done within each independent normgroup, returned as a <code>list</code>
named <code>"detected_normgroup"</code>. The detected rows are also combined
into <code>"detected_rows"</code> which returns rows detected across
all normgroups.</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other jamses SE utilities: 
<code><a href="make_se_test.html">make_se_test</a>()</code>,
<code><a href="se_collapse_by_column.html">se_collapse_by_column</a>()</code>,
<code><a href="se_collapse_by_row.html">se_collapse_by_row</a>()</code>,
<code><a href="se_normalize.html">se_normalize</a>()</code>,
<code><a href="se_rbind.html">se_rbind</a>()</code>,
<code><a href="se_to_rowcoldata.html">se_to_rowcoldata</a>()</code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by James M. Ward.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

