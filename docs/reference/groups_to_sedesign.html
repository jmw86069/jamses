<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Create SEDesign from experimental groups — groups_to_sedesign • jamses</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Create SEDesign from experimental groups — groups_to_sedesign"><meta property="og:description" content="Create SEDesign from experimental groups"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">jamses</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.48.900</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="http://github.com/jmw86069/jamses/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Create SEDesign from experimental groups</h1>
    <small class="dont-index">Source: <a href="http://github.com/jmw86069/jamses/blob/HEAD/R/jam_groupstosedesign.R" class="external-link"><code>R/jam_groupstosedesign.R</code></a></small>
    <div class="hidden name"><code>groups_to_sedesign.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Create SEDesign from experimental groups</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">groups_to_sedesign</span><span class="op">(</span></span>
<span>  <span class="va">ifactors</span>,</span>
<span>  group_colnames <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  isamples <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  idesign <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  factor_order <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  omit_grep <span class="op">=</span> <span class="st">"[-,]"</span>,</span>
<span>  max_depth <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  factor_sep <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>  contrast_sep <span class="op">=</span> <span class="st">"-"</span>,</span>
<span>  remove_pairs <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pre_control_terms <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  add_contrastdf <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  contrast_names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  current_depth <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  rename_first_depth <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  return_sedesign <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  default_order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"asis"</span>, <span class="st">"sort_samples"</span>, <span class="st">"mixedSort"</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>ifactors</dt>
<dd><p><code>data.frame</code> or <code>character</code> vector.</p><ul><li><p>When <code>data.frame</code> is supplied, each column is used as a
design factor, and rownames are recognized as sample identifiers.</p></li>
<li><p>When <code>character</code> vector is supplied, it is converted to
<code>data.frame</code> by splitting values with a delimiter
<code>factor_sep</code>, and names are recognized as sample identifiers.</p></li>
</ul></dd>


<dt>group_colnames</dt>
<dd><p><code>character</code> vector or <code>NULL</code>, used to
define a subset of columns to use when <code>ifactors</code> is supplied
as a <code>data.frame</code>. When <code>ifactors</code> is supplied as a <code>character</code>
vector, this argument is used to define the <code>colnames</code>.</p></dd>


<dt>isamples</dt>
<dd><p><code>character</code> vector or <code>NULL</code>, optionally used to subset
the sample identifiers used in subsequent steps. Note that only
groups and contrasts that contain samples will be defined.</p></dd>


<dt>idesign</dt>
<dd><p><code>numeric</code> matrix or <code>NULL</code>, intended as an optional
method to use an existing design matrix.</p></dd>


<dt>factor_order</dt>
<dd><p><code>integer</code> or <code>character</code> vector, used to define a
specific order of factors when generating contrasts,  useful
when there are multiple experimental factors.
It can be helpful to force a secondary factor to be
compared before a primary factor especially in two-way contrasts.
Note that <code>factor_order</code> refers to the columns (factors) and not
the factor levels (not column values).</p></dd>


<dt>omit_grep</dt>
<dd><p><code>character</code> regular expression pattern used to
exclude secondary factors from contrasts.</p></dd>


<dt>max_depth</dt>
<dd><p><code>integer</code> value indicating the maximum depth of
statistical contrasts to create. For example <code>max_depth=2</code> will
allow two-way contrasts, and <code>max_depth=1</code> will only create
one-way contrasts.</p></dd>


<dt>factor_sep</dt>
<dd><p><code>character</code> string used as a
delimiter to separate experimental factors, when recognizing
or creating experimental group names.</p></dd>


<dt>contrast_sep</dt>
<dd><p><code>character</code> string used as a
delimiter to separate groups within each contrast name.</p></dd>


<dt>remove_pairs</dt>
<dd><p><code>list</code> of <code>character</code> vectors of factors
that should not be compared. Each <code>character</code> vector should
contain two factor levels for any given experimental factor,
where those two factor levels should not be compared in
the same pairwise contrast. For example, consider an experimental
factor defined <code>treatment &lt;- c("control", "dex", "compoundx")</code>.
To prevent a direct comparison of <code>"dex"</code> to <code>"compoundx"</code>,
use argument <code>remove_pairs=list(c("dex", "compoundx"))</code>.</p></dd>


<dt>pre_control_terms</dt>
<dd><p><code>character</code> vector used to
place factor levels first in the order of levels, so these
terms will be the denominator for contrasts. This approach
is useful when the input <code>ifactors</code> does not already contain
a <code>factor</code> with a specific order of factor levels.</p></dd>


<dt>add_contrastdf</dt>
<dd><p><code>data.frame</code> or <code>character</code> or <code>NULL</code>,
intended to include a specific contrast in the output.
This argument is typically used during iterative processing,
and is not usually user-defined. It must contain</p></dd>


<dt>contrast_names</dt>
<dd><p><code>character</code> optional vector of specific
contrasts to use when creating the contrast matrix. When
<code>contrast_names=NULL</code> as default, the function defines contrasts
using its internal logic. When <code>contrast_names</code> is supplied,
only these <code>contrast_names</code> are used, with no other contrasts.</p></dd>


<dt>current_depth</dt>
<dd><p><code>integer</code> value used during iterative
operations of this function.</p></dd>


<dt>rename_first_depth</dt>
<dd><p><code>logical</code> value used during iterative
operations of this function.</p></dd>


<dt>return_sedesign</dt>
<dd><p><code>logical</code> used during iterative
operations of this function. When <code>return_sedesign=FALSE</code>
this function returns a <code>list</code>:</p><ul><li><p><code>"contrast_df"</code>: a <code>data.frame</code> as used in argument
<code>add_contrastdf</code>, which describes each unique contrast.</p></li>
<li><p><code>"contrast_names"</code>: a <code>character</code> vector of contrast names,
which become <code><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames()</a></code> of the contrast matrix.</p></li>
<li><p><code>"idesign"</code>: a <code>numeric</code> design matrix as defined by the input data,
suitable for debugging purposes for example.</p></li>
</ul></dd>


<dt>verbose</dt>
<dd><p><code>logical</code> indicating whether to print verbose output.</p></dd>


<dt>...</dt>
<dd><p>additional arguments are ignored.</p></dd>


<dt>make_unique</dt>
<dd><p><code>logical</code> indicating whether to make output
contrasts unique.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p><code>SEDesign</code> object with the following slots:</p><ul><li><p><code>design</code>: <code>numeric</code> matrix with sample-to-group association</p></li>
<li><p><code>contrasts</code>: <code>numeric</code> matrix with group-to-contrast association</p></li>
<li><p><code>samples</code>: <code>character</code> vector that represents individual sample
replicates, equivalent to <code><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames()</a></code> of the <code>design</code> matrix.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function creates <code>SEDesign</code> with appropriate design
and contrasts, based upon experimental groups.
This approach will use multiple experimental factors
to create appropriate one-way and n-way contrasts,
where each contrast represents a symmetric comparison
of each independent factor.</p>
<p>Input can be provided in one of two ways:</p><ol><li><p><code>SummarizedExperiment</code> where experiment design is derived from
<code><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">SummarizedExperiment::colData()</a></code> of the <code>se</code> object, and
uses columns defined by <code>group_colnames</code>. This input should be
equivalent to providing a <code>data.frame</code> whose <code><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames()</a></code> are
equal to <code>colnames(se)</code>.</p></li>
<li><p><code>data.frame</code> where each column represents a design factor.</p><ul><li><p>An example of <code>data.frame</code> input:</p></li>
</ul><p></p><div class="sourceCode R"><pre><code><span><span class="va">ifactors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>   treatment<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"Control"</span>, <span class="st">"Treated"</span>, <span class="st">"Treated"</span><span class="op">)</span>,</span>
<span>   genotype<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Wildtype"</span>, <span class="st">"Knockout"</span>, <span class="st">"Wildtype"</span>, <span class="st">"Knockout"</span><span class="op">)</span><span class="op">)</span></span></code></pre><p></p></div></li>
<li><p><code>character</code> vector, where design factor levels are separated
by a delimiter such as underscore <code>"_"</code>. This input will be
converted to <code>data.frame</code> before processing.</p><ul><li><p>An example of <code>character</code> input:</p></li>
</ul><p></p><div class="sourceCode R"><pre><code><span><span class="va">ifactors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>   <span class="st">"Control_Wildtype"</span>,</span>
<span>   <span class="st">"Control_Knockout"</span>,</span>
<span>   <span class="st">"Treated_Wildtype"</span>,</span>
<span>   <span class="st">"Treated_Knockout"</span><span class="op">)</span></span></code></pre><p></p></div></li>
</ol><p>When rownames are provided in the <code>data.frame</code>, or names
are provided with a <code>character</code> vector, they are retained
and used as sample identifiers.</p>
<p>Note:
This function will change any <code>"-"</code> in a factor name to
<code>"."</code> prior to detecting valid contrasts, in order to
prevent confusion and potential problems using the
contrast names in downstream analyses.
This step does not call <code><a href="https://rdrr.io/r/base/make.names.html" class="external-link">base::make.names()</a></code>, so that
step should be run beforehand if required.</p><div class="section">
<h3 id="troubleshooting">Troubleshooting<a class="anchor" aria-label="anchor" href="#troubleshooting"></a></h3>

<ul><li><p>When this function returns no contrasts, or returns an unexpected
error during processing, it is most likely due to the limitation
of comparing one factor at a time. For example, the logic will
not define contrast <code>time1_treatment1-time2_treatment2</code>, because
this contrast changes two factors, it will only permit either
<code>time1_treatment1-time1_treatment2</code> or <code>time1_treatment1-time2_treatment1</code>.</p></li>
<li><p><code>max_depth</code> and <code>factor_order</code> are used to define the order in
which factors are compared, but do not affect the order of factors
used for things like group names.</p></li>
</ul></div>

    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other jam experiment design: 
<code><a href="check_sedesign.html">check_sedesign</a>()</code>,
<code><a href="contrast_colors_by_group.html">contrast_colors_by_group</a>()</code>,
<code><a href="plot_sedesign.html">plot_sedesign</a>()</code>,
<code><a href="sedesign_to_factors.html">sedesign_to_factors</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># first define a vector of sample groups</span></span></span>
<span class="r-in"><span><span class="va">igroups</span> <span class="op">&lt;-</span> <span class="fu">jamba</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jamba/man/nameVector.html" class="external-link">nameVector</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WT"</span>, <span class="st">"KO"</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"Treated"</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   sep<span class="op">=</span><span class="st">"_"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   suffix<span class="op">=</span><span class="st">"_rep"</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">igroups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">igroups</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">igroups</span><span class="op">)</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">igroups</span>;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> WT_Control_rep1 WT_Control_rep2 WT_Control_rep3 WT_Treated_rep1 WT_Treated_rep2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      WT_Control      WT_Control      WT_Control      WT_Treated      WT_Treated </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> WT_Treated_rep3 KO_Control_rep1 KO_Control_rep2 KO_Control_rep3 KO_Treated_rep1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      WT_Treated      KO_Control      KO_Control      KO_Control      KO_Treated </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KO_Treated_rep2 KO_Treated_rep3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      KO_Treated      KO_Treated </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Levels: WT_Control WT_Treated KO_Control KO_Treated</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sedesign</span> <span class="op">&lt;-</span> <span class="fu">groups_to_sedesign</span><span class="op">(</span><span class="va">igroups</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="fu">design</span><span class="op">(</span><span class="va">sedesign</span><span class="op">)</span>;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 WT_Control WT_Treated KO_Control KO_Treated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> WT_Control_rep1          1          0          0          0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> WT_Control_rep2          1          0          0          0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> WT_Control_rep3          1          0          0          0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> WT_Treated_rep1          0          1          0          0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> WT_Treated_rep2          0          1          0          0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> WT_Treated_rep3          0          1          0          0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KO_Control_rep1          0          0          1          0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KO_Control_rep2          0          0          1          0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KO_Control_rep3          0          0          1          0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KO_Treated_rep1          0          0          0          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KO_Treated_rep2          0          0          0          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KO_Treated_rep3          0          0          0          1</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></span><span class="op">(</span><span class="va">sedesign</span><span class="op">)</span>;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Contrasts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Levels       KO_Control-WT_Control KO_Treated-WT_Treated WT_Treated-WT_Control</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   WT_Control                    -1                     0                    -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   WT_Treated                     0                    -1                     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   KO_Control                     1                     0                     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   KO_Treated                     0                     1                     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Contrasts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Levels       KO_Treated-KO_Control</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   WT_Control                     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   WT_Treated                     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   KO_Control                    -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   KO_Treated                     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Contrasts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Levels       (KO_Treated-WT_Treated)-(KO_Control-WT_Control)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   WT_Control                                               1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   WT_Treated                                              -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   KO_Control                                              -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   KO_Treated                                               1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot the design and contrasts</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_sedesign.html">plot_sedesign</a></span><span class="op">(</span><span class="va">sedesign</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="groups_to_sedesign-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># the two-way contrasts can be visibly flipped, since they are equivalent</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_sedesign.html">plot_sedesign</a></span><span class="op">(</span><span class="va">sedesign</span>, flip_twoway<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="groups_to_sedesign-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># the design can be subset by sample</span></span></span>
<span class="r-in"><span><span class="va">all_samples</span> <span class="op">&lt;-</span> <span class="fu">samples</span><span class="op">(</span><span class="va">sedesign</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">subset_samples1</span> <span class="op">&lt;-</span> <span class="va">all_samples</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="op">-</span><span class="fl">3</span><span class="op">]</span>;</span></span>
<span class="r-in"><span><span class="fu"><a href="plot_sedesign.html">plot_sedesign</a></span><span class="op">(</span><span class="va">sedesign</span><span class="op">[</span><span class="va">subset_samples1</span>, <span class="op">]</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>longer object length is not a multiple of shorter object length</span>
<span class="r-plt img"><img src="groups_to_sedesign-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># the group n=# replicates are updated</span></span></span>
<span class="r-in"><span><span class="va">subset_samples2</span> <span class="op">&lt;-</span> <span class="va">all_samples</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">6</span>, <span class="op">-</span><span class="fl">11</span><span class="op">)</span><span class="op">]</span>;</span></span>
<span class="r-in"><span><span class="fu"><a href="plot_sedesign.html">plot_sedesign</a></span><span class="op">(</span><span class="va">sedesign</span><span class="op">[</span><span class="va">subset_samples2</span>, <span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="groups_to_sedesign-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The design * contrast matrix can be displayed in full</span></span></span>
<span class="r-in"><span><span class="fu">design</span><span class="op">(</span><span class="va">sedesign</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span>  <span class="fu"><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></span><span class="op">(</span><span class="va">sedesign</span><span class="op">)</span>;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  Contrasts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   KO_Control-WT_Control KO_Treated-WT_Treated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   WT_Control_rep1                    -1                     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   WT_Control_rep2                    -1                     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   WT_Control_rep3                    -1                     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   WT_Treated_rep1                     0                    -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   WT_Treated_rep2                     0                    -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   WT_Treated_rep3                     0                    -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   KO_Control_rep1                     1                     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   KO_Control_rep2                     1                     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   KO_Control_rep3                     1                     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   KO_Treated_rep1                     0                     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   KO_Treated_rep2                     0                     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   KO_Treated_rep3                     0                     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  Contrasts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   WT_Treated-WT_Control KO_Treated-KO_Control</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   WT_Control_rep1                    -1                     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   WT_Control_rep2                    -1                     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   WT_Control_rep3                    -1                     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   WT_Treated_rep1                     1                     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   WT_Treated_rep2                     1                     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   WT_Treated_rep3                     1                     0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   KO_Control_rep1                     0                    -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   KO_Control_rep2                     0                    -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   KO_Control_rep3                     0                    -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   KO_Treated_rep1                     0                     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   KO_Treated_rep2                     0                     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   KO_Treated_rep3                     0                     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  Contrasts</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   (KO_Treated-WT_Treated)-(KO_Control-WT_Control)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   WT_Control_rep1                                               1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   WT_Control_rep2                                               1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   WT_Control_rep3                                               1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   WT_Treated_rep1                                              -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   WT_Treated_rep2                                              -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   WT_Treated_rep3                                              -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   KO_Control_rep1                                              -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   KO_Control_rep2                                              -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   KO_Control_rep3                                              -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   KO_Treated_rep1                                               1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   KO_Treated_rep2                                               1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   KO_Treated_rep3                                               1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># make "KO" the control term instead of "WT"</span></span></span>
<span class="r-in"><span><span class="fu">contrast_names</span><span class="op">(</span><span class="fu">groups_to_sedesign</span><span class="op">(</span><span class="va">igroups</span>, pre_control_terms<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"KO"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "WT_Control-KO_Control"                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "WT_Treated-KO_Treated"                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3] "KO_Treated-KO_Control"                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4] "WT_Treated-WT_Control"                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5] "(WT_Treated-KO_Treated)-(WT_Control-KO_Control)"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># change the order of factors compared</span></span></span>
<span class="r-in"><span><span class="fu">contrast_names</span><span class="op">(</span><span class="fu">groups_to_sedesign</span><span class="op">(</span><span class="va">igroups</span>, factor_order<span class="op">=</span><span class="fl">2</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "WT_Treated-WT_Control"                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "KO_Treated-KO_Control"                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3] "KO_Control-WT_Control"                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4] "KO_Treated-WT_Treated"                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5] "(KO_Treated-KO_Control)-(WT_Treated-WT_Control)"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># prevent comparisons of WT to WT, or KO to KO</span></span></span>
<span class="r-in"><span><span class="va">sedesign_2</span> <span class="op">&lt;-</span> <span class="fu">groups_to_sedesign</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">igroups</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   remove_pairs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WT"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"KO"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">contrast_names</span><span class="op">(</span><span class="va">sedesign_2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "KO_Control-WT_Control"                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "KO_Treated-WT_Treated"                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3] "(KO_Treated-WT_Treated)-(KO_Control-WT_Control)"</span>
<span class="r-in"><span><span class="fu"><a href="plot_sedesign.html">plot_sedesign</a></span><span class="op">(</span><span class="va">sedesign_2</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>no non-missing arguments to max; returning -Inf</span>
<span class="r-plt img"><img src="groups_to_sedesign-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># prevent comparisons of Treated to Treated, or Control to Control</span></span></span>
<span class="r-in"><span><span class="va">sedesign_3</span> <span class="op">&lt;-</span> <span class="fu">groups_to_sedesign</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">igroups</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   remove_pairs<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Treated"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Control"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">contrast_names</span><span class="op">(</span><span class="va">sedesign_3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "WT_Treated-WT_Control"                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "KO_Treated-KO_Control"                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3] "(KO_Treated-KO_Control)-(WT_Treated-WT_Control)"</span>
<span class="r-in"><span><span class="fu"><a href="plot_sedesign.html">plot_sedesign</a></span><span class="op">(</span><span class="va">sedesign_3</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>no non-missing arguments to max; returning -Inf</span>
<span class="r-plt img"><img src="groups_to_sedesign-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># input as a data.frame with ordered factor levels</span></span></span>
<span class="r-in"><span><span class="va">ifactors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Genotype<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WT"</span>,<span class="st">"WT"</span>,<span class="st">"KO"</span>,<span class="st">"KO"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WT"</span>,<span class="st">"KO"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   Treatment<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Treated"</span>,<span class="st">"Control"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Control"</span>,<span class="st">"Treated"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># not necessary, but define rownames</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">ifactors</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">jamba</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jamba/man/pasteByRow.html" class="external-link">pasteByRow</a></span><span class="op">(</span><span class="va">ifactors</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">ifactors</span>;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Genotype Treatment</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> WT_Treated       WT   Treated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> WT_Control       WT   Control</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KO_Treated       KO   Treated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KO_Control       KO   Control</span>
<span class="r-in"><span><span class="fu">contrast_names</span><span class="op">(</span><span class="fu">groups_to_sedesign</span><span class="op">(</span><span class="va">ifactors</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "KO_Control-WT_Control"                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "KO_Treated-WT_Treated"                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3] "WT_Treated-WT_Control"                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4] "KO_Treated-KO_Control"                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5] "(KO_Treated-WT_Treated)-(KO_Control-WT_Control)"</span>
<span class="r-in"><span><span class="fu"><a href="plot_sedesign.html">plot_sedesign</a></span><span class="op">(</span><span class="fu">groups_to_sedesign</span><span class="op">(</span><span class="va">ifactors</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="groups_to_sedesign-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># you can still override factor levels with pre_control_terms</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_sedesign.html">plot_sedesign</a></span><span class="op">(</span><span class="fu">groups_to_sedesign</span><span class="op">(</span><span class="va">ifactors</span>, pre_control_terms<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"KO"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="groups_to_sedesign-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># input as design matrix</span></span></span>
<span class="r-in"><span><span class="va">design_matrix</span> <span class="op">&lt;-</span> <span class="fu">design</span><span class="op">(</span><span class="fu">groups_to_sedesign</span><span class="op">(</span><span class="va">ifactors</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">design_matrix</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            WT_Control WT_Treated KO_Control KO_Treated</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> WT_Treated          0          1          0          0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> WT_Control          1          0          0          0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KO_Treated          0          0          0          1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> KO_Control          0          0          1          0</span>
<span class="r-in"><span><span class="fu">contrast_names</span><span class="op">(</span><span class="fu">groups_to_sedesign</span><span class="op">(</span><span class="va">design_matrix</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "KO_Control-WT_Control"                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "KO_Treated-WT_Treated"                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3] "WT_Treated-WT_Control"                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4] "KO_Treated-KO_Control"                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5] "(KO_Treated-WT_Treated)-(KO_Control-WT_Control)"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># again the "KO" group can be the control by using pre_control_terms</span></span></span>
<span class="r-in"><span><span class="fu">contrast_names</span><span class="op">(</span><span class="fu">groups_to_sedesign</span><span class="op">(</span><span class="va">design_matrix</span>, pre_control_terms<span class="op">=</span><span class="st">"KO"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "WT_Control-KO_Control"                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "WT_Treated-KO_Treated"                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3] "KO_Treated-KO_Control"                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4] "WT_Treated-WT_Control"                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5] "(WT_Treated-KO_Treated)-(WT_Control-KO_Control)"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># default_order="asis"</span></span></span>
<span class="r-in"><span><span class="co"># contrasts show A-B, because B appears fist</span></span></span>
<span class="r-in"><span><span class="co"># contrasts show Untreated-Treated because Treated appears first</span></span></span>
<span class="r-in"><span><span class="va">df_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>   set<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>, <span class="st">"A"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   treat<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Treated"</span>, <span class="st">"Untreated"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_sedesign.html">plot_sedesign</a></span><span class="op">(</span><span class="fu">groups_to_sedesign</span><span class="op">(</span><span class="va">df_test</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="groups_to_sedesign-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="plot_sedesign.html">plot_sedesign</a></span><span class="op">(</span><span class="fu">groups_to_sedesign</span><span class="op">(</span><span class="fu">jamba</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jamba/man/pasteByRow.html" class="external-link">pasteByRow</a></span><span class="op">(</span><span class="va">df_test</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># default_order="sort_samples"</span></span></span>
<span class="r-in"><span><span class="co"># contrasts show B-A, because A is sorted first</span></span></span>
<span class="r-in"><span><span class="co"># contrasts show Treated-Untreated because sort_samples()</span></span></span>
<span class="r-in"><span><span class="co">#    determines "Untreated" is a preferred control term</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_sedesign.html">plot_sedesign</a></span><span class="op">(</span><span class="fu">groups_to_sedesign</span><span class="op">(</span><span class="va">df_test</span>,</span></span>
<span class="r-in"><span>   default_order<span class="op">=</span><span class="st">"sort_samples"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="groups_to_sedesign-10.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># default_order="mixedSort"</span></span></span>
<span class="r-in"><span><span class="co"># contrasts show B-A, because A is sorted first</span></span></span>
<span class="r-in"><span><span class="co"># contrasts show Untreated-Treated because Treated is sorted first</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plot_sedesign.html">plot_sedesign</a></span><span class="op">(</span><span class="fu">groups_to_sedesign</span><span class="op">(</span><span class="va">df_test</span>,</span></span>
<span class="r-in"><span>   default_order<span class="op">=</span><span class="st">"mixedSort"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="groups_to_sedesign-11.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="plot_sedesign.html">plot_sedesign</a></span><span class="op">(</span><span class="fu">groups_to_sedesign</span><span class="op">(</span><span class="va">df_test</span>,</span></span>
<span class="r-in"><span>   default_order<span class="op">=</span><span class="st">"mixedSort"</span>,</span></span>
<span class="r-in"><span>   pre_control_terms<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Untreated"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="groups_to_sedesign-12.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by James M. Ward.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

