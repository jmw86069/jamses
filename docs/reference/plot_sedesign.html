<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Plot contrasts from sedesign object (in development), showing
one-way contrasts as block arrow, and two-way contrasts as
two block arrows connected in proper order."><title>Plot sedesign object contrasts — plot_sedesign • jamses</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot sedesign object contrasts — plot_sedesign"><meta property="og:description" content="Plot contrasts from sedesign object (in development), showing
one-way contrasts as block arrow, and two-way contrasts as
two block arrows connected in proper order."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">jamses</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.69.900</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="http://github.com/jmw86069/jamses/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Plot sedesign object contrasts</h1>
      <small class="dont-index">Source: <a href="http://github.com/jmw86069/jamses/blob/HEAD/R/jam_plot_sedesign.R" class="external-link"><code>R/jam_plot_sedesign.R</code></a></small>
      <div class="d-none name"><code>plot_sedesign.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plot contrasts from sedesign object (in development), showing
one-way contrasts as block arrow, and two-way contrasts as
two block arrows connected in proper order.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_sedesign</span><span class="op">(</span></span>
<span>  <span class="va">sedesign</span>,</span>
<span>  se <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  factor_names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  factor_sep <span class="op">=</span> <span class="st">"_"</span>,</span>
<span>  contrast_sep <span class="op">=</span> <span class="st">"-"</span>,</span>
<span>  axis1 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  axis2 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  axis3 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  axis4 <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  which_contrasts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  contrast_style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"comp"</span>, <span class="st">"contrast"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  contrast_labels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  oneway_position <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  twoway_position <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  contrast_position <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  contrast_depths <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sestats <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sestats_style <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"label"</span>, <span class="st">"number"</span>, <span class="st">"simple label"</span><span class="op">)</span>,</span>
<span>  assay_names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cutoff_names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  label_cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  arrow_ex <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  flip_twoway <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  colorset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  twoway_lwd <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  extend_ex <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  extend_angle <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  bump_factor <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  group_buffer <span class="op">=</span> <span class="fl">0.02</span>,</span>
<span>  group_border <span class="op">=</span> <span class="st">"grey65"</span>,</span>
<span>  group_fill <span class="op">=</span> <span class="st">"grey95"</span>,</span>
<span>  replicate_color <span class="op">=</span> <span class="st">"grey40"</span>,</span>
<span>  replicate_cex <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  do_plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_margins <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span><span class="op">)</span>,</span>
<span>  plot_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"base"</span>, <span class="st">"grid"</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  debug <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>sedesign</dt>
<dd><p><code>SEDesign</code> object as returned by <code><a href="groups_to_sedesign.html">groups_to_sedesign()</a></code>.</p></dd>


<dt>se</dt>
<dd><p><code>SummarizedExperiment</code> (optional) and not yet used by this
function. In future this object may be used to assign factor level
order to factor values.</p></dd>


<dt>factor_names</dt>
<dd><p><code>character</code> vector equal to the number of delimited
values in each group name, recognized in the group names of the
design matrix of <code>sedesign</code> as in <code>colnames(sedesign@design)</code>.</p></dd>


<dt>factor_sep</dt>
<dd><p><code>character</code> string separator between factor values
in each group name, typically <code>factor_sep="_"</code>.</p></dd>


<dt>contrast_sep</dt>
<dd><p><code>character</code> string separator between group names
in each contrast name, typically <code>contrast_sep="-"</code>.</p></dd>


<dt>axis1, axis2, axis3, axis4</dt>
<dd><p><code>character</code> vectors which define the
factors to represent on each axis, with axes defined in order
<code>1=bottom</code>, <code>2=left</code>, <code>3=top</code>, <code>4=right</code>. All factors in
<code>factor_names</code> must be represented.</p></dd>


<dt>which_contrasts</dt>
<dd><p>one of the following:</p><ul><li><p><code>numeric</code> index of contrasts defined in <code>sedesign</code>, or</p></li>
<li><p><code>character</code> vector of values present in <code>contrast_names(sedesign)</code>.</p></li>
</ul><p>When a two-way contrast is defined, its component one-way
contrasts are also included.</p></dd>


<dt>contrast_style</dt>
<dd><p><code>character</code> string deciding how to format
the contrast:</p><ul><li><p><code>"comp"</code>: calls contrast2comp()</p></li>
<li><p><code>"contrast"</code>: uses the contrast as-is</p></li>
<li><p><code>"none"</code>: hides the contrast label, appending <code>contrast_labels</code>
when provided</p></li>
</ul></dd>


<dt>contrast_labels</dt>
<dd><p><code>character</code> vector of labels named by contrast</p></dd>


<dt>oneway_position, twoway_position</dt>
<dd><p><code>numeric</code> value between 0 and 1,
which define the default position of each contrast label for one-way
and two-way contrasts, respectively. These values are overridden
by optional argument <code>contrast_position</code> when supplied.</p><ul><li><p><code>0</code> places the label toward the beginning of the arrow, which also
applies right/top justification of text at the start of the arrow.</p></li>
<li><p><code>1</code> places the label at the end of the arrow, which also
applies left/bottom justification of text at the end of the arrow.</p></li>
</ul></dd>


<dt>contrast_position</dt>
<dd><p><code>numeric</code> vector named by contrast, whose
values position each contrast label given. Default values are
defined by <code>oneway_position</code> and <code>twoway_position</code>, except
where defined by <code>contrast_position</code>.</p></dd>


<dt>contrast_depths</dt>
<dd><p><code>numeric</code> with one or more values used to
display only contrasts of the given depth: 1=oneway, 2=twoway.
When <code>NULL</code> all contrasts are displayed.</p></dd>


<dt>sestats</dt>
<dd><p><code>list</code> object that contains element <code>"hit_array"</code> as
produced by <code><a href="se_contrast_stats.html">se_contrast_stats()</a></code>, with statistical hits for
each contrast, after applying statistical cutoffs.
When supplied, statistical hits are included in each contrast label.
The three relevant optional values used to specify specific hits:</p><ul><li><p><code>"assay_name"</code>: this argument defines the values from
<code><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">SummarizedExperiment::assays()</a></code> that were used in the contrasts.</p></li>
<li><p><code>"cutoff_name"</code>: this argument defines a specific cutoff to
use, otherwise hits from any applied cutoff are included.</p></li>
<li><p><code>"contrast_name"</code>: this value uses argument <code>which_contrasts</code></p></li>
</ul></dd>


<dt>sestats_style</dt>
<dd><p><code>character</code> string indicating how to present the
number of hits for each contrast.</p><ul><li><p><code>"label"</code>: uses the full label: number hits (number up, number down)"</p></li>
<li><p><code>"number"</code>: uses only the number of hits "number"</p></li>
<li><p><code>"simple label"</code>: uses a simple label: "number hits" without
the number of hits up and down.</p></li>
</ul></dd>


<dt>assay_names, cutoff_names</dt>
<dd><p><code>character</code> values used with <code>sestats</code>
to define the statistical hits to use when <code>sestats</code> is supplied.</p></dd>


<dt>label_cex</dt>
<dd><p><code>numeric</code> expansion factor to adjust contrast label
font sizes.</p></dd>


<dt>arrow_ex</dt>
<dd><p><code>numeric</code> (default NULL) to adjust arrow width and
arrow head size together. When <code>NULL</code> it is adjusted starting at
<code>arrow_ex=1</code> and reduced proportional to the number of contrast
bumps (parallel contrasts that would otherwise overlap). When
provided as a numeric value, it is used without adjustment</p></dd>


<dt>flip_twoway</dt>
<dd><p><code>logical</code> indicating whether to flip the orientation
of two-way contrasts, for example <code>"(A-B)-(C-D)"</code> would be flipped
to equivalent form <code>"(A-C)-(B-D)"</code>, which will alter the orientation
of the two-way contrast connection. Note that the individual one-way
contrasts will be added if they did not already exist in the data.</p></dd>


<dt>colorset</dt>
<dd><p><code>character</code> vector of colors used for one-way contrasts.
When the vector contains names, they are assigned to
<code>contrast_names(sedesign)</code>, and any missing colors are assigned
using <code><a href="https://rdrr.io/pkg/colorjam/man/group2colors.html" class="external-link">colorjam::group2colors()</a></code>.
When the vector does not contain names, it is recycled to
the number of contrast names.</p></dd>


<dt>twoway_lwd</dt>
<dd><p><code>numeric</code> line width for two-way contrasts,
passed to <code><a href="draw_twoway_contrast.html">draw_twoway_contrast()</a></code>.</p></dd>


<dt>extend_ex</dt>
<dd><p><code>numeric</code> expansion factor to define control points
for two-way contrasts, beyond each one-way contrast by this fraction
of the group width in the diagram.</p></dd>


<dt>extend_angle</dt>
<dd><p><code>numeric</code> angle in degrees to define control points
for two-way contrasts, using this angle from the end of each one-way
contrast toward the other one-way contrast in the set.</p><ul><li><p>When the control point crosses the midpoint between the two contrasts,
half the angle is used to re-define control points.</p></li>
<li><p>When the control point crosses the other contrast in the set, the
first control point is retained, and the second control point
uses the opposite angle so the resulting bezier curve
from the first contrast "loops around" the far side of the second
contrast, then connects from the opposite side.</p></li>
</ul></dd>


<dt>bump_factor</dt>
<dd><p><code>numeric</code> factor applied to the relative
amount of "bump" used to adjust contrasts which would otherwise
overlap on the same x- or y-axis intercept. It can optionally accept
two values, applied to the y-axis, then x-axis bump. Values
range from 0 (no bump) to 1.5 (expands to full width of each group),
with default 1 covering roughly 80% the size of each group box.
This value is also adjusted by <code>group_buffer</code>.</p></dd>


<dt>group_buffer</dt>
<dd><p><code>numeric</code> value (default 0.02) indicating the
relative buffer in between each group square, as a fraction of
total width. The range is restricted to minimum 0 (no buffer) to
0.5 (groups are drawn as a point) with recommended values between 0
and 0.1,</p></dd>


<dt>group_border, group_fill</dt>
<dd><p><code>character</code> color used for the border
and fill colors, respectively, to draw a square
for each experimental group defined in <code>sedesign</code>.
These values can be supplied as a named vector, whose names match
the group names defined in <code>sedesign</code>, and they will be applied
to each group. Any missing groups will used recycled values.</p></dd>


<dt>replicate_color</dt>
<dd><p><code>character</code> string with R color, used for
the label in each group for the number of replicates as defined
in <code>sedesign</code>.</p></dd>


<dt>replicate_cex</dt>
<dd><p><code>numeric</code> expansion factor used to adjust the font
size for the replicate label in each group defined by <code>sedesign</code>.</p></dd>


<dt>do_plot</dt>
<dd><p><code>logical</code> indicating whether to render the plot,
or when <code>do_plot=FALSE</code> only the underlying data is returned.</p></dd>


<dt>plot_margins</dt>
<dd><p><code>numeric</code> value applied to <code>par("mar")</code> around the
plot, to define minimal whitespace around the plot.</p></dd>


<dt>plot_type</dt>
<dd><p><code>character</code> string (experimental) to define one of
multiple plot output types:</p><ul><li><p><code>"base"</code> uses base R graphics.</p></li>
<li><p><code>"grid"</code> (not yet implemented) uses R grid graphics. This option
is expected to enable more methods to reduce overlapping labels,
and potentially labels with markdown markup.</p></li>
</ul></dd>


<dt>verbose</dt>
<dd><p><code>logical</code> indicating whether to print verbose output.</p></dd>


<dt>debug</dt>
<dd><p><code>logical</code> indicating whether to print very detailed
debug output.</p></dd>


<dt>...</dt>
<dd><p>additional arguments are ignored.</p></dd>


<dt>contrast</dt>
<dd><p><code>character</code> contrast name</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>invisible <code>list</code> of <code>data.frame</code> representing individual
contrasts to be rendered. Mainly useful for reviewing the
data used to produce the figure.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>TODO:</p><ul><li><p>Mostly done: Confirm functionality with different combinations
of axis values.</p></li>
<li><p>Confirm functionality with only one factor on one axis.</p></li>
<li><p>Adjust drawing order:</p><ul><li><p>Group contrasts into sets of two-way contrasts which share
any one one-way contrast with each other. This group should
be drawn together as a set, to minimize weird effects of overlaps.</p></li>
<li><p>Do not draw a one-way contrast independently when it is already
being rendered as part of a two-way contrast.</p></li>
</ul></li>
<li><p>Implement method to assign colors to contrasts.</p><ul><li><p>Simplest option: Allow <code>color_sub</code> whose names match values in
<code>contrast_names(sedesign)</code>.</p></li>
<li><p>Next potential option: Use <code>color_sub</code> to match each group name,
then define either solid color from <code><a href="https://rdrr.io/pkg/colorjam/man/blend_colors.html" class="external-link">colorjam::blend_colors()</a></code>, or
using a color gradient for each one-way block arrow.</p></li>
<li><p>Two-way connectors use the first contrast end color, and
second contrast start color as a gradient.</p></li>
<li><p>If colors are not defined per group, call <code>design2colors()</code>?</p></li>
</ul></li>
<li><p>DONE. Confirm/implement method to display fewer factors on axes
than are present in the underlying group labels.</p></li>
<li><p>Improve location of axis labels - currently uses <code><a href="https://rdrr.io/pkg/jamba/man/groupedAxis.html" class="external-link">jamba::groupedAxis()</a></code>
however they appear too distant from the figure itself.</p></li>
<li><p>Determine method to "recognize" factor order from <code>colData(se)</code>.</p><ul><li><p>Simplest option is to use argument <code>factor_names</code> to match
<code>colnames(colData(se))</code> (when supplied) and use that to define
factor order.</p></li>
<li><p>One option is to update <code>group_to_sedesign()</code> so it stores the
factor design data as a <code>data.frame</code> with proper factor level order.
This update could also benefit <code><a href="https://rdrr.io/pkg/platjam/man/design2colors.html" class="external-link">platjam::design2colors()</a></code> by
informing the necessary <code><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData()</a></code> colnames to use.</p></li>
<li><p>A simpler option is to update <code>sedesign</code> to include
<code>colnames(colData(se))</code> as a <code>character</code> vector, without having to store
the full <code>data.frame</code>. It would requiring passing both the
<code>sedesign</code> and <code>se</code> objects together.</p></li>
<li><p>Another option is to require <code>colnames(colData(se))</code> to match
the order in the group names defined in <code>colnames(sedesign@design)</code>.</p></li>
</ul></li>
<li><p>DONE. implement block arrows functions for improved quality output.</p></li>
<li><p>consider <code>grid</code> graphics (package <code>vwline</code>) or <code>ggplot2</code> output.</p></li>
<li><p>implement sensible method to display a subset of one-way or
two-way contrasts. For example, two-way contrasts are easier to see
when showing only a subset, perhaps only along one common axis.</p></li>
<li><p>Consider implementing gradient colors for block arrows.</p><ul><li><p>This enhancement requires changing block arrow from one polygon
to a list of polygons, so each smaller polygon has its own
color from the color gradient.</p></li>
</ul></li>
<li><p>Two-way contrasts:</p><ul><li><p>Handle two-way contrasts for which the one-way contrasts may
not also be defined.</p></li>
<li><p>Change drawing order so the one-way block arrow label is not
overdrawn by the two-way connector.</p><ul><li><p>This step probably requires grouping one-way and two-way
contrasts so that for each two-way contrast,
each one-way contrast is drawn, then the two-way connector,
then the one-way labels.</p></li>
<li><p>Probably need helper function <code><a href="draw_twoway_contrast.html">draw_twoway_contrast()</a></code>
which calls <code><a href="draw_oneway_contrast.html">draw_oneway_contrast()</a></code>, <code>draw_twoway_connector()</code>,
and <code>draw_oneway_label()</code>. The one-way steps can be "skipped".</p></li>
<li><p>To be "fancy", when a one-way contrast would be rendered
multiple times, the rendering should be "skipped" and rendered
only the last time, so the label would always be rendered
after the incoming two-way connector, and so the one-way
contrast (and its label) would only need to be rendered
once overall.</p></li>
</ul></li>
</ul></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other jam experiment design: 
<code><a href="check_sedesign.html">check_sedesign</a>()</code>,
<code><a href="contrast2comp.html">contrast2comp</a>()</code>,
<code><a href="contrast_colors_by_group.html">contrast_colors_by_group</a>()</code>,
<code><a href="contrast_names_to_sedesign.html">contrast_names_to_sedesign</a>()</code>,
<code><a href="contrasts_to_factors.html">contrasts_to_factors</a>()</code>,
<code><a href="contrasts_to_venn_setlists.html">contrasts_to_venn_setlists</a>()</code>,
<code><a href="draw_oneway_contrast.html">draw_oneway_contrast</a>()</code>,
<code><a href="draw_twoway_contrast.html">draw_twoway_contrast</a>()</code>,
<code><a href="filter_contrast_names.html">filter_contrast_names</a>()</code>,
<code><a href="groups_to_sedesign.html">groups_to_sedesign</a>()</code>,
<code><a href="sedesign_to_factors.html">sedesign_to_factors</a>()</code>,
<code><a href="validate_sedesign.html">validate_sedesign</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">isamples_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DMSO"</span>, <span class="st">"Etop"</span>, <span class="st">"DMSO"</span>, <span class="st">"Etop"</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   <span class="st">"_"</span>,</span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NF"</span>, <span class="st">"Flag"</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">12</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   <span class="st">"_"</span>,</span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WT"</span>, <span class="st">"KO"</span>, <span class="st">"WT"</span>, <span class="st">"KO"</span>, <span class="st">"WT"</span>, <span class="st">"D955N"</span>, <span class="st">"WT"</span>, <span class="st">"D955N"</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   <span class="st">"_"</span>,</span></span>
<span class="r-in"><span>   <span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># simple data.frame with group information</span></span></span>
<span class="r-in"><span><span class="va">idf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fu">jamba</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jamba/man/rbindList.html" class="external-link">rbindList</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">isamples_1</span>, <span class="st">"_"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">idf</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">isamples_1</span>;</span></span>
<span class="r-in"><span><span class="co"># convert to sedesign</span></span></span>
<span class="r-in"><span><span class="va">sedesign_1</span> <span class="op">&lt;-</span> <span class="fu"><a href="groups_to_sedesign.html">groups_to_sedesign</a></span><span class="op">(</span><span class="va">idf</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot the contrasts</span></span></span>
<span class="r-in"><span><span class="fu">plot_sedesign</span><span class="op">(</span><span class="va">sedesign_1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_sedesign-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># re-order the factors along each axis</span></span></span>
<span class="r-in"><span><span class="fu">plot_sedesign</span><span class="op">(</span><span class="va">sedesign_1</span>, axis1<span class="op">=</span><span class="fl">1</span>, axis2<span class="op">=</span><span class="fl">3</span>, axis3<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_sedesign-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># flip the group ordering for two-way contrasts</span></span></span>
<span class="r-in"><span><span class="co"># (These are mathematically equivalent, but shown in flipped orientation)</span></span></span>
<span class="r-in"><span><span class="fu">plot_sedesign</span><span class="op">(</span><span class="va">sedesign_1</span>, axis1<span class="op">=</span><span class="fl">1</span>, axis2<span class="op">=</span><span class="fl">3</span>, axis3<span class="op">=</span><span class="fl">2</span>, flip_twoway<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_sedesign-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot only the two-way contrasts</span></span></span>
<span class="r-in"><span><span class="va">is_twoway</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"[(]"</span>, <span class="fu">contrast_names</span><span class="op">(</span><span class="va">sedesign_1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plot_sedesign</span><span class="op">(</span><span class="va">sedesign_1</span>, which_contrasts<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">is_twoway</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   axis1<span class="op">=</span><span class="fl">1</span>, axis2<span class="op">=</span><span class="fl">3</span>, axis3<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>no non-missing arguments to max; returning -Inf</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>no non-missing arguments to max; returning -Inf</span>
<span class="r-plt img"><img src="plot_sedesign-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">group_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"DMSO"</span>, <span class="st">"Etop"</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   <span class="st">"_"</span>,</span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NF"</span>, <span class="st">"Flag"</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   <span class="st">"_"</span>,</span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WT"</span>, <span class="st">"KO"</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sedesign</span> <span class="op">&lt;-</span> <span class="fu"><a href="groups_to_sedesign.html">groups_to_sedesign</a></span><span class="op">(</span><span class="va">group_names</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plot_sedesign</span><span class="op">(</span><span class="va">sedesign</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_sedesign-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># plot only the two-way contrasts</span></span></span>
<span class="r-in"><span><span class="va">is_twoway</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"[(]"</span>, <span class="fu">contrast_names</span><span class="op">(</span><span class="va">sedesign</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plot_sedesign</span><span class="op">(</span><span class="va">sedesign</span>, which_contrasts<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">is_twoway</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   axis1<span class="op">=</span><span class="fl">1</span>, axis2<span class="op">=</span><span class="fl">3</span>, axis3<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>no non-missing arguments to max; returning -Inf</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>no non-missing arguments to max; returning -Inf</span>
<span class="r-plt img"><img src="plot_sedesign-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by James M. Ward.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

