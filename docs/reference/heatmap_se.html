<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Heatmap for SummarizedExperiment data"><title>Heatmap for SummarizedExperiment data — heatmap_se • jamses</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Heatmap for SummarizedExperiment data — heatmap_se"><meta property="og:description" content="Heatmap for SummarizedExperiment data"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">jamses</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.69.900</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="http://github.com/jmw86069/jamses/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Heatmap for SummarizedExperiment data</h1>
      <small class="dont-index">Source: <a href="http://github.com/jmw86069/jamses/blob/HEAD/R/jam_sestats_hm.R" class="external-link"><code>R/jam_sestats_hm.R</code></a></small>
      <div class="d-none name"><code>heatmap_se.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Heatmap for SummarizedExperiment data</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">heatmap_se</span><span class="op">(</span></span>
<span>  <span class="va">se</span>,</span>
<span>  sestats <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hm_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hm_title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rows <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  row_type <span class="op">=</span> <span class="st">"rows"</span>,</span>
<span>  column_type <span class="op">=</span> <span class="st">"samples"</span>,</span>
<span>  data_type <span class="op">=</span> <span class="st">"expression"</span>,</span>
<span>  correlation <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  assay_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  contrast_names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  contrast_suffix <span class="op">=</span> <span class="st">""</span>,</span>
<span>  cutoff_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alt_sestats <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alt_assay_name <span class="op">=</span> <span class="va">assay_name</span>,</span>
<span>  alt_contrast_names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  alt_contrast_suffix <span class="op">=</span> <span class="st">""</span>,</span>
<span>  alt_cutoff_name <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  isamples <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span>,</span>
<span>  normgroup_colname <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  centerby_colnames <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  controlSamples <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  control_label <span class="op">=</span> <span class="st">""</span>,</span>
<span>  controlFloor <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  naControlAction <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"na"</span>, <span class="st">"row"</span>, <span class="st">"floor"</span>, <span class="st">"min"</span><span class="op">)</span>,</span>
<span>  naControlFloor <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  top_colnames <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  top_annotation <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  top_annotation_name_gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  rowData_colnames <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  left_annotation <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  left_annotation_name_gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  left_annotation_name_rot <span class="op">=</span> <span class="fl">90</span>,</span>
<span>  right_annotation <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  simple_anno_size <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">8</span>, <span class="st">"mm"</span><span class="op">)</span>,</span>
<span>  legend_title_gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>  legend_labels_gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>fontsize <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>  legend_grid_cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  row_names_gp <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  row_split <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  row_subcluster <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  row_title_rot <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  sample_color_list <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  legend_at <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  legend_labels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  subset_legend_colors <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  row_cex <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>  column_cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  row_anno_fontsize <span class="op">=</span> <span class="fl">11</span>,</span>
<span>  useMedian <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  show_row_names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  show_row_dend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">rows</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">2000</span>,</span>
<span>  mark_rows <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mark_labels_gp <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  column_title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>,</span>
<span>  apply_hm_column_title <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  hm_title_buffer <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  show_heatmap_legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  show_top_legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  show_left_legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  legend_border_color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  show_top_annotation_name <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  show_left_annotation_name <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  row_label_colname <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cluster_columns <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cluster_column_slices <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  cluster_rows <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span> <span class="op">{</span></span>
<span>     <span class="fu">amap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/amap/man/hcluster.html" class="external-link">hcluster</a></span><span class="op">(</span><span class="fu">jamba</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jamba/man/rmNA.html" class="external-link">rmNA</a></span><span class="op">(</span>naValue <span class="op">=</span> <span class="fl">0</span>, <span class="va">x</span><span class="op">)</span>, <span class="va">...</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"euclidean"</span>, link <span class="op">=</span> <span class="st">"ward"</span><span class="op">)</span></span>
<span> <span class="op">}</span>,</span>
<span>  cluster_row_slices <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  column_names_gp <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  column_split <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  column_split_sep <span class="op">=</span> <span class="st">","</span>,</span>
<span>  color_max <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  color_floor <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  lens <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  rename_contrasts <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  rename_alt_contrasts <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  use_raster <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  debug <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>se</dt>
<dd><p><code>SummarizedExperiment</code> by default, or one of the following:</p><ul><li><p><code>SummarizedExperiment</code> with accessor functions
<code>rowData()</code>, <code>colData()</code>, and <code>assays()</code>. It will use
<code>values(rowRanges())</code> if no slot <code>rowData</code> exists.</p></li>
<li><p><code>SingleCellExperiment</code> with accessor functions
<code>rowData()</code>, <code>colData()</code>, and <code>assays()</code>. It will use
<code>values(rowRanges())</code> if no slot <code>rowData</code> exists.</p></li>
<li><p><code>Seurat</code> object, which is coerced to <code>SingleCellExperiment</code> and
handled accordingly</p></li>
<li><p><code>ExpressionSet</code> or compatible object with accessor functions
<code>featureData()</code>, <code>phenoData()</code>, and <code>assayData()</code>.</p></li>
</ul></dd>


<dt>sestats</dt>
<dd><p>one of the following types of data:</p><ul><li><p><code>list</code> output from <code><a href="se_contrast_stats.html">se_contrast_stats()</a></code>, which
specifically contains <code>hit_array</code> as a 3-dimensional array of hits
with dimensions "Cutoffs", "Contrasts", "Signal".</p></li>
<li><p><code>numeric</code> matrix intended to represent an incidence matrix,
where a value <code>0</code> indicates absence, and non-zero indicates presence.
This format is useful for supplying any incidence matrix, such as
gene-by-pathway (for example Github package "jmw86069/multienrichjam"
provides <code>mem$memIM</code> with gene-by-pathway matrix),
or gene-by-class (see Github package "jmw86069/pajam"
for examples using ProteinAtlas protein classification, including
membrane-bound, secreted, transcription factors, etc.), or any
incidence matrix defined by Github "jmw86069/venndir" function
<code>list2im_value()</code> or <code>list2im()</code> which converts input to a Venn diagram
into an incidence matrix.</p></li>
<li><p>When <code>sestats</code> is supplied, data is converted to incidence matrix,
then columns are matched with <code>contrast_names</code>. All rows with non-zero
entry in those columns are included in the heatmap.
When <code>rows</code> is also supplied, then the intersection of incidence
matrix rows and <code>rows</code> is displayed in the heatmap.</p></li>
<li><p>Note that <code>alt_sestats</code> does not subset rows displayed in the
heatmap.</p></li>
</ul></dd>


<dt>hm_name</dt>
<dd><p><code>character</code> string, or <code>NULL</code> (default) which uses the
<code>data_type</code> value. Note that the legend title uses the <code>data_type</code>,
and is also used for <code>hm_name</code> when <code>hm_name=NULL</code>.
The <code>hm_name</code> is most useful to customize because this string is used
as the prefix for grid graphical components, for example seen with
<code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/list_components.html" class="external-link">ComplexHeatmap::list_components()</a></code>. When two heatmaps or a
<code>HeatmapList</code> is drawn, the names can be used to define specific
grid regions of each heatmap. If the heatmaps share the same
<code>hm_name</code> then the regions will also have identical name and cannot
be addressed distinctly.</p></dd>


<dt>hm_title</dt>
<dd><p><code>character</code> string, or <code>NULL</code> (default) which generates
a heatmap title using the dimensions, <code>assay_name</code>, <code>data_type</code>,
and a string which describes the data centering.
When provided as a <code>character</code> string, it is used as-is.
(In future this value may accept variable names.)</p></dd>


<dt>rows</dt>
<dd><p><code>character</code> vector of <code>rownames(se)</code> to define a specific
set of rows to display. When <code>sestats</code> is supplied, then the
intersection of <code>rows</code> with genes defined by <code>sestats</code> is displayed.
Note that rows are required to be in <code>rownames(se)</code>, all other rows
are dropped.</p></dd>


<dt>row_type</dt>
<dd><p><code>character</code> string used in the title of the heatmap
which indicates how many rows are displayed. For example
<code>"1,234 genes detected above background"</code> or
<code>"1,234 DEGs by limma-voom"</code>.
When <code>row_type=""</code> or <code>row_type=NULL</code> this information
is not included in the heatmap title.</p></dd>


<dt>column_type</dt>
<dd><p><code>character</code> string used in the title of the heatmap
which indicates how many column are displayed. For example
<code>"12 samples"</code> or <code>"12 biological replicates"</code>.
When <code>column_type=""</code> or <code>column_type=NULL</code> this information
is not included in the heatmap title.</p></dd>


<dt>data_type</dt>
<dd><p><code>character</code> string used as title of the heatmap
color gradient legend, for example <code>"expression"</code> indicates
the data contains gene expression measurements. Notes:</p><ul><li><p>The prefix <code>"centered"</code> is automatically appended whenever
the data is also centered for the heatmap. Set <code>centerby_colnames=FALSE</code>
to display data that is not centered.</p></li>
<li><p>The prefix <code>"correlation of"</code> is automatically appended when
<code>correlation=TRUE</code> which displays correlation of whatever data
is included in the heatmap.</p></li>
</ul></dd>


<dt>correlation</dt>
<dd><p><code>logical</code> indicating whether to calculate sample
correlation, and plot a sample-by-sample correlation heatmap.
This option is included here since many of the same arguments
are required for data centering, and sample annotations.
Note that <code>color_max</code> is forced to a maximum value of <code>1.0</code>,
representing the maximum correlation value.</p></dd>


<dt>assay_name</dt>
<dd><p><code>character</code> string indicating the name in
<code>assays(se)</code> to use for data to be displayed in the heatmap.</p><ul><li><p>When multiple <code>assay_name</code> values are supplied, the first
assay_name that matches <code>names(assays(se))</code> will be used in the
heatmap. In this way, multiple <code>assay_names</code> can be supplied to
define statistical hits in <code>sestats</code>, which calls <code><a href="hit_array_to_list.html">hit_array_to_list()</a></code>
to combine hits across <code>assay_name</code> entries; but only the first
<code>assay_name</code> found in <code>se</code> is used for the heatmap values.</p></li>
<li><p>When there is only one value for <code>assayNames(se)</code>, then
<code>assay_name</code> will default to this value, instead of acting like
it couldn't possibly know what was intended. Haha.</p></li>
<li><p>Lastly, <code>assay_name</code> can be a <code>numeric</code> index, helpful in case
<code>assays(se)</code> contains no names - not recommended but it can happen.</p></li>
</ul></dd>


<dt>contrast_names</dt>
<dd><p><code>character</code> vector of contrasts in
<code>sestats$hit_array</code> to use for the heatmap. When <code>contrast_names=NULL</code>
then all contrasts are displayed, which is the default.</p></dd>


<dt>contrast_suffix</dt>
<dd><p><code>character</code> string with optional suffix to append
to the end of each contrast name label for <code>sestats</code> hit incidence
matrix beside the heatmap. This suffix may be useful when comparing
two methods for the same set of contrast names, with <code>sestats</code> and
<code>alt_sestats</code>.</p></dd>


<dt>cutoff_name</dt>
<dd><p><code>character</code> or <code>integer</code> index used to define the
specific statistical cutoffs to use from <code>sestats$hit_array</code>. This
argument is passed to <code><a href="hit_array_to_list.html">hit_array_to_list()</a></code> as <code>cutoff_names</code>.</p></dd>


<dt>alt_sestats, alt_assay_name, alt_contrast_names, alt_contrast_suffix</dt>
<dd><p>arguments analogous to those described above for <code>sestats</code> which
are used when <code>alt_sestats</code> is supplied.</p></dd>


<dt>isamples</dt>
<dd><p><code>character</code> vector of <code>colnames(se)</code> used to visualize a
subset of samples used for the data centering step. Note that
data centering uses all columns supplied in <code>se</code>, and after centering,
the subset of columns defined in <code>isamples</code> is displayed in the heatmap.
This distinction makes it possible to center data by some control group,
then optionally not display the control group data.</p></dd>


<dt>normgroup_colname</dt>
<dd><p><code>character</code> vector of colnames in <code>colData(se)</code>
used during data centering. When supplied, samples are centered
independently within each normgroup grouping. These values are
equivalent to using <code>centerby_colnames</code>.</p></dd>


<dt>centerby_colnames</dt>
<dd><p>either:</p><ul><li><p><code>character</code> vector of colnames in <code>colData(se)</code>
used during data centering. When supplied, samples are centered
independently within each centerby grouping. It is typically used
for things like cell lines, to center each cell line by a time
point control, or untreated control.</p></li>
<li><p><code>NULL</code> to perform centering across all columns in <code>se</code>.</p></li>
<li><p><code>FALSE</code> to disable centering.</p></li>
</ul></dd>


<dt>controlSamples</dt>
<dd><p><code>character</code> optional vector of samples to use as the
reference during data centering. Note that samples are still
centered within each normgroup and centerby grouping, and within
that grouping samples are centered to the <code>controlSamples</code>
which are present in that grouping. Any center group for which no
samples are defined in <code>controlSamples</code> will use all samples in that
center group. Typically, <code>controlSamples</code> is used to define a
specific group as the reference for centering, so changes are displayed
relative to that group. Make sure to define <code>control_name</code> to include
an appropriate label in the heatmap title.</p></dd>


<dt>control_label</dt>
<dd><p><code>character</code> string used in heatmap title
to describe the control used during data centering, relevant when
<code>controlSamples</code> is also supplied. Recommended format:
<code>"versus Wildtype"</code> or <code>"vs. Wildtype"</code>.
The heatmap title will include data centering and <code>control_label</code>
in this format:
<code>"centered within {centerby_colnames}, {control_label}"</code>, for example
<code>"centered within Genotype/Time, versus Vehicle"</code>.</p></dd>


<dt>controlFloor, naControlAction, naControlFloor</dt>
<dd><p>passed to
<code><a href="https://rdrr.io/pkg/jamma/man/centerGeneData.html" class="external-link">jamma::centerGeneData()</a></code> to customize data centering.</p><ul><li><p><code>controlFloor</code> imposes an optional noise floor to control group
mean/median values, so the summary value during centering is at
least <code>controlFloor</code>. Useful for defining an effective noise floor
for a platform technology.</p></li>
<li><p><code>naControlAction</code> defines the action taken only when values for
all control samples are <code>NA</code>.</p></li>
<li><p><code>naControlFloor</code> is a <code>numeric</code> value used when
<code>naControlAction="floor"</code>, which causes the group reference value
to use the value provided in <code>naControlFloor</code>.</p></li>
</ul></dd>


<dt>top_colnames</dt>
<dd><p>one of the following types:</p><ul><li><p><code>character</code> vector of colnames to use from
<code>colData(se)</code> as annotations to display in <code>top_annotation</code> above
the heatmap.</p></li>
<li><p><code>NULL</code>, will call <code><a href="choose_annotation_colnames.html">choose_annotation_colnames()</a></code> to detect
reasonable colnames: columns with more than one unique value;
columns with at least one duplicated value.</p></li>
<li><p><code>FALSE</code> will hide the <code>top_colnames</code>, which also occurs when
<code>colData(se)</code> is empty.</p></li>
</ul></dd>


<dt>top_annotation</dt>
<dd><p>specific heatmap annotation as defined by
<code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/HeatmapAnnotation.html" class="external-link">ComplexHeatmap::HeatmapAnnotation()</a></code>. When supplied, the <code>top_colnames</code>
described above is not used.</p></dd>


<dt>top_annotation_name_gp</dt>
<dd><p><code><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">grid::gpar</a></code> object to customize the
annotation name displayed beside the top annotation.</p></dd>


<dt>rowData_colnames</dt>
<dd><p><code>character</code> vector of colnames in <code>rowData(se)</code>
to use for heatmap annotations displayed on the left side of
the heatmap. Specific colors can be included in <code>sample_color_list</code>
as a named <code>list</code> of color vectors or color functions. The names
of this list must match colnames to be displayed, otherwise
<code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code> will define its own color function.</p></dd>


<dt>left_annotation</dt>
<dd><p>specific heatmap annotation as defined by
<code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/rowAnnotation.html" class="external-link">ComplexHeatmap::rowAnnotation()</a></code>. When supplied, the <code>rowData_colnames</code>
and <code>sestats</code> row annotations are not displayed. In order to supply
custom row annotations and not lose <code>left_annotation</code> defined above,
supply the row annotations as <code>right_annotation</code>.</p></dd>


<dt>left_annotation_name_gp</dt>
<dd><p><code><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">grid::gpar</a></code> object to customize the
annotation name displayed beside the left annotation.</p></dd>


<dt>left_annotation_name_rot</dt>
<dd><p><code>numeric</code> rotation of left annotation
label, in degrees, where <code>0</code> indicates normal text, and <code>90</code> is
rotated vertically.</p></dd>


<dt>right_annotation</dt>
<dd><p>specific heatmap annotation as defined by
<code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/HeatmapAnnotation.html" class="external-link">ComplexHeatmap::HeatmapAnnotation()</a></code>. This element is created
automatically when <code>mark_rows</code> is supplied.</p></dd>


<dt>simple_anno_size</dt>
<dd><p><code><a href="https://rdrr.io/r/grid/unit.html" class="external-link">grid::unit</a></code> size used to define heatmap
annotation sizes (height or width of each line) for any simple
annotations.</p></dd>


<dt>legend_title_gp</dt>
<dd><p><code><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">grid::gpar</a></code> to customize the legend title
fonts, applied to each legend: top annotation, left annotation,
main heatmap.</p></dd>


<dt>legend_labels_gp</dt>
<dd><p><code><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">grid::gpar</a></code> to customize the legend label
fonts, applied to each legend: top annotation, left annotation,
main heatmap.</p></dd>


<dt>legend_grid_cex</dt>
<dd><p><code>numeric</code> multiplied to adjust the relative
size of each legend grid unit, applied to each relevant metric.</p></dd>


<dt>row_names_gp</dt>
<dd><p><code>gpar</code> to define custom column name settings.
When <code>"fontsize"</code> is not defined, the automatic font size calculation
is added to the <code>row_names_gp</code> supplied.</p></dd>


<dt>row_split</dt>
<dd><p>is used to define heatmap split by row, ultimately
passed to <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code> argument <code>row_split</code>. However,
the input type can vary:</p><ul><li><p><code>integer</code> number of row splits based upon row clustering. If
<code>row_split</code> is greater than the number of rows, it will be set
to the number of rows.</p></li>
<li><p><code>character</code> value or values in colnames of <code>rowData(se)</code> to split
using row annotation in <code>se</code>.</p></li>
<li><p><code>data.frame</code> whose <code><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames()</a></code> must contain all rows to be
displayed in the heatmap. This argument is passed directly to
<code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code> to apply the split appropriately.</p></li>
<li><p><code>character</code> or <code>factor</code> vector named by <code>rownames(se)</code> with another
custom row split, passed directly to <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code>
argument <code>row_split</code>, with proper order for rows being displayed</p></li>
</ul></dd>


<dt>row_subcluster</dt>
<dd><p><code>integer</code> or <code>character</code> vector representing one
or more elements returned by <code>row_split</code> to use as a drill-down
sub-cluster heatmap. This argument is experimental, and is intended
to make it easy to "drill down" into specific row clusters.</p><ul><li><p>The process internally creates a full heatmap using all arguments
as defined, then extracts the <code><a href="https://rdrr.io/pkg/jamba/man/heatmap_row_order.html" class="external-link">jamba::heatmap_row_order()</a></code> which
contains row split data in a <code>list</code> of rownames vectors. The <code>list</code>
elements that match <code>row_subcluster</code> are extracted and used again
for a subsequent heatmap, and are displayed in the same order
in which they appear in the original full heatmap - which means
<code>cluster_rows=FALSE</code> is defined at this point. However <code>row_split</code>
is retained for this subset of rows, to indicate the original
row split annotation.</p></li>
<li><p>Note that <code>row_subcluster</code> must match the <code><a href="https://rdrr.io/r/base/names.html" class="external-link">names()</a></code> returned
by <code><a href="https://rdrr.io/pkg/jamba/man/heatmap_row_order.html" class="external-link">jamba::heatmap_row_order()</a></code> for the full heatmap, or should
include a <code>numeric</code> index for the <code>list</code> element or elements to
use.</p></li>
<li><p>In principle this process would be run in two stages: First,
view a heatmap with <code>row_split=6</code>, then re-run the same heatmap
with <code>row_subcluster=4</code> to see cluster number 4 from the full
heatmap.</p></li>
</ul></dd>


<dt>row_title_rot</dt>
<dd><p><code>numeric</code> value indicating text rotation in degrees
to use for row titles.</p></dd>


<dt>sample_color_list</dt>
<dd><p>named <code>list</code> of color vectors or color functions,
where names correspond to colnames in either <code>colData(se)</code> or
<code>rowData(se)</code>, and which are passed to corresponding left or top
annotation functions. When colors are not defined,
<code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code> will define colors using its own internal
function.</p></dd>


<dt>legend_at, legend_labels</dt>
<dd><p><code>numeric</code> and <code>character</code>, respectively,
to define custom values for the heatmap color gradient legend.</p><ul><li><p>When <code>legend_at</code> is supplied, it is used as provided.</p></li>
<li><p>When <code>legend_labels</code> is supplied, it is used only when its length
equals <code>length(legend_at)</code>, in which case it is used as provided.</p></li>
<li><p>When <code>centerby_colnames=FALSE</code> and the matrix data does not contain
negative values, <code>legend_at</code> uses integers from <code>0</code> to <code>color_max</code>,
to avoid presenting a color legend with unnecessary negative values.
However, when <code>color_max &lt;= 1</code> it uses <code>pretty(c(0, color_max))</code>,
removing extraneous values, then ensuring the maximum value is
<code>color_max</code>. For example when <code>color_max=0.85</code>,
the <code>legend_at</code> is likely to be <code>c(0, 0.2, 0.4, 0.6, 0.8, 0.85)</code>.</p></li>
<li><p>When <code>centerby_colnames</code> is not <code>FALSE</code>, and/or data contains
negative values, the <code>legend_at</code> is symmetric above and below zero.
When <code>color_max &lt;= 1</code> the label is created using
<code>pretty(c(-color_max, color_max))</code>, as described above, so <code>color_max</code>
is used as the minimum and maximum value.
When <code>color_max &gt; 1</code> the <code>legend_at</code> uses integer steps.</p></li>
<li><p>When <code>color_max &lt;= 1</code> the <code>legend_labels</code> are presented as-is with
no transformation.</p></li>
<li><p>When <code>color_max &gt; 1</code> the <code>legend_labels</code> are transformed with
<code>exp2signed(x)</code> which is the inverse of <code>log2(1 + x)</code>. This inverse
tranform displays normal space values, in the case of centered data,
the values represent normal space fold changes.
For example the <code>legend_at=c(-2, -1, 0, 1, 2)</code> would result in
<code>legend_labels=c("-4", "-2", "1", "2", "4")</code>.</p></li>
<li><p>When <code>correlation=TRUE</code> the <code>legend_labels</code> by default use <code>legend_at</code>,
following rules for <code>color_max &lt;= 1</code> above.
Otherwise, <code>legend_labels</code> values inverse transformed from <code>log2(1 + x)</code>
in order to display normal space fold change values,</p></li>
<li><p>To override any of this behavior, supply both <code>legend_at</code>
and corresponding <code>legend_labels</code>.</p></li>
</ul></dd>


<dt>subset_legend_colors</dt>
<dd><p><code>logical</code> indicating whether to subset colors
shown in the color key defined by <code>sample_color_list</code>, which is useful
when the heatmap only represents a subset of categorical color values.</p><ul><li><p>When <code>subset_legend_colors == TRUE</code>, the color key will only
include colors shown in the <code>top_annotation</code>.</p></li>
<li><p>When <code>subset_legend_colors == FALSE</code> all colors defined in
<code>sample_color_list</code> will be included for each relevant column.</p></li>
</ul></dd>


<dt>row_cex, column_cex</dt>
<dd><p><code>numeric</code> values used to adjust the row and
column name font size, relative to the automatic adjustment that
is already done based upon the number of rows and columns being
displayed.</p></dd>


<dt>row_anno_fontsize</dt>
<dd><p><code>numeric</code> base font size for row
annotation labels. This value is only used when <code>left_annotation_name_gp</code>
is not supplied. Note these labels appears underneath row annotations,
alongside column labels, and therefore they are also adjusted
by multiplying <code>column_cex</code> so these labels are adjusted together.</p></dd>


<dt>useMedian</dt>
<dd><p><code>logical</code> passed to <code><a href="https://rdrr.io/pkg/jamma/man/centerGeneData.html" class="external-link">jamma::centerGeneData()</a></code> during
data centering.</p></dd>


<dt>show_row_names, show_row_dend</dt>
<dd><p><code>logical</code> indicating whether to
display row names, and row dendrogram, respectively. With more than
2,000 rows this step can become somewhat slow.</p></dd>


<dt>mark_rows</dt>
<dd><p><code>character</code> vector of values in <code>rownames(se)</code> that
should be labeled using <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/anno_mark.html" class="external-link">ComplexHeatmap::anno_mark()</a></code> in call-out
style. Usually this argument is used when <code>show_row_names=FALSE</code>,
hiding the row labels, but is not required. Values in <code>mark_rows</code>
are intersected with rows displayed in the heatmap, therefore only
matching entries will be labeled.</p></dd>


<dt>mark_labels_gp</dt>
<dd><p><code><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">grid::gpar</a></code> to customize the font used by labels
when <code>mark_rows</code> is supplied.</p></dd>


<dt>column_title</dt>
<dd><p><code>character</code> optional title to include at the top
of the heatmap. It can include a single value, or multiple values
representing each <code>column_split</code> in the order they appear.</p><ul><li><p>Note: This argument is ignored when <code>apply_hm_column_title=TRUE</code>.</p></li>
<li><p>When <code>column_title=character(0)</code> (default) or <code>column_title=""</code>,
the <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code> uses its usual default behavior,
which is to assign <code>column_title</code> using <code>column_split</code> values
when they are being used.</p></li>
</ul></dd>


<dt>apply_hm_column_title</dt>
<dd><p><code>logical</code> (default FALSE) whether to
apply the heatmap title to <code>column_title</code>. This option makes it
convenient to display the title atop the heatmap without additional
effort, however it hides any other <code>column_title</code> created by
using <code>column_split</code>.
When using both <code>column_split</code> and <code>apply_hm_column_title=TRUE</code>
it may be useful to call <code><a href="heatmap_column_group_labels.html">heatmap_column_group_labels()</a></code>.</p></dd>


<dt>hm_title_buffer</dt>
<dd><p><code>numeric</code> number of whitespace lines to add
to the heatmap title <code>(attr(hm, "hm_title")</code> between the title
and the heatmap below it. This whitespace can be useful when also
calling <code><a href="heatmap_column_group_labels.html">heatmap_column_group_labels()</a></code>, to provide enough space
to draw the additional annotations.</p></dd>


<dt>show_heatmap_legend, show_left_legend, show_top_legend</dt>
<dd><p><code>logical</code>
indicating whether each legend should be displayed. Sometimes there
are too many annotations, and the color legends can overwhelm the
figure. Note that <code>show_left_legend</code> is applied in a specific order,
with these rules:</p><ul><li><p><code>show_left_legend</code> is extended to at least length 2, then values
are used in order for: <code>sestats</code>, <code>rowData_colnames</code>, in order,
using whichever is defined.</p></li>
<li><p>If <code>sestats</code> is defined, the first value in <code>show_left_legend</code>
is used for this annotation, then the remaining values are used
for <code>rowData_colnames</code>. Setting the first <code>show_left_legend</code> value
to <code>FALSE</code> will ensure the legend for <code>sestats</code> is not displayed.</p></li>
<li><p>If <code>rowData_colnames</code> is defined, then the remaining values in
<code>show_left_legend</code> are recycled for all columns in
<code>rowData_colnames</code>, and applied in order.
In this way, individual columns can have the legend displayed or hidden.</p></li>
<li><p>If <code>alt_sestats</code> is defined, the legend is always hidden, in favor
of showing only the legend for <code>sestats</code> without duplicating this legend.</p></li>
</ul></dd>


<dt>legend_border_color</dt>
<dd><p><code>character</code> color used as border color tofor
be used as a border color for the various legend colors. Note this
argument recognizes only the first color provided, and does not
recycle different colors across the various legend borders.</p></dd>


<dt>show_top_annotation_name, show_left_annotation_name</dt>
<dd><p><code>logical</code>
indicating whether to display the annotation name beside the top and
left annotations, respectively.</p></dd>


<dt>row_label_colname</dt>
<dd><p><code>character</code> string used as a row label, where
this value is a colname in <code>rowData(se)</code>. It is useful when rownames
are some identifier that is not user-friendly, and where another column
in the data may provide a more helpful label, for example <code>"SYMBOL"</code>
to display gene symbol instead of accession number.</p></dd>


<dt>cluster_columns, cluster_rows</dt>
<dd><p><code>logical</code> indicating whether
to cluster columns by hierarchical clustering; or <code>function</code> with
a specific function that produces <code>hclust</code> or <code>dendrogram</code> output,
given a <code>numeric</code> matrix. Note that <code>cluster_rows</code> default will replace
<code>NA</code> values with zero <code>0</code> to avoid errors with missing data, and
uses <code><a href="https://rdrr.io/pkg/amap/man/hcluster.html" class="external-link">amap::hcluster()</a></code> by default which is a one-step compiled
process to perform distance calculation and hierarchical clustering.</p></dd>


<dt>column_names_gp</dt>
<dd><p><code>gpar</code> to define custom column name settings.
When <code>"fontsize"</code> is not defined, the automatic font size calculation
is added to the <code>column_names_gp</code> supplied.</p></dd>


<dt>column_split</dt>
<dd><p><code>character</code> or <code>integer</code> vector used to define
heatmap column split.</p></dd>


<dt>column_split_sep</dt>
<dd><p><code>character</code> string used as delimited when
<code>column_split</code> defines multiple split levels.</p></dd>


<dt>color_max</dt>
<dd><p><code>numeric</code> value passed to <code><a href="https://rdrr.io/pkg/colorjam/man/col_div_xf.html" class="external-link">colorjam::col_div_xf()</a></code>
which defines the upper limit of color gradient used in the heatmap.</p></dd>


<dt>color_floor</dt>
<dd><p><code>numeric</code> value passed to <code><a href="https://rdrr.io/pkg/colorjam/man/col_div_xf.html" class="external-link">colorjam::col_div_xf()</a></code>
argument <code>floor</code> which defines the minimum non-zero numeric value
for a color to be applied. This option is available to prevent coloring
values below the <code>color_floor</code> which can be useful in some circumstances.</p></dd>


<dt>lens</dt>
<dd><p><code>numeric</code> value passed to <code><a href="https://rdrr.io/pkg/colorjam/man/col_div_xf.html" class="external-link">colorjam::col_div_xf()</a></code> to control
the intensity of color gradient applied to the numeric range.</p></dd>


<dt>rename_contrasts, rename_alt_contrasts</dt>
<dd><p><code>logical</code> (default TRUE)
whether to rename long contrast names in <code>sestats</code> and <code>alt_sestats</code>
using <code><a href="contrast2comp.html">contrast2comp()</a></code>.</p></dd>


<dt>use_raster</dt>
<dd><p><code>logical</code> passed to <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code> to
determine whether heatmaps should be converted to raster images,
which effectively turns each heatmap panel into a single graphical
object.
Recommend <code>use_raster=TRUE</code> and also installing R package <code>magick</code>
which greatly enhances speed and quality of rasterized heatmap
output. When <code>magick</code> is not available, it may be best to use
<code>use_raster=FALSE</code>.
When <code>use_raster=FALSE</code> each pixel square of a heatmap
is its own graphical object. For heatmaps with very large dimensions,
having each pixel as an object can make the heatmap extremely large
in memory, and sometimes pixels can overlap others because the
minimum pixel size of the output graphics device does not
reflect the actual size of each pixel.</p></dd>


<dt>verbose</dt>
<dd><p><code>logical</code> indicating whether to print verbose output.</p></dd>


<dt>debug</dt>
<dd><p><code>logical</code> indicating debug mode, data is returned in a <code>list</code>:</p><ul><li><p><code>hm</code> object <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap</a></code></p></li>
<li><p><code>top_annotation</code> object <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/HeatmapAnnotation.html" class="external-link">ComplexHeatmap::HeatmapAnnotation</a></code> for columns</p></li>
<li><p><code>left_annotation</code> object <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/HeatmapAnnotation.html" class="external-link">ComplexHeatmap::HeatmapAnnotation</a></code> for rows</p></li>
<li><p><code>hm_title</code> object <code>character</code> string with the heatmap title.</p></li>
</ul></dd>


<dt>...</dt>
<dd><p>additional arguments are passed to supporting functions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Note: Still a work in progress. This function is the basis
for the majority of heatmaps created for Omics data.</p>
<p>This function is a bold attempt to simplify the intricate task
of creating an expression heatmap, using <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code>,
given a <code>SummarizedExperiment</code> object.</p>
<p>It attempts to enable:</p><ul><li><p>selection of <code>assays(se)</code> to use in the heatmap</p></li>
<li><p>use of <code>rowData(se)</code> or <code>colData(se)</code> to produce row and
column annotations, respectively.</p></li>
<li><p>re-use of defined colors for annotations, see <code><a href="https://rdrr.io/pkg/platjam/man/design2colors.html" class="external-link">platjam::design2colors()</a></code></p></li>
<li><p>define and adjust heatmap color gradient and scale</p></li>
<li><p>data centering by row: versus all columns, or specific controls,
optionally within independent centering groups</p></li>
<li><p>filtering rows to show only the statistical hits</p></li>
<li><p>display annotation of statistical hits beside the heatmap</p></li>
<li><p>split rows or columns using <code>rowData(se)</code> and <code>colData(se)</code>, respectively</p></li>
<li><p>heatmap title to display key options used, for easy reference</p></li>
</ul><div class="section">
<h3 id="additional-features">Additional Features<a class="anchor" aria-label="anchor" href="#additional-features"></a></h3>

<ul><li><p>data centering can be disabled with <code>centerby_colnames=FALSE</code>.</p></li>
<li><p>alternative hits can be displayed using <code>alt_sestats</code>. It does not
subset heatmap rows, it inherits rows from <code>sestats</code>.</p></li>
<li><p>display a subset of columns after row centering, useful to hide
the control group for certain figures.</p></li>
<li><p>option to display correlation heatmap, using the same data
centering, then calculates Pearson correlation across sample columns.</p></li>
<li><p>labels and legend grids can be customized to exact sizes
with <code><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">grid::gpar()</a></code> and <code><a href="https://rdrr.io/r/grid/unit.html" class="external-link">grid::unit()</a></code> definitions, for manuscript figures.</p></li>
<li><p>mark annotations option to label a subset of rows</p></li>
<li><p>row subclusters can be visualized using <code>row_subcluster</code> to drill down
into specific subclusters from hierarchical clustering, k-means clustering,
or any <code>row_split</code>.</p></li>
</ul></div>

<div class="section">
<h3 id="data-centering">Data Centering<a class="anchor" aria-label="anchor" href="#data-centering"></a></h3>


<p>The intent is to display expression values from <code>assays(se)</code>,
centered across all columns, or with customization defined by
<code>centerby_colnames</code> and <code>normgroup_colnames</code>. The resulting centered
data can be subsetted by argument <code>isamples</code>, which occurs after
centering in order to decouple the centering step from the display
of resulting data. To subset samples involved in centering itself,
either subset the input <code>se</code> data, or supply <code>controlSamples</code> to
define a subset of samples used as the baseline in centering.
See <code><a href="https://rdrr.io/pkg/jamma/man/centerGeneData.html" class="external-link">jamma::centerGeneData()</a></code> for more details.</p>
<p>Paired data, also called repeated measures data, can be visualized
by including the pairing as <code>centerby_colnames</code> so that centering
is calculated within each pairing subgroup. In this case if also using
<code>controlSamples</code> to define a "time zero" or "baseline", then all
baseline samples will have exactly zero, if there is only one replicate
per pairing group at the baseline. In this case, it may be useful
to create the full heatmap once to confirm the centering is performing
as intended, then create a second heatmap using <code>isamples</code> to show only
the non-baseline samples - thus removing the large chunk of values with 0.</p>
<p>Note: data centering can be disabled with <code>centerby_colnames=FALSE</code>.</p>
</div>

<div class="section">
<h3 id="heatmap-title">Heatmap Title<a class="anchor" aria-label="anchor" href="#heatmap-title"></a></h3>


<p>A heatmap title is returned as an attribute <code>attr(hm, "hm_title")</code>,
which describes:</p><ul><li><p>total rows displayed, with <code>row_type</code> indicating the measured entity
(gene, probe, DEGs, etc.)</p></li>
<li><p>total columns displayed, with <code>column_type</code> indicating the sampled entity
(samples, total replicates, etc.)</p></li>
<li><p>the <code>assay_name</code> for the data being displayed</p></li>
<li><p>relevant options for data centering, for example
<code>"global-centered"</code> (by default) or
<code>"Centered within Cell Line, versus Wildtype"</code></p></li>
</ul><p>To include the heatmap title:</p>
<p><code>ComplexHeatmap::draw(hm, column_title=attr(hm, "hm_title))</code></p>
</div>

<div class="section">
<h3 id="top-and-left-annotations">Top and Left Annotations<a class="anchor" aria-label="anchor" href="#top-and-left-annotations"></a></h3>


<p>The top heatmap annotations use <code>colData(se)</code> with user-supplied
<code>top_colnames</code> or by auto-detecting those colnames that apply
to multiple <code>colnames(se)</code>.
Colors can be supplied using argument <code>sample_color_list</code>, as
described below.</p>
<p>The an incidence matrix of statistical hits can be displayed
on the left of the heatmap, using arguments <code>sestats</code> and <code>alt_sestats</code>.
These arguments can accept either the output of <code><a href="se_contrast_stats.html">se_contrast_stats()</a></code>,
or they can be a <code>numeric</code> matrix with values <code>c(-1, 0, 1)</code>, indicating
statistical hits down, no change, and up, respectively.
The contrasts can optionally be subset with <code>contrast_names</code>,
which corresponds to columns in the matrix if supplied in that format.</p>
<p>When <code>sestats</code> is supplied, it will subset all heatmap rows to include
only rows with at least one non-zero value in the incidence matrix.
If argument <code>rows</code> is supplied, then all <code>rownames(se)</code> matching
<code>rows</code> are displayed, regardless of statistical hits.</p>
<p>For comparison across other <code>sestats</code> results, argument <code>alt_sestats</code>
is treated similar to <code>sestats</code> except that the heatmap is not subset
based upon these values. That means the heatmap will be subset to
match hits defined by <code>sestats</code> but not <code>alt_sestats</code>.
The <code>alt_sestats</code> incidence matrix is displayed to the far left
of the <code>sestats</code> incidence matrix. For clarity, it can be useful to
add <code>alt_sestats_suffix</code> to add a suffix to each contrast label,
for example if <code>sestats</code> represents limma hits, use
<code>sestats_suffix=" limma"</code>, and if <code>alt_sestats</code> represents limma-voom
hits, use <code>alt_sestats_suffix=" limmavoom"</code>.</p>
<p>Argument <code>rowData_colnames</code> can be supplied, which enables display of
<code>rowData(se)</code> annotations in the <code>left_annotation</code> of the heatmap.
Colors can be supplied using argument <code>sample_color_list</code>.</p>
<p>Argument <code>sample_color_list</code> is a <code>list</code> named by each annotation column
to be displayed as top or left annotation. Each list element is either:</p><ul><li><p>a <code>character</code> vector of R colors named by <code>character</code> value, or</p></li>
<li><p>a <code>function</code> defined by <code><a href="https://rdrr.io/pkg/circlize/man/colorRamp2.html" class="external-link">circlize::colorRamp2()</a></code> to be applied
for <code>numeric</code> column values. In this case the <code>breaks</code> used to
define the color function are used to define the color legend.</p></li>
</ul><p>The function <code><a href="https://rdrr.io/pkg/platjam/man/design2colors.html" class="external-link">platjam::design2colors()</a></code> can be used to create
<code>sample_color_list</code> starting with a <code>data.frame</code> of annotations,
and will soon be moved into this package.</p>
<p>A custom <code>left_annotation</code> can be supplied, but this method currently
prevents the other annotations described above from being displayed.
To display automated annotations with <code>rowData_colnames</code> and custom
row annotations, supply custom annotations with <code>right_annotation</code>.
Note that annotations must be supplied in exact row order, which
is usually easiest when supplying <code>rows</code> with specific set of rows.</p>
</div>

<div class="section">
<h3 id="compatible-input-formats">Compatible Input Formats<a class="anchor" aria-label="anchor" href="#compatible-input-formats"></a></h3>


<p>Data provided in <code>se</code> is expected to be <code>SummarizedExperiment</code>, however
other Bioconductor data types are accepted that provide
accessor functions: <code>featureData()</code>, <code>phenoData()</code>, and <code>assayData()</code>,
including for example the <code>"MethyLumiSet"</code> class.</p>
<p>Note that <code>matrix</code> input is currently not supported, however it can
be converted to <code>SummarizedExperiment</code> like this:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/RangedSummarizedExperiment-class.html" class="external-link">SummarizedExperiment</a></span><span class="op">(</span></span>
<span>   assays<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">matrix</span><span class="op">)</span>,</span>
<span>   rowData<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Gene<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">matrix</span><span class="op">)</span><span class="op">)</span>,</span>
<span>   colData<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Sample<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">matrix</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre><p></p></div>
</div>

    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other jamses heatmaps: 
<code><a href="detect_heatmap_components.html">detect_heatmap_components</a>()</code>,
<code><a href="heatmap_column_group_labels.html">heatmap_column_group_labels</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu"><a href="make_se_test.html">make_se_test</a></span><span class="op">(</span>nrow<span class="op">=</span><span class="fl">1000</span>, ngroups<span class="op">=</span><span class="fl">4</span>, nreps<span class="op">=</span><span class="fl">8</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># optionally define factor levels to force the order of labels</span></span></span>
<span class="r-in"><span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">Class</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">LETTERS</span>, <span class="fl">5</span><span class="op">)</span>, size<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span>, replace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># basic heatmap</span></span></span>
<span class="r-in"><span><span class="va">hm</span> <span class="op">&lt;-</span> <span class="fu">heatmap_se</span><span class="op">(</span><span class="va">se</span>, rowData_colnames<span class="op">=</span><span class="st">"Class"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># draw by printing hm, or call draw() to add useful options</span></span></span>
<span class="r-in"><span><span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw</a></span><span class="op">(</span><span class="va">hm</span>,</span></span>
<span class="r-in"><span>   column_title<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">hm</span>, <span class="st">"hm_title"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   merge_legends<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="heatmap_se-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># define specific colors</span></span></span>
<span class="r-in"><span><span class="va">sample_color_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>   group<span class="op">=</span><span class="fu">colorjam</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/colorjam/man/group2colors.html" class="external-link">group2colors</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">group</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   Class<span class="op">=</span><span class="fu">colorjam</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/colorjam/man/group2colors.html" class="external-link">group2colors</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">Class</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">heatmap_se</span><span class="op">(</span><span class="va">se</span>,</span></span>
<span class="r-in"><span>   rowData_colnames<span class="op">=</span><span class="st">"Class"</span>,</span></span>
<span class="r-in"><span>   sample_color_list<span class="op">=</span><span class="va">sample_color_list</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="heatmap_se-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># split rows by "Class"</span></span></span>
<span class="r-in"><span><span class="fu">heatmap_se</span><span class="op">(</span><span class="va">se</span>,</span></span>
<span class="r-in"><span>   rowData_colnames<span class="op">=</span><span class="st">"Class"</span>,</span></span>
<span class="r-in"><span>   row_split<span class="op">=</span><span class="st">"Class"</span>,</span></span>
<span class="r-in"><span>   sample_color_list<span class="op">=</span><span class="va">sample_color_list</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="heatmap_se-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># let's have some fun now</span></span></span>
<span class="r-in"><span><span class="va">hm2</span> <span class="op">&lt;-</span> <span class="fu">heatmap_se</span><span class="op">(</span><span class="va">se</span>,</span></span>
<span class="r-in"><span>   column_split<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   column_title_rot<span class="op">=</span><span class="fl">90</span>,</span></span>
<span class="r-in"><span>   row_split<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Class"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   rowData_colnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Class"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   cluster_row_slices<span class="op">=</span><span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>   sample_color_list<span class="op">=</span><span class="va">sample_color_list</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hm2drawn</span> <span class="op">&lt;-</span> <span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw</a></span><span class="op">(</span><span class="va">hm2</span>, merge_legends<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="heatmap_se-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># as an example, extract the row order</span></span></span>
<span class="r-in"><span><span class="co"># technically you should use hm2drawn, but usually hm2 is enough</span></span></span>
<span class="r-in"><span><span class="va">hro</span> <span class="op">&lt;-</span> <span class="fu">jamba</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jamba/man/heatmap_row_order.html" class="external-link">heatmap_row_order</a></span><span class="op">(</span><span class="va">hm2drawn</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="fu">jamba</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jamba/man/sdim.html" class="external-link">sdim</a></span><span class="op">(</span><span class="va">hro</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   rows     class</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A  196 character</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> B  210 character</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C  199 character</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> D  215 character</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> E  180 character</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">hro</span>, <span class="va">head</span>, <span class="fl">7</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   row_0620   row_0676   row_0417   row_0582   row_0858   row_0730   row_0847 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "row_0620" "row_0676" "row_0417" "row_0582" "row_0858" "row_0730" "row_0847" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $B</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   row_0546   row_0935   row_0996   row_0091   row_0172   row_0636   row_0225 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "row_0546" "row_0935" "row_0996" "row_0091" "row_0172" "row_0636" "row_0225" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   row_0966   row_0152   row_0324   row_0863   row_0535   row_0342   row_0450 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "row_0966" "row_0152" "row_0324" "row_0863" "row_0535" "row_0342" "row_0450" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $D</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   row_0959   row_0934   row_0162   row_0336   row_0911   row_0274   row_0603 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "row_0959" "row_0934" "row_0162" "row_0336" "row_0911" "row_0274" "row_0603" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $E</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   row_0331   row_0657   row_0930   row_0200   row_0378   row_0497   row_0133 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "row_0331" "row_0657" "row_0930" "row_0200" "row_0378" "row_0497" "row_0133" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># (the names will differ from values when `row_labels` are customized)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># center by WildType samples</span></span></span>
<span class="r-in"><span><span class="co"># - controlSamples</span></span></span>
<span class="r-in"><span><span class="co"># - control_label</span></span></span>
<span class="r-in"><span><span class="va">hm2</span> <span class="op">&lt;-</span> <span class="fu">heatmap_se</span><span class="op">(</span><span class="va">se</span>,</span></span>
<span class="r-in"><span>   controlSamples<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span>, <span class="va">group</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"groupA"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   control_label<span class="op">=</span><span class="st">"vs groupA"</span>,</span></span>
<span class="r-in"><span>   column_split<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   column_title_rot<span class="op">=</span><span class="fl">90</span>,</span></span>
<span class="r-in"><span>   row_split<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Class"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   rowData_colnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Class"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   cluster_row_slices<span class="op">=</span><span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>   sample_color_list<span class="op">=</span><span class="va">sample_color_list</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hm2drawn</span> <span class="op">&lt;-</span> <span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw</a></span><span class="op">(</span><span class="va">hm2</span>,</span></span>
<span class="r-in"><span>   column_title<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">hm2</span>, <span class="st">"hm_title"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   merge_legends<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="heatmap_se-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># add "callout" labels for a subset of rows</span></span></span>
<span class="r-in"><span><span class="va">mark_rows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu">jamba</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jamba/man/heatmap_row_order.html" class="external-link">heatmap_row_order</a></span><span class="op">(</span><span class="va">hm2drawn</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, size<span class="op">=</span><span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu">jamba</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jamba/man/heatmap_row_order.html" class="external-link">heatmap_row_order</a></span><span class="op">(</span><span class="va">hm2drawn</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, size<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># turn off ComplexHeatmap warning when using RStudio</span></span></span>
<span class="r-in"><span><span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/ht_opt.html" class="external-link">ht_opt</a></span><span class="op">(</span>message<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">hm3</span> <span class="op">&lt;-</span> <span class="fu">heatmap_se</span><span class="op">(</span><span class="va">se</span>,</span></span>
<span class="r-in"><span>   mark_rows<span class="op">=</span><span class="va">mark_rows</span>,</span></span>
<span class="r-in"><span>   controlSamples<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span>, <span class="va">group</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"groupA"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   control_label<span class="op">=</span><span class="st">"vs groupA"</span>,</span></span>
<span class="r-in"><span>   column_split<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   column_title_rot<span class="op">=</span><span class="fl">90</span>,</span></span>
<span class="r-in"><span>   row_split<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Class"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   rowData_colnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Class"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   cluster_row_slices<span class="op">=</span><span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>   sample_color_list<span class="op">=</span><span class="va">sample_color_list</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw</a></span><span class="op">(</span><span class="va">hm3</span>,</span></span>
<span class="r-in"><span>   column_title<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">hm3</span>, <span class="st">"hm_title"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   merge_legends<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="heatmap_se-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># sestats can accept list, incidence matrix, hit_array, or sestats</span></span></span>
<span class="r-in"><span><span class="co"># this example defines random set of hits</span></span></span>
<span class="r-in"><span><span class="va">sestats_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>   contrast1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, replace<span class="op">=</span><span class="cn">TRUE</span>, size<span class="op">=</span><span class="fl">50</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   contrast2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>, replace<span class="op">=</span><span class="cn">TRUE</span>, size<span class="op">=</span><span class="fl">50</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">50</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hm4</span> <span class="op">&lt;-</span> <span class="fu">heatmap_se</span><span class="op">(</span><span class="va">se</span>,</span></span>
<span class="r-in"><span>   controlSamples<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span>, <span class="va">group</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"groupA"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   control_label<span class="op">=</span><span class="st">"vs groupA"</span>,</span></span>
<span class="r-in"><span>   sestats<span class="op">=</span><span class="va">sestats_list</span>,</span></span>
<span class="r-in"><span>   column_split<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   row_split<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Class"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   rowData_colnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Class"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   cluster_row_slices<span class="op">=</span><span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>   sample_color_list<span class="op">=</span><span class="va">sample_color_list</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw</a></span><span class="op">(</span><span class="va">hm4</span>,</span></span>
<span class="r-in"><span>   column_title<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">hm4</span>, <span class="st">"hm_title"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   merge_legends<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="heatmap_se-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># it doesn't take much effort to run stats really quick</span></span></span>
<span class="r-in"><span><span class="va">sedesign</span> <span class="op">&lt;-</span> <span class="fu"><a href="groups_to_sedesign.html">groups_to_sedesign</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">[</span>, <span class="st">"group"</span>, drop<span class="op">=</span><span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">contrast_names</span><span class="op">(</span><span class="va">sedesign</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">jamba</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jamba/man/vigrep.html" class="external-link">vigrep</a></span><span class="op">(</span><span class="st">"-groupA"</span>, <span class="fu">contrast_names</span><span class="op">(</span><span class="va">sedesign</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sestats</span> <span class="op">&lt;-</span> <span class="fu"><a href="se_contrast_stats.html">se_contrast_stats</a></span><span class="op">(</span>se<span class="op">=</span><span class="va">se</span>,</span></span>
<span class="r-in"><span>   fold_cutoff<span class="op">=</span><span class="fl">4</span>,</span></span>
<span class="r-in"><span>   sedesign<span class="op">=</span><span class="va">sedesign</span>, assay_name<span class="op">=</span><span class="st">"counts"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hm4s</span> <span class="op">&lt;-</span> <span class="fu">heatmap_se</span><span class="op">(</span><span class="va">se</span>,</span></span>
<span class="r-in"><span>   controlSamples<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span>, <span class="va">group</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"groupA"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   control_label<span class="op">=</span><span class="st">"vs groupA"</span>,</span></span>
<span class="r-in"><span>   sestats<span class="op">=</span><span class="va">sestats</span>,</span></span>
<span class="r-in"><span>   column_split<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   row_split<span class="op">=</span><span class="fl">6</span>,</span></span>
<span class="r-in"><span>   rowData_colnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Class"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   cluster_row_slices<span class="op">=</span><span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>   sample_color_list<span class="op">=</span><span class="va">sample_color_list</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw</a></span><span class="op">(</span><span class="va">hm4s</span>,</span></span>
<span class="r-in"><span>   column_title<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">hm4s</span>, <span class="st">"hm_title"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   merge_legends<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="heatmap_se-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># for fun, "drill down" into cluster 5</span></span></span>
<span class="r-in"><span><span class="va">hm4s_4</span> <span class="op">&lt;-</span> <span class="fu">heatmap_se</span><span class="op">(</span><span class="va">se</span>,</span></span>
<span class="r-in"><span>   controlSamples<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span>, <span class="va">group</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"groupA"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   control_label<span class="op">=</span><span class="st">"vs groupA"</span>,</span></span>
<span class="r-in"><span>   sestats<span class="op">=</span><span class="va">sestats</span>,</span></span>
<span class="r-in"><span>   column_split<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   row_split<span class="op">=</span><span class="fl">6</span>,</span></span>
<span class="r-in"><span>   row_subcluster<span class="op">=</span><span class="fl">4</span>,</span></span>
<span class="r-in"><span>   rowData_colnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Class"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   cluster_row_slices<span class="op">=</span><span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>   sample_color_list<span class="op">=</span><span class="va">sample_color_list</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The heatmap has not been initialized. You might have different results</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> if you repeatedly execute this function, e.g. when row_km/column_km was</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> set. It is more suggested to do as `ht = draw(ht); row_order(ht)`.</span>
<span class="r-in"><span><span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw</a></span><span class="op">(</span><span class="va">hm4s_4</span>,</span></span>
<span class="r-in"><span>   column_title<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">hm4s_4</span>, <span class="st">"hm_title"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   merge_legends<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="heatmap_se-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># sestats can be provided as an incidence matrix</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu">jamba</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/jamba/man/check_pkg_installed.html" class="external-link">check_pkg_installed</a></span><span class="op">(</span><span class="st">"venndir"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co"># convert sestats to list</span></span></span>
<span class="r-in"><span><span class="va">sestats_hitlist</span> <span class="op">&lt;-</span> <span class="fu"><a href="hit_array_to_list.html">hit_array_to_list</a></span><span class="op">(</span><span class="va">sestats</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># convert sestats hitlist to incidence matrix</span></span></span>
<span class="r-in"><span><span class="co"># - for fun, use only the first two contrasts</span></span></span>
<span class="r-in"><span><span class="va">sestats_hitim</span> <span class="op">&lt;-</span> <span class="fu">venndir</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/venndir/man/list2im_value.html" class="external-link">list2im_value</a></span><span class="op">(</span><span class="va">sestats_hitlist</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sestats_hitim</span><span class="op">)</span><span class="op">)</span>;</span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># convert sestats_list to signed incidence matrix</span></span></span>
<span class="r-in"><span><span class="va">sestats_im</span> <span class="op">&lt;-</span> <span class="fu">venndir</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/venndir/man/list2im_value.html" class="external-link">list2im_value</a></span><span class="op">(</span><span class="va">sestats_list</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sestats_im</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="co"># if the list has items (no direction) use venndir::list2im_opt()</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">hm5</span> <span class="op">&lt;-</span> <span class="fu">heatmap_se</span><span class="op">(</span><span class="va">se</span>,</span></span>
<span class="r-in"><span>   controlSamples<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span>, <span class="va">group</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"groupA"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   control_label<span class="op">=</span><span class="st">"vs groupA"</span>,</span></span>
<span class="r-in"><span>   sestats<span class="op">=</span><span class="va">sestats_hitim</span>,</span></span>
<span class="r-in"><span>   column_split<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   rowData_colnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Class"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   cluster_row_slices<span class="op">=</span><span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>   sample_color_list<span class="op">=</span><span class="va">sample_color_list</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw</a></span><span class="op">(</span><span class="va">hm5</span>,</span></span>
<span class="r-in"><span>   column_title<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">hm5</span>, <span class="st">"hm_title"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   merge_legends<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          groupB-groupA groupC-groupA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> row_0022            -1            -1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> row_0030            -1             0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> row_0066             1             0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> row_0075             1             0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> row_0080            -1             0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> row_0087             1             0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          contrast1 contrast2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> row_0154        -1         0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> row_0149         1         0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> row_0267        -1         0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> row_0839        -1         0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> row_0753         1         0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> row_0818         1         0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> row_0032         1         0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> row_0545        -1         0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> row_0052        -1         0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> row_0851        -1         0</span>
<span class="r-plt img"><img src="heatmap_se-10.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># customize column label fonts using column_names_gp</span></span></span>
<span class="r-in"><span><span class="va">column_bold</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>   <span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">group</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"groupA"</span>,</span></span>
<span class="r-in"><span>   <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">hm6</span> <span class="op">&lt;-</span> <span class="fu">heatmap_se</span><span class="op">(</span><span class="va">se</span>,</span></span>
<span class="r-in"><span>   controlSamples<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span>, <span class="va">group</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"groupA"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   control_label<span class="op">=</span><span class="st">"vs WildType"</span>,</span></span>
<span class="r-in"><span>   column_names_gp<span class="op">=</span><span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">sample_color_list</span><span class="op">$</span><span class="va">group</span><span class="op">[</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">group</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>      font<span class="op">=</span><span class="va">column_bold</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   column_split<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   row_split<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Class"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   rowData_colnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Class"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   cluster_row_slices<span class="op">=</span><span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>   sample_color_list<span class="op">=</span><span class="va">sample_color_list</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw</a></span><span class="op">(</span><span class="va">hm6</span>,</span></span>
<span class="r-in"><span>   column_title<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">hm6</span>, <span class="st">"hm_title"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   merge_legends<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="heatmap_se-11.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># correlation=TRUE, any heatmap becomes a sample correlation heatmap</span></span></span>
<span class="r-in"><span><span class="va">hm6corr</span> <span class="op">&lt;-</span> <span class="fu">heatmap_se</span><span class="op">(</span><span class="va">se</span>,</span></span>
<span class="r-in"><span>   correlation<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>   apply_hm_column_title<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>   controlSamples<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span>, <span class="va">group</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"groupA"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   control_label<span class="op">=</span><span class="st">"vs groupA"</span>,</span></span>
<span class="r-in"><span>   column_names_gp<span class="op">=</span><span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/gpar.html" class="external-link">gpar</a></span><span class="op">(</span>col<span class="op">=</span><span class="va">sample_color_list</span><span class="op">$</span><span class="va">group</span><span class="op">[</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">group</span><span class="op">)</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>      font<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">24</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   column_split<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Group"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   sample_color_list<span class="op">=</span><span class="va">sample_color_list</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw</a></span><span class="op">(</span><span class="va">hm6corr</span>,</span></span>
<span class="r-in"><span>   merge_legends<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="heatmap_se-12.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Final heatmap:</span></span></span>
<span class="r-in"><span><span class="co"># 1. Applies heatmap title automatically.</span></span></span>
<span class="r-in"><span><span class="co"># 2. Hides the top_colnames</span></span></span>
<span class="r-in"><span><span class="co"># 3. Adds fancy grouped labels above the heatmap.</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># apply_hm_column_title=TRUE</span></span></span>
<span class="r-in"><span><span class="co">#    convenient way to define a title,</span></span></span>
<span class="r-in"><span><span class="co">#    but it does not also display column_split labels</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># hm_title_buffer=4</span></span></span>
<span class="r-in"><span><span class="co">#    convenient way to insert some whitespace lines</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># heatmap_column_group_labels()</span></span></span>
<span class="r-in"><span><span class="co">#    adds to a drawn heatmap - it must already be drawn</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">Genotype</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WT"</span>, <span class="st">"KO"</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">16</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">Treatment</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"Dex"</span><span class="op">)</span>, each<span class="op">=</span><span class="fl">8</span><span class="op">)</span>;</span></span>
<span class="r-in"><span><span class="va">hm7</span> <span class="op">&lt;-</span> <span class="fu">heatmap_se</span><span class="op">(</span><span class="va">se</span>,</span></span>
<span class="r-in"><span>   apply_hm_column_title<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>   hm_title_buffer<span class="op">=</span><span class="fl">3</span>,</span></span>
<span class="r-in"><span>   controlSamples<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span>, <span class="va">group</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="st">"groupA"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   control_label<span class="op">=</span><span class="st">"vs groupA"</span>,</span></span>
<span class="r-in"><span>   sestats<span class="op">=</span><span class="va">sestats_list</span>,</span></span>
<span class="r-in"><span>   top_colnames<span class="op">=</span><span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>   column_split<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   row_split<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Class"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   rowData_colnames<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Class"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   cluster_row_slices<span class="op">=</span><span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>   sample_color_list<span class="op">=</span><span class="va">sample_color_list</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hm7_drawn</span> <span class="op">&lt;-</span> <span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw</a></span><span class="op">(</span><span class="va">hm7</span>,</span></span>
<span class="r-in"><span>   merge_legends<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># now add fancy labels</span></span></span>
<span class="r-in"><span><span class="fu"><a href="heatmap_column_group_labels.html">heatmap_column_group_labels</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>   hm_group_list<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Treatment"</span>, <span class="st">"Genotype"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>   se<span class="op">=</span><span class="va">se</span>,</span></span>
<span class="r-in"><span>   hm_drawn<span class="op">=</span><span class="va">hm7_drawn</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="heatmap_se-13.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># Note: this step does not work consistently inside RStudio plot pane,</span></span></span>
<span class="r-in"><span><span class="co"># in that case call dev.new() then run the step above to create hm7_drawn,</span></span></span>
<span class="r-in"><span><span class="co"># then repeat the step below</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># adjust the height of labels with argument y_offset_lines</span></span></span>
<span class="r-in"><span><span class="co"># with positive values (upward), or negative values (downward).</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by James M. Ward.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

