<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Add Heatmap column group labels — heatmap_column_group_labels • jamses</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Add Heatmap column group labels — heatmap_column_group_labels"><meta property="og:description" content="Add Heatmap column group labels, specifically for ComplexHeatmap output."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">jamses</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.48.900</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="http://github.com/jmw86069/jamses/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Add Heatmap column group labels</h1>
    <small class="dont-index">Source: <a href="http://github.com/jmw86069/jamses/blob/HEAD/R/jam_hmgroupcolumnlabels.R" class="external-link"><code>R/jam_hmgroupcolumnlabels.R</code></a></small>
    <div class="hidden name"><code>heatmap_column_group_labels.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Add Heatmap column group labels, specifically for ComplexHeatmap output.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">heatmap_column_group_labels</span><span class="op">(</span></span>
<span>  <span class="va">hm_group_list</span>,</span>
<span>  hm_drawn <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  se <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  add_group_label <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  add_group_line <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  add_group_box <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  group_line_buffer <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"mm"</span><span class="op">)</span>,</span>
<span>  group_line_lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  group_box_lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  group_box_outer <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  font_cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  hm_title_base <span class="op">=</span> <span class="st">"centered\nexpression_column_title_"</span>,</span>
<span>  hm_body_base <span class="op">=</span> <span class="st">"centered\nexpression_heatmap_body_1_"</span>,</span>
<span>  y_offset_lines <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  endlines <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>hm_group_list</dt>
<dd><p><code>character</code> or <code>list</code> with one of the
following types of content:</p><ul><li><p><code>character</code> colnames in the column data of <code>se</code> argument, specifically
<code>colnames(colData(se))</code> to define groupings.</p></li>
<li><p><code>list</code> of <code>integer</code> vectors, where list names become labels for
each group.</p></li>
</ul></dd>


<dt>hm_drawn</dt>
<dd><p><code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/HeatmapList.html" class="external-link">ComplexHeatmap::HeatmapList</a></code> object which is returned
by the function <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">ComplexHeatmap::draw()</a></code>. This object is a pointer
to the grid graphical elements required.</p></dd>


<dt>se</dt>
<dd><p><code>SummarizedExperiment</code> object, required only when <code>hm_group_list</code>
is supplied in the form of colnames of the
<code>SummarizedExperiment::colData(se)</code>.</p></dd>


<dt>add_group_label</dt>
<dd><p><code>logical</code> indicating whether to draw the group
<code>character</code> label above each group defined in <code>hm_group_list</code>.</p></dd>


<dt>add_group_line</dt>
<dd><p><code>logical</code> indicating whether to draw the group
line for each group defined in <code>hm_group_list</code>. The line is intended
to appear below the text label when <code>add_group_label=TRUE</code>.</p></dd>


<dt>add_group_box</dt>
<dd><p><code>logical</code> indicating whether to draw a box around
the heatmap region defined by each group in <code>hm_group_list</code>.</p></dd>


<dt>group_line_buffer</dt>
<dd><p><code><a href="https://rdrr.io/r/grid/unit.html" class="external-link">grid::unit</a></code> object indicating the whitespace
buffer region betwen adjacent lines when <code>add_group_line=TRUE</code>.
The default enforces 1-mm white space between lines so they
do not touch.</p></dd>


<dt>group_line_lwd</dt>
<dd><p><code>numeric</code> line width when <code>add_group_line=TRUE</code>.</p></dd>


<dt>group_box_lwd</dt>
<dd><p><code>numeric</code> line width when <code>add_group_box=TRUE</code>.</p></dd>


<dt>group_box_outer</dt>
<dd><p><code>logical</code> indicating whether to draw the group
box as an outer border, which means the border will be drawn only
on the very outer edge of the heatmap body, and will not overlap
the heatmap contents. This option is only active when
<code>add_group_box=TRUE</code>.</p></dd>


<dt>font_cex</dt>
<dd><p><code>numeric</code> adjustment for font sizes overall.</p></dd>


<dt>hm_title_base</dt>
<dd><p><code>character</code> string used to search for matching
heatmap column title grid layout regions. It is derived from the
<code>Heatmap</code> argument <code>name</code>, usually followed by <code>"_column_title_". The grid layout regions can be summarized with </code>detect_heatmap_components()`.</p></dd>


<dt>hm_body_base</dt>
<dd><p><code>character</code> string ussed to search for matching
heatmap body grid layout regions.  It is derived from the
<code>Heatmap</code> argument <code>name</code>, usually followed by <code>"_body_1_". The grid layout regions can be summarized with </code>detect_heatmap_components()`.
Note: Currently the group box only includes the first row_split,
although it is intended to include the entire set of heatmap
rows in future iterations.</p></dd>


<dt>y_offset_lines</dt>
<dd><p><code>numeric</code> adjustment used to shift the text
label and underline by this many lines of character height.
It is mainly used internally for iterative calls, when <code>hm_group_list</code>
includes multiple layers of groups. The text and underline are
intended to fill 2 character height lines, although this argument
can be used to make manual adjustments.</p></dd>


<dt>endlines</dt>
<dd><p><code>integer</code> number of blank lines to append to the end
of each group label, which has the effect of shifting the group
label upwards slightly.</p></dd>


<dt>verbose</dt>
<dd><p><code>logical</code> indicating whether to print verbose output.</p></dd>


<dt>...</dt>
<dd><p>additional arguments are ignored.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function is currently experimental, and is intended only for
a specific scenario, to augment a <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap</a></code> object,
as produced by <code><a href="heatmap_se.html">heatmap_se()</a></code>, that used the argument <code>column_split</code>
to sub-divide the heatmap columns into subgroups.
This function draws labels above the heatmap to describe group
factor values associated with column splits.</p>
<p>When there are multiple layers of grouping, this function will
also draw multiple layers. For example, when columns are split
by <code>column_split=c("Treatment", "Time")</code>, it will produce a heatmap
where each column slice has one combination of Treatment and Time.
This function can be used to add a layer of labels by <code>"Time"</code>,
and a layer of labels by <code>"Treatment"</code>. The labels are shown by default
with a broad underline to indicate contiguous column slices that
contain the same <code>"Treatment"</code> or <code>"Time"</code> values.</p>
<p>The output can provide a cleaner visualization than the alternative of
displaying colorized annotation boxes at the top of the heatmap.</p><div class="section">
<h3 id="input-formats">Input Formats<a class="anchor" aria-label="anchor" href="#input-formats"></a></h3>


<p>There are two strategies for defining the column group data to display:</p><div class="section">
<h4 id="input-using-colnames-from-coldata-se-">Input using colnames from colData(se)<a class="anchor" aria-label="anchor" href="#input-using-colnames-from-coldata-se-"></a></h4>


<p>This option is recommended as the "easiest" method. It requires:</p><ul><li><p><code>hm_group_list</code> provides a <code>character</code> vector of <code>colnames(colData(se))</code>.
Note that the columns are applied bottom-to-top, so it is sometimes
helpful to supply columns in reverse order for <code>column_split</code>.</p></li>
<li><p><code>se</code> must be provided, since it supplies <code>colData(se)</code></p></li>
</ul><p>Each value in <code>hm_group_list</code> is applied from bottom-to-top, to define
a row of labels. By default, <code>add_group_line=TRUE</code>, so labels are also
underlined to indicate samples included in each group.</p>
</div>

<div class="section">
<h4 id="input-using-a-named-list">Input using a named list<a class="anchor" aria-label="anchor" href="#input-using-a-named-list"></a></h4>


<p>This option is recommended when labeling a subset of column slices,
or when the column slice groups need to be customized in some way.</p>
</div>


</div>

<div class="section">
<h3 id="additional-requirements">Additional requirements<a class="anchor" aria-label="anchor" href="#additional-requirements"></a></h3>

<ul><li><p>The Heatmap <code>column_title</code> should be empty, so that no text
labels are drawn which may overlap the labels drawn by this function.
Use <code>column_title=" "</code> (with a whitespace character) to prevent
<code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code> from using its internal default text label.</p></li>
<li><p>There usually needs to be whitespace above the heatmap, which
can be accomplished when drawing a Heatmap object <code>hm</code> like this:
<code>ComplexHeatmap::draw(hm, column_title="\n\n\n\n")</code></p></li>
<li><p>When also displaying a heatmap title as defined by <code><a href="heatmap_se.html">heatmap_se()</a></code>,
the adjustment can be done like this:</p></li>
</ul><p></p><div class="sourceCode r"><pre><code><span><span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw</a></span><span class="op">(</span><span class="va">hm</span>,</span>
<span>   column_title<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">hm</span>, <span class="st">"hm_title"</span><span class="op">)</span>,</span>
<span>      <span class="st">"\n\n\n\n"</span><span class="op">)</span><span class="op">)</span></span></code></pre><p></p></div><ul><li><p>The arguments <code>hm_title_base</code> and <code>hm_body_base</code> should match the
heatmap name, which is defined in <code><a href="heatmap_se.html">heatmap_se()</a></code> with <code>data_type</code>,
usually prefixed <code>"centered\n"</code> when the data is centered by that
function. For example, when <code>data_type="abundance"</code>, the corresponding
argument value should be
<code>hm_title_base="centered\nabundance_column_title_"</code>.</p></li>
<li><p>use <code><a href="detect_heatmap_components.html">detect_heatmap_components()</a></code> to help identify the appropriate
<code>grid</code> elements available to be used by this function.</p></li>
</ul></div>

<div class="section">
<h3 id="todo">Todo<a class="anchor" aria-label="anchor" href="#todo"></a></h3>

<ul><li><p>Automate determining the column_title grid layout name.</p><ul><li><p>Specifically when only one <code>heatmapname_column_title_1</code> is present,
but there are multiple column groups, it should take the x-axis
coordinate values (left and right boundaries) from the heatmap body
instead of the column_title region.</p></li>
</ul></li>
<li><p>When <code>add_group_box=TRUE</code>, and <code>row_split</code> indicates multiple row
groups, it should calculate the y-axis coordinate values (top and bottom
boundaries) using the full set of row groups.</p></li>
</ul></div>

    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by James M. Ward.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

