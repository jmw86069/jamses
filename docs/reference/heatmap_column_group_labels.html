<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Add Heatmap column group labels, specifically for ComplexHeatmap output."><title>Add Heatmap column group labels — heatmap_column_group_labels • jamses</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Add Heatmap column group labels — heatmap_column_group_labels"><meta property="og:description" content="Add Heatmap column group labels, specifically for ComplexHeatmap output."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">jamses</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.69.900</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="http://github.com/jmw86069/jamses/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Add Heatmap column group labels</h1>
      <small class="dont-index">Source: <a href="http://github.com/jmw86069/jamses/blob/HEAD/R/jam_hmgroupcolumnlabels.R" class="external-link"><code>R/jam_hmgroupcolumnlabels.R</code></a></small>
      <div class="d-none name"><code>heatmap_column_group_labels.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Add Heatmap column group labels, specifically for ComplexHeatmap output.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">heatmap_column_group_labels</span><span class="op">(</span></span>
<span>  <span class="va">hm_group_list</span>,</span>
<span>  hm_drawn <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  se <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  add_group_label <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  add_group_line <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  add_group_box <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  group_line_buffer <span class="op">=</span> <span class="fu">grid</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">"mm"</span><span class="op">)</span>,</span>
<span>  group_line_lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  group_line_requires_label <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  group_box_lwd <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  group_box_outer <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  font_cex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  hm_title_base <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hm_body_base <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  hm_title_base_default <span class="op">=</span> <span class="st">"centered\nexpression_column_title_"</span>,</span>
<span>  hm_body_base_default <span class="op">=</span> <span class="st">"centered\nexpression_heatmap_body_1_"</span>,</span>
<span>  y_offset_lines <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  endlines <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  use_gridtext <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>hm_group_list</dt>
<dd><p><code>character</code> or <code>list</code> with one of the
following types of content:</p><ul><li><p><code>character</code> colnames in the column data of <code>se</code> argument, specifically
<code>colnames(colData(se))</code> to define groupings.</p></li>
<li><p><code>list</code> of <code>integer</code> vectors, where list names become labels for
each group.</p></li>
</ul></dd>


<dt>hm_drawn</dt>
<dd><p><code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/HeatmapList.html" class="external-link">ComplexHeatmap::HeatmapList</a></code> object which is returned
by the function <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">ComplexHeatmap::draw()</a></code>. This object is a pointer
to the grid graphical elements required.</p></dd>


<dt>se</dt>
<dd><p><code>SummarizedExperiment</code> object, required only when <code>hm_group_list</code>
is supplied in the form of colnames of the
<code>SummarizedExperiment::colData(se)</code>.</p></dd>


<dt>add_group_label</dt>
<dd><p><code>logical</code> indicating whether to draw the group
<code>character</code> label above each group defined in <code>hm_group_list</code>.</p></dd>


<dt>add_group_line</dt>
<dd><p><code>logical</code> indicating whether to draw the group
line for each group defined in <code>hm_group_list</code>. The line is intended
to appear below the text label when <code>add_group_label=TRUE</code>.</p></dd>


<dt>add_group_box</dt>
<dd><p><code>logical</code> indicating whether to draw a box around
the heatmap region defined by each group in <code>hm_group_list</code>.</p></dd>


<dt>group_line_buffer</dt>
<dd><p><code><a href="https://rdrr.io/r/grid/unit.html" class="external-link">grid::unit</a></code> object indicating the whitespace
buffer region betwen adjacent lines when <code>add_group_line=TRUE</code>.
The default enforces 1-mm white space between lines so they
do not touch.</p></dd>


<dt>group_line_lwd</dt>
<dd><p><code>numeric</code> line width when <code>add_group_line=TRUE</code>.</p></dd>


<dt>group_line_requires_label</dt>
<dd><p><code>logical</code> whether to require
the associated group label to contain non-whitespace visible
text.</p><ul><li><p><code>group_line_requires_label=TRUE</code> (default) requires group label
to have visible characters, which means the presence of an
empty labels will cause the group line not to be drawn.</p></li>
<li><p><code>group_line_requires_label=FALSE</code> does not require a group label,
therefore all group lines are drawn.</p></li>
</ul></dd>


<dt>group_box_lwd</dt>
<dd><p><code>numeric</code> line width when <code>add_group_box=TRUE</code>.</p></dd>


<dt>group_box_outer</dt>
<dd><p><code>logical</code> indicating whether to draw the group
box as an outer border, which means the border will be drawn only
on the very outer edge of the heatmap body, and will not overlap
the heatmap contents. This option is only active when
<code>add_group_box=TRUE</code>.</p></dd>


<dt>font_cex</dt>
<dd><p><code>numeric</code> adjustment for font sizes overall.</p></dd>


<dt>hm_title_base</dt>
<dd><p><code>character</code> string used to search for matching
heatmap column title grid layout regions. It is derived from the
<code>Heatmap</code> argument <code>name</code>, usually followed by <code>"_column_title_". When </code>NULL<code>the default values are defined by</code>detect_heatmap_components()<code>element</code>column_title_components`.</p></dd>


<dt>hm_body_base</dt>
<dd><p><code>character</code> string used to search for matching
heatmap body grid layout regions.  It is derived from the
<code>Heatmap</code> argument <code>name</code>, usually followed by <code>"_body_1_". When </code>NULL<code>the default values are defined by</code>detect_heatmap_components()<code>element</code>heatmap_body_components`.
Note: Currently the group box only includes the first row_split,
although it is intended to include the entire set of heatmap
rows in future iterations.</p></dd>


<dt>hm_title_base_default, hm_body_base_default</dt>
<dd><p><code>character</code> string
used as reference for hm_title_base,hm_body_base.</p></dd>


<dt>y_offset_lines</dt>
<dd><p><code>numeric</code> adjustment used to shift the text
label and underline by this many lines of character height.
It is mainly used internally for iterative calls, when <code>hm_group_list</code>
includes multiple layers of groups. The text and underline are
intended to fill 2 character height lines, although this argument
can be used to make manual adjustments.</p></dd>


<dt>endlines</dt>
<dd><p><code>integer</code> number of blank lines to append to the end
of each group label, which has the effect of shifting the group
label upwards slightly.</p></dd>


<dt>use_gridtext</dt>
<dd><p><code>logical</code> (default TRUE) whether to render text using
<code><a href="https://wilkelab.org/gridtext/reference/richtext_grob.html" class="external-link">gridtext::richtext_grob()</a></code> in order to enable markdown and
limited HTML-based formatting.</p></dd>


<dt>verbose</dt>
<dd><p><code>logical</code> indicating whether to print verbose output.</p></dd>


<dt>...</dt>
<dd><p>additional arguments are ignored.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function is currently experimental, and is intended only for
a specific scenario, to augment a <code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap</a></code> object,
as produced by <code><a href="heatmap_se.html">heatmap_se()</a></code>, that used the argument <code>column_split</code>
to sub-divide the heatmap columns into subgroups.
This function draws labels above the heatmap to describe group
factor values associated with column splits.</p>
<p>When there are multiple layers of grouping, this function will
also draw multiple layers. For example, when columns are split
by <code>column_split=c("Treatment", "Time")</code>, it will produce a heatmap
where each column slice has one combination of Treatment and Time.
This function can be used to add a layer of labels by <code>"Time"</code>,
and a layer of labels by <code>"Treatment"</code>. The labels are shown by default
with a broad underline to indicate contiguous column slices that
contain the same <code>"Treatment"</code> or <code>"Time"</code> values.</p>
<p>The output can provide a cleaner visualization than the alternative of
displaying colorized annotation boxes at the top of the heatmap.</p><div class="section">
<h3 id="input-formats">Input Formats<a class="anchor" aria-label="anchor" href="#input-formats"></a></h3>


<p>There are two strategies for defining the column group data to display:</p><div class="section">
<h4 id="input-using-colnames-from-coldata-se-">Input using colnames from colData(se)<a class="anchor" aria-label="anchor" href="#input-using-colnames-from-coldata-se-"></a></h4>


<p>This option is recommended as the "easiest" method. It requires:</p><ul><li><p><code>hm_group_list</code> provides a <code>character</code> vector of <code>colnames(colData(se))</code>.
Note that the columns are applied bottom-to-top, so it is sometimes
helpful to supply columns in reverse order for <code>column_split</code>.</p></li>
<li><p><code>se</code> must be provided, since it supplies <code>colData(se)</code></p></li>
</ul><p>Each value in <code>hm_group_list</code> is applied from bottom-to-top, to define
a row of labels. By default, <code>add_group_line=TRUE</code>, so labels are also
underlined to indicate samples included in each group.</p>
</div>

<div class="section">
<h4 id="input-using-a-named-list">Input using a named list<a class="anchor" aria-label="anchor" href="#input-using-a-named-list"></a></h4>


<p>This option is recommended when labeling a subset of column slices,
or when the column slice groups need to be customized in some way.</p>
</div>


</div>

<div class="section">
<h3 id="additional-requirements">Additional requirements<a class="anchor" aria-label="anchor" href="#additional-requirements"></a></h3>

<ul><li><p>The Heatmap <code>column_title</code> should (usually) be empty, so that no text
labels are drawn which may overlap the labels drawn by this function.
Use <code>column_title=" "</code> (with a whitespace character) to prevent
<code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/Heatmap.html" class="external-link">ComplexHeatmap::Heatmap()</a></code> from using its internal default text label.</p></li>
<li><p>There usually needs to be whitespace above the heatmap, which
can be accomplished when drawing a Heatmap object <code>hm</code> like this:
<code>ComplexHeatmap::draw(hm, column_title="\n\n\n\n")</code></p></li>
<li><p>When also displaying a heatmap title as defined by <code><a href="heatmap_se.html">heatmap_se()</a></code>,
the adjustment can be done like this:</p></li>
</ul><p></p><div class="sourceCode r"><pre><code><span><span class="fu">ComplexHeatmap</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ComplexHeatmap/man/draw-dispatch.html" class="external-link">draw</a></span><span class="op">(</span><span class="va">hm</span>,</span>
<span>   column_title<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">hm</span>, <span class="st">"hm_title"</span><span class="op">)</span>,</span>
<span>      <span class="st">"\n\n\n\n"</span><span class="op">)</span><span class="op">)</span></span></code></pre><p></p></div><ul><li><p>The arguments <code>hm_title_base</code> and <code>hm_body_base</code> should match the
heatmap name, which is defined in <code><a href="heatmap_se.html">heatmap_se()</a></code> with <code>data_type</code>,
usually prefixed <code>"centered\n"</code> when the data is centered by that
function. For example, when <code>data_type="abundance"</code>, the corresponding
argument value should be
<code>hm_title_base="centered\nabundance_column_title_"</code>.</p></li>
<li><p>use <code><a href="detect_heatmap_components.html">detect_heatmap_components()</a></code> to help identify the appropriate
<code>grid</code> elements available to be used by this function.</p></li>
</ul><p>When the heatmap contains <code>"column_title"</code> elements defined in
<code><a href="https://rdrr.io/pkg/ComplexHeatmap/man/list_components.html" class="external-link">ComplexHeatmap::list_components()</a></code>, and there is no element
<code>"global_column_title"</code>, the <code>y_offset_lines</code> is adjusted down so that
the position is inside the column_title region, typically below the
column_title when using trailing whitespace (see argument
<code>hm_title_buffer</code> in <code><a href="heatmap_se.html">heatmap_se()</a></code>). However, when element
<code>"global_column_title"</code> is present, the <code>y_offset_lines</code> are not adjusted,
so that the position is above the column_title region. In this case, to
position the labels below the column_title, you can adjust
<code>y_offset_lines</code> down manually like this: <code>y_offset_lines=-9</code>.</p>
</div>

<div class="section">
<h3 id="todo">Todo<a class="anchor" aria-label="anchor" href="#todo"></a></h3>

<ul><li><p>Automate determining the column_title grid layout name.</p><ul><li><p>Specifically when only one <code>heatmapname_column_title_1</code> is present,
but there are multiple column groups, it should take the x-axis
coordinate values (left and right boundaries) from the heatmap body
instead of the column_title region.</p></li>
</ul></li>
<li><p>When <code>add_group_box=TRUE</code>, and <code>row_split</code> indicates multiple row
groups, it should calculate the y-axis coordinate values (top and bottom
boundaries) using the full set of row groups.</p></li>
<li><p>Enable blank annotations, either by passing a subset <code>se</code>, or by
annotations with no associated label.</p></li>
</ul></div>

    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other jamses heatmaps: 
<code><a href="detect_heatmap_components.html">detect_heatmap_components</a>()</code>,
<code><a href="heatmap_se.html">heatmap_se</a>()</code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by James M. Ward.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

