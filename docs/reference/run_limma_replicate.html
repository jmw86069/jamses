<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Run limma contrasts with optional probe replicates"><title>Run limma contrasts with optional probe replicates — run_limma_replicate • jamses</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Run limma contrasts with optional probe replicates — run_limma_replicate"><meta property="og:description" content="Run limma contrasts with optional probe replicates"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">jamses</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.69.900</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="http://github.com/jmw86069/jamses/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Run limma contrasts with optional probe replicates</h1>
      <small class="dont-index">Source: <a href="http://github.com/jmw86069/jamses/blob/HEAD/R/jam_secontrasts.R" class="external-link"><code>R/jam_secontrasts.R</code></a></small>
      <div class="d-none name"><code>run_limma_replicate.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Run limma contrasts with optional probe replicates</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">run_limma_replicate</span><span class="op">(</span></span>
<span>  <span class="va">imatrix</span>,</span>
<span>  <span class="va">idesign</span>,</span>
<span>  <span class="va">icontrasts</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  robust <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  adjust.method <span class="op">=</span> <span class="st">"BH"</span>,</span>
<span>  confint <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  trim_colnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"t"</span>, <span class="st">"B"</span>, <span class="st">"F"</span>, <span class="st">"sca.t"</span><span class="op">)</span>,</span>
<span>  adjp_cutoff <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  p_cutoff <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fold_cutoff <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  int_adjp_cutoff <span class="op">=</span> <span class="va">adjp_cutoff</span>,</span>
<span>  int_p_cutoff <span class="op">=</span> <span class="va">p_cutoff</span>,</span>
<span>  int_fold_cutoff <span class="op">=</span> <span class="va">fold_cutoff</span>,</span>
<span>  mgm_cutoff <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  ave_cutoff <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  block <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rowData_df <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  collapse_by_gene <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  correlation <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  posthoc_test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"DEqMS"</span><span class="op">)</span>,</span>
<span>  posthoc_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>DEqMS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>PSM_counts <span class="op">=</span> <span class="cn">NULL</span>, fit.method <span class="op">=</span> <span class="st">"loess"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">123</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>confint</dt>
<dd><p><code>logical</code> passed to <code><a href="https://rdrr.io/pkg/limma/man/toptable.html" class="external-link">limma::topTable()</a></code>, which defines
whether to return confidence intervals for each log2 fold change.</p></dd>


<dt>adjp_cutoff, p_cutoff, fold_cutoff, mgm_cutoff, ave_cutoff</dt>
<dd><p><code>numeric</code>
values representing the appropriate statistical threshold,
or <code>NULL</code> when a threshold should not be applied.</p></dd>


<dt>int_adjp_cutoff, int_p_cutoff, int_fold_cutoff</dt>
<dd><p><code>numeric</code>
thresholds to apply only to interaction contrasts.</p></dd>


<dt>rowData_df</dt>
<dd><p><code>data.frame</code> representing optional rowData annotation
to be retained in the resulting stat <code>data.frame</code>. This argument
is usually defined using <code>rowData_colnames</code> in <code><a href="se_contrast_stats.html">se_contrast_stats()</a></code>,
which uses corresponding columns from <code>rowData(se)</code>.</p></dd>


<dt>collapse_by_gene</dt>
<dd><p><code>logical</code> indicating whether to apply
<code>collapse_stats_by_gene</code> which chooses one "best" exemplar per gene
when there are multiple rows that represent the same gene.</p></dd>


<dt>correlation</dt>
<dd><p><code>numeric</code> or <code>NULL</code> passed to <code><a href="https://rdrr.io/pkg/limma/man/lmFit.html" class="external-link">limma::lmFit()</a></code>.
Note that when <code>block</code> is defined (and non-empty), and when
<code>correlation=NULL</code>, the correlation will be calculated by
calling <code><a href="https://rdrr.io/pkg/limma/man/dupcor.html" class="external-link">limma::duplicateCorrelation()</a></code>.</p></dd>


<dt>seed</dt>
<dd><p><code>numeric</code> value used to define <code><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed()</a></code> for reproducibility.
To avoid setting seed, use <code>seed=NULL</code>.</p></dd>


<dt>verbose</dt>
<dd><p><code>logical</code> indicating whether to print verbose output.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>list</code> with the following entries:</p><ul><li><p>"stats_df": <code>data.frame</code> with all individual <code>data.frame</code> per contrast,
merged together.</p></li>
<li><p>"stats_df": <code>list</code> of individual <code>data.frame</code> per contrast, each
result is the output from <code><a href="ebayes2dfs.html">ebayes2dfs()</a></code>.</p></li>
<li><p>"rep_fits": <code>list</code> of various intermediate model fits, dependent
upon whether limma, limma-voom, or limma-DEqMS were used.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function is called by <code><a href="se_contrast_stats.html">se_contrast_stats()</a></code> to perform
the comparisons defined as contrasts. The <code><a href="se_contrast_stats.html">se_contrast_stats()</a></code>
function operates on a <code>SummarizedExperiment</code> object,
this function operates on the <code>numeric</code> <code>matrix</code> values
directly.</p>
<p>This function also calls <code><a href="ebayes2dfs.html">ebayes2dfs()</a></code> which extracts
each contrast result as a <code>data.frame</code>, whose column names
are modified to include the contrast names.</p>
<p>This function optionally (not yet ported from previous
implementation) detects replicate probes, and performs
the internal correlation calculations recommended by
<code>limma user guide</code> for replicate probes. In that case,
it detects each level of probe replication so that
each can be properly calculated. For example, Agilent
human 4x44 arrays often contain a large number of probes
with 8 replicates; a subset of probes with 4 replicates;
then the remaining probes (the majority overall) have
only one replicate each. In that case, this function
splits data into 8-replicate, 4-replicate, and 1-replicate
subsets, calculates correlations on the 8-replicate and
4-replicate subsets separately, then runs limma calculations
on the three subsets independently, then merges the results
into one large table. The end result is that the
final table contains one row per unique probe after
adjusting for probe replication properly in each scenario.
As the Agilent microarray layout is markedly less widely
used that in past, the priority to port this methodology
is quite low.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other jamses stats: 
<code><a href="ebayes2dfs.html">ebayes2dfs</a>()</code>,
<code><a href="format_hits.html">format_hits</a>()</code>,
<code><a href="handle_na_values.html">handle_na_values</a>()</code>,
<code><a href="hit_array_to_list.html">hit_array_to_list</a>()</code>,
<code><a href="process_sestats_to_hitim.html">process_sestats_to_hitim</a>()</code>,
<code><a href="save_sestats.html">save_sestats</a>()</code>,
<code><a href="se_contrast_stats.html">se_contrast_stats</a>()</code>,
<code><a href="sestats_to_dfs.html">sestats_to_dfs</a>()</code>,
<code><a href="sestats_to_df.html">sestats_to_df</a>()</code>,
<code><a href="voom_jam.html">voom_jam</a>()</code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by James M. Ward.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

