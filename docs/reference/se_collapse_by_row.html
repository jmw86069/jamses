<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Collapse SummarizedExperiment data by row"><title>Collapse SummarizedExperiment data by row — se_collapse_by_row • jamses</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Collapse SummarizedExperiment data by row — se_collapse_by_row"><meta property="og:description" content="Collapse SummarizedExperiment data by row"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">jamses</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.69.900</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="http://github.com/jmw86069/jamses/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Collapse SummarizedExperiment data by row</h1>
      <small class="dont-index">Source: <a href="http://github.com/jmw86069/jamses/blob/HEAD/R/jam_collapse_se.R" class="external-link"><code>R/jam_collapse_se.R</code></a></small>
      <div class="d-none name"><code>se_collapse_by_row.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Collapse SummarizedExperiment data by row</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">se_collapse_by_row</span><span class="op">(</span></span>
<span>  <span class="va">se</span>,</span>
<span>  rows <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">se</span><span class="op">)</span>,</span>
<span>  <span class="va">row_groups</span>,</span>
<span>  assay_names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  group_func_name <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sum"</span>, <span class="st">"mean"</span>, <span class="st">"weighted.mean"</span>, <span class="st">"geomean"</span>, <span class="st">"none"</span><span class="op">)</span>,</span>
<span>  rowStatsFunc <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rowDataColnames <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  keepNULLlevels <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  delim <span class="op">=</span> <span class="st">"[ ]*[;,]+[ ]*"</span>,</span>
<span>  data_transform <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"none"</span>, <span class="st">"log2p+sqrt"</span>, <span class="st">"log2+sqrt"</span>, <span class="st">"log2p"</span>, <span class="st">"log2"</span><span class="op">)</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>se</dt>
<dd><p><code>SummarizedExperiment</code></p></dd>


<dt>rows</dt>
<dd><p><code>character</code> vector of <code>rows(se)</code> to use for analysis. When
<code>rows=NULL</code> the default is to use all <code>rows(se)</code>.</p></dd>


<dt>row_groups</dt>
<dd><p><code>character</code> vector representing groups of rows to
be combined.</p></dd>


<dt>assay_names</dt>
<dd><p><code>character</code> vector of <code>names(assays(se))</code> to use for
the collapse operation. When <code>assay_names=NULL</code> the default is to
use all <code>assays(se)</code>.</p></dd>


<dt>group_func_name</dt>
<dd><p><code>character</code> name of function used to aggregate
measurement data within <code>row_groups</code>.</p><ul><li><p><code>sum</code> - takes the <code><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum()</a></code> of each value in the group. This option
should be used together with <code>data_transform</code> when there has been
any data transformation, so that the data is inverse-transformed
prior to calculating the <code><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum()</a></code>, after which data is re-transformed
to its original state. This method is appropriate for log2p
<code>log2(1 + x)</code> transformed abundance measurements for example.</p></li>
<li><p><code>mean</code> - calculates the mean value per group. Note that in this
case is it usually recommended not to define <code>data_transform</code>
so that values are averaged in the appropriately transformed
numeric space.</p></li>
<li><p><code>weighted.mean</code> - calculates <code><a href="https://rdrr.io/r/stats/weighted.mean.html" class="external-link">weighted.mean()</a></code> where weights <code>w</code>
are defined by the values used. This method may be appropriate and
effective with normal space abundance values derived from
proteomics mass spec quantitation.</p></li>
<li><p><code>geomean</code> - calculates geometric mean of values in each group.</p></li>
<li><p><code>none</code> -</p></li>
</ul></dd>


<dt>rowStatsFunc</dt>
<dd><p><code>function</code> optional function used instead of
<code>group_func_name</code>.</p></dd>


<dt>rowDataColnames</dt>
<dd><p><code>character</code> subset of colnames in <code>rowData(se)</code>
to be retained in the output data. Multiple values are combined
usually by comma-delimited concatenation within <code>row_groups</code>,
therefore it may be beneficial to include only relevant columns
in that output.</p></dd>


<dt>keepNULLlevels</dt>
<dd><p><code>logical</code> indicating whether to drop unused
factor levels in <code>row_groups</code>, this argument is passed to
<code><a href="https://rdrr.io/pkg/jamba/man/rowGroupMeans.html" class="external-link">jamba::rowGroupMeans()</a></code>.</p></dd>


<dt>delim</dt>
<dd><p><code>character</code> string indicating a delimiter.</p></dd>


<dt>data_transform</dt>
<dd><p><code>character</code> string indicating which
transformation was used when preparing the assay data. The
assumption is that all assays were transformed by this method.
During processing, data is inverse-transformed prior to applying
the <code>group_func_name</code> or <code>rowStatsFunc</code> if supplied. After that
function is applied, data is transformed using this function.
The purpose is to enable taking the <code><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum()</a></code> in proper measured
absolute units (in normal space for example) where relevant,
after which is original numeric transformation is re-applied.</p></dd>


<dt>verbose</dt>
<dd><p><code>logical</code> indicating whether to print verbose output.</p></dd>


<dt>...</dt>
<dd><p>additional arguments are passed to <code><a href="https://rdrr.io/pkg/jamba/man/rowGroupMeans.html" class="external-link">jamba::rowGroupMeans()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>SummarizedExperiment</code> object with these changes:</p><ul><li><p>rows will be collapsed by <code>row_groups</code>, for each <code>assays(se)</code>
<code>numeric</code> matrix defined by <code>assay_names</code>. The collapse may
optionally apply a data transformation defined in
<code>data_transform</code> in order to apply an appropriate <code>numeric</code> summary
calculation.</p></li>
<li><p><code>rowData(se)</code> will also be collapsed by <code><a href="shrinkDataFrame.html">shrinkDataFrame()</a></code> to
combine unique values from each row annotation.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Purpose is to collapse rows of a <code>SummarizedExperiment</code> object,
where measurements for a given entity, usually a gene, are split
across multiple rows in the source data. The output of this function
should be measurements appropriately summarized to the gene level.</p>
<p>The key arguments are <code>group_func_name</code>, and <code>data_transform</code>.
Note that data is inverse-transformed based upon <code>data_transform</code>,
prior to calculating group summary values defined by <code>group_func_name</code>.
The reason is to enable using <code>group_func_name="sum"</code> on normal
space abundance values, when input data has already been
transformed with <code>log2(1 + x)</code> for example. In this case it is most
appropriate to take the <code>sum</code> of normal space abundance values,
then to re-apply the transformation afterwards.</p>
<p>However, when using <code>group_func_name="mean"</code> it is usually
recommended to use <code>data_transform="none"</code> so that data is maintained
in appropriately transformed state.</p>
<p>The driving use case is proteomics mass spectrometry data,
where measurements are described in terms of peptide sequences,
with or without optional post-translational modification (PTM),
and the peptide sequences are annotated to a source protein or gene.
This function can be used to:</p><ul><li><p>collapse peptide-PTM data to the peptide level</p></li>
<li><p>collapse peptide data to the protein level</p></li>
</ul><p>In future it may be used to collapse multiple microarray probe
measurements to the gene level, although that process is more likely
to be useful and recommended after performing probe-level statistical
analysis.</p><div class="section">
<h3 id="proteomics-mass-spectrometry-analysis">Proteomics mass spectrometry analysis<a class="anchor" aria-label="anchor" href="#proteomics-mass-spectrometry-analysis"></a></h3>


<p>For proteomics mass spectrometry data, proteins are inconsistently
fragmented into smaller peptides of varying sizes. The peptides are
usually separated on a chromatography column, from which aliquot
fractions are taken and measured by mass spectrometry. The total
signal derived from the original protein is therefore some combination
of the measured peptide parts.</p>
<p>In some upstream data processing tools, such as Proteomics Discoverer,
and PEAKS, the peptide data may be annotated with observed
modification events (PTM). In this scenario, peptide measurements
are split across multiple rows of data, where each
row represents an observed combination of peptide and PTMs.</p>
</div>

<div class="section">
<h3 id="collapse-methods">Collapse methods<a class="anchor" aria-label="anchor" href="#collapse-methods"></a></h3>


<p>It is fairly straightforward to observe peptide-PTM measurement
data is correlated with overall protein quantification, and that
the specific combination of peptide fragments may be inconsistent
across samples. That is, one may observe five peptides of protein A
in one sample, and may observe seven peptides of protein A in
another sample. The quantities of each peptide may be inconsistent,
due to variability in protein fragmentation across samples. However,
the general sum of peptide measurements is typically fairly stable
across samples, especially for proteins of moderate to high abundance
which are known to have stable abundance per cell.</p>
<p>Choice of method to collapse measurements is not trivial, and is
therefore configurable. In general, proteomics abundances are
analyzed after <code>log2( 1 + x )</code> transformation. However, measurements
cannot be summed in log2 form, which would be equivalent to
multiplying measurements in normal form. Measurements can be summed
but only after exponentiating the data, for example the reciprocal
<code>( 2 ^ x ) - 1</code> is sufficient.</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other jamses SE utilities: 
<code><a href="make_se_test.html">make_se_test</a>()</code>,
<code><a href="se_collapse_by_column.html">se_collapse_by_column</a>()</code>,
<code><a href="se_detected_rows.html">se_detected_rows</a>()</code>,
<code><a href="se_normalize.html">se_normalize</a>()</code>,
<code><a href="se_rbind.html">se_rbind</a>()</code>,
<code><a href="se_to_rowcoldata.html">se_to_rowcoldata</a>()</code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by James M. Ward.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

