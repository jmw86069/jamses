% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/jam_sestats_hm.R
\name{heatmap_se}
\alias{heatmap_se}
\title{Expression heatmap of sestats hits}
\usage{
heatmap_se(
  se,
  sestats = NULL,
  rows = NULL,
  row_type = "rows",
  assay_name = NULL,
  contrast_names = NULL,
  contrast_suffix = "",
  cutoff_name = 1,
  alt_sestats = NULL,
  alt_assay_name = assay_name,
  alt_contrast_names = NULL,
  alt_contrast_suffix = "",
  alt_cutoff_name = 1,
  isamples = colnames(se),
  normgroup_colname = "Type",
  centerby_colnames = c(normgroup_colname, "Run"),
  controlSamples = NULL,
  control_label = "",
  top_colnames = NULL,
  top_annotation = NULL,
  rowData_colnames = NULL,
  left_annotation = NULL,
  row_split = NULL,
  row_title_rot = 0,
  sample_color_list = NULL,
  row_cex = 0.8,
  column_cex = 1,
  useMedian = FALSE,
  show_row_names = TRUE,
  row_label_colname = NULL,
  cluster_columns = FALSE,
  column_split = NULL,
  color_max = 3,
  lens = 2,
  rename_contrasts = TRUE,
  rename_alt_contrasts = TRUE,
  verbose = FALSE,
  debug = FALSE,
  ...
)
}
\arguments{
\item{se}{\code{SummarizedExperiment} object with accessor functions:
\code{rowData()}, \code{colData()}, and \code{assays()};
or another suitable Bioconductor object with accessor functions:
\code{featureData()}, \code{phenoData()}, and \code{assayData()}.}
}
\description{
Expression heatmap of sestats hits
}
\details{
Note: Still a work in progress.

This function is a bold attempt to automate the intricate task
of creating an expression heatmap, by default using the \code{sestats}
output from \code{se_contrast_stats()}, specifically the \code{hit_array}.

The intent is to display expression values from \code{assays(se)},
centered across all columns, or with customization defined by
\code{centerby_colnames} and \code{normgroup_colnames}.

The top heatmap annotations use \code{colData(se)} with user-supplied
\code{top_colnames} or by auto-detecting those colnames that apply
to multiple \code{colnames(se)}.

The \code{hit_array} data is used to define an incidence matrix of up/down
hits, which is displayed to the left of the heatmap. The contrasts
can optionally be subset with \code{contrast_names}.

The heatmap title is returned as an \code{attr(hm, "hm_title")} that
describes the assay data used, data centering, and total rows
displayed.

For comparison across other \code{sestats} results, argument \code{alt_sestats}
allows supplying an alternative hit array.

Argument \code{sample_color_list} is intended to be the output
from \code{platjam::design2colors()} which will very likely be moved
into this package. It is a named list of named color vectors.
The list names should contain all \code{top_colnames}, and each vector
name should correspond to a value in the relevant column of
\code{colData(se)}. If no colors are defined, \code{ComplexHeatmap::Heatmap()}
will determine its own colors.
}
