% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/jam_collapse_se.R
\name{se_collapse_by_row}
\alias{se_collapse_by_row}
\title{Collapse SummarizedExperiment data by row}
\usage{
se_collapse_by_row(
  se,
  rows = rownames(se),
  row_groups,
  assay_names = NULL,
  group_func_name = c("sum", "weighted.mean", "geomean", "none"),
  rowStatsFunc = NULL,
  rowDataColnames = NULL,
  keepNULLlevels = FALSE,
  delim = "[ ]*[;,]+[ ]*",
  data_transform = c("none", "log2p+sqrt", "log2+sqrt", "log2p", "log2"),
  verbose = TRUE,
  ...
)
}
\arguments{
\item{se}{\code{SummarizedExperiment}}

\item{rows}{\code{character} vector of \code{rows(se)} to use for analysis. When
\code{rows=NULL} the default is to use all \code{rows(se)}.}

\item{row_groups}{\code{character} vector representing groups of rows to
be combined.}

\item{assay_names}{\code{character} vector of \code{names(assays(se))} to use for
the collapse operation. When \code{assay_names=NULL} the default is to
use all \code{assays(se)}.}

\item{group_func_name}{\code{character} name of function used to aggregate
measurement data within \code{row_groups}.}

\item{rowStatsFunc}{\code{function} optional function used instead of
\code{group_func_name}.}

\item{rowDataColnames}{\code{character} subset of colnames in \code{rowData(se)}
to be retained in the output data. Multiple values are combined
usually by comma-delimited concatenation within \code{row_groups},
therefore it may be beneficial to include only relevant columns
in that output.}

\item{keepNULLlevels}{\code{logical} indicating whether to drop unused
factor levels in \code{row_groups}, this argument is passed to
\code{jamba::rowGroupMeans()}.}

\item{delim}{\code{character} string indicating a delimiter.}

\item{data_transform}{\code{character} string indicating which
transformation was used when preparing the assay data. The
assumption is that all assays were transformed by this method.}

\item{verbose}{\code{logical} indicating whether to print verbose output.}

\item{...}{additional arguments are passed to \code{jamba::rowGroupMeans()}.}
}
\description{
Collapse SummarizedExperiment data by row
}
\details{
Purpose is to collapse rows of a \code{SummarizedExperiment} object,
where measurements for a given entity, usually a gene, are split
across multiple rows in the source data. The output of this function
should be measurements appropriately summarized to the gene level.

The driving use case is proteomics mass spectrometry data,
where measurements are described in terms of peptide sequences,
with or without optional post-translational modification (PTM),
and the peptide sequences are annotated to a source protein or gene.
This function can be used to:
\itemize{
\item collapse peptide-PTM data to the peptide level
\item collapse peptide data to the protein level
}

In future it may be used to collapse multiple microarray probe
measurements to the gene level, although that process is more likely
to be useful and recommended after performing probe-level statistical
analysis.
\subsection{Proteomics mass spectrometry analysis}{

For proteomics mass spectrometry data, proteins are inconsistently
fragmented into smaller peptides of varying sizes. The peptides are
usually separated on a chromatography column, from which aliquot
fractions are taken and measured by mass spectrometry. The total
signal derived from the original protein is therefore some combination
of the measured peptide parts.

In some upstream data processing tools, such as Proteomics Discoverer,
and PEAKS, the peptide data may be annotated with observed
modification events (PTM). In this scenario, peptide measurements
are split across multiple rows of data, where each
row represents an observed combination of peptide and PTMs.
}

\subsection{Collapse methods}{

It is fairly straightforward to observe peptide-PTM measurement
data is correlated with overall protein quantification, and that
the specific combination of peptide fragments may be inconsistent
across samples. That is, one may observe five peptides of protein A
in one sample, and may observe seven peptides of protein A in
another sample. The quantities of each peptide may be inconsistent,
due to variability in protein fragmentation across samples. However,
the general sum of peptide measurements is typically fairly stable
across samples, especially for proteins of moderate to high abundance
which are known to have stable abundance per cell.

Choice of method to collapse measurements is not trivial, and is
therefore configurable. In general, proteomics abundances are
analyzed after \code{log2( 1 + x )} transformation. However, measurements
cannot be summed in log2 form, which would be equivalent to
multiplying measurements in normal form. Measurements can be summed
but only after exponentiating the data, for example the reciprocal
\code{( 2 ^ x ) - 1} is sufficient.
}
}
