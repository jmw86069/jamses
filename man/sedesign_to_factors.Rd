% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/jam_sedesign_to_factors.R
\name{sedesign_to_factors}
\alias{sedesign_to_factors}
\title{Convert SEDesign to data.frame of design factors}
\usage{
sedesign_to_factors(
  sedesign,
  se = NULL,
  factor_names = NULL,
  factor_sep = "_",
  default_order = c("appearance", "mixedSort"),
  verbose = FALSE,
  ...
)
}
\arguments{
\item{sedesign}{\code{SEDesign} object}

\item{se}{\code{SummarizedExperiment} object which contains
\code{SummarizedExperiment::colData()} with columns of design annotations.
When present, values in the factor \code{data.frame} will be matched
to values in these columns in order to re-use factor levels
where possible. When \code{factor_names} is not defined, this step
will also re-use the associated colnames from \code{colData(se)}
when the values are matched.}

\item{factor_names}{\code{character} vector of colnames to use for the resulting
design factor colnames.}

\item{factor_sep}{\code{character} string with expected delimiter between
factors, default "_", for example "WT_Treated".}

\item{default_order}{\code{character} string indicating how to order factor
levels when a colname in the factor \code{data.frame} is not a \code{factor}
in the matching \code{colData()} column.
\itemize{
\item \code{"appearance"}: factor levels are defined in the order they
appear in the sample data
\item \code{"mixedSort"}: factor levels are defined by sorting data using
\code{jamba::mixedSort()} which performs proper alphanumeric sorting,
such that "Treat2" appears before "Treat10" for example.
}}

\item{verbose}{\code{logical} indicating whether to print verbose output.}
}
\value{
\code{data.frame} with one column for each experiment design factor,
where each column is converted to \code{factor} for non-numeric columns,
and where colnames are defined as follows:
\itemize{
\item use \code{factor_colnames} when supplied
\item use the corresponding column in \code{colData(se)} when \code{se} is supplied
\item use \code{factor#} format for all other columns
}
}
\description{
Convert SEDesign to data.frame of design factors
}
\details{
This function is a utility function intended to convert \code{SEDesign}
objects, which contain a design matrix, into a \code{data.frame}
representing the experimental design factors used to produce
the design matrix.
}
\examples{
isamples_1 <- paste0(
   rep(c("DMSO", "Etop", "DMSO", "Etop"), each=6),
   "_",
   rep(c("NF", "Flag"), each=12),
   "_",
   rep(c("WT", "KO", "WT", "KO", "WT", "D955N", "WT", "D955N"), each=3),
   "_",
   LETTERS[1:3])
# simple data.frame with group information
idf <- data.frame(jamba::rbindList(strsplit(isamples_1, "_")))[,1:3]
rownames(idf) <- isamples_1;
# convert to sedesign
sedesign <- groups_to_sedesign(idf)
plot_sedesign(sedesign, axis1=2, axis2=3, axis3=1, label_cex=0.5)

# prepare colData data.frame
cdf <- data.frame(check.names=FALSE, stringsAsFactors=FALSE,
   jamba::rbindList(strsplit(isamples_1, "_")))
colnames(cdf) <- c("Treatment", "Flag", "Genotype", "Rep")
rownames(cdf) <- sedesign@samples;
cdf

# prepare assay matrix
imatrix <- matrix(data=seq_len(nrow(cdf) * 10), ncol=nrow(cdf));
colnames(imatrix) <- rownames(cdf);
rownames(imatrix) <- paste0("row", 1:10);
# prepare se
se <- SummarizedExperiment::SummarizedExperiment(
   assays=list(raw=imatrix),
   colData=cdf)

sedesign_to_factors(sedesign, se=se)

# confirm first column contains proper factor order
sedesign_to_factors(sedesign, se=se)[,1]

# demonstrate reverse order of Treatment column levels
SummarizedExperiment::colData(se)$Treatment <- factor(
   SummarizedExperiment::colData(se)$Treatment,
   levels=c("Etop", "DMSO"))
sedesign_to_factors(sedesign, se=se)[,1]

# define Treatment column levels again
SummarizedExperiment::colData(se)$Treatment <- factor(
   SummarizedExperiment::colData(se)$Treatment,
   levels=c("DMSO", "Etop"))
sedesign_to_factors(sedesign, se=se)[,1]

# provide specific colnames to use from se object
sedesign_to_factors(sedesign,
   se=se,
   factor_names=c("Treatment", "Flag", "Genotyoe"))
sedesign_to_factors(sedesign,
   se=se,
   factor_names=c("Treatment", "Flag", "Genotyoe"))[,1]

# substring of colnames(colData(se)) is acceptable
sedesign_to_factors(sedesign,
   factor_names=c("Treat", "Flag", "Genotyoe"),
   se=se)[,1]

}
\seealso{
Other jam experiment design: 
\code{\link{check_sedesign}()},
\code{\link{contrast2comp}()},
\code{\link{contrast_colors_by_group}()},
\code{\link{contrast_names_to_sedesign}()},
\code{\link{contrasts_to_factors}()},
\code{\link{contrasts_to_venn_setlists}()},
\code{\link{draw_oneway_contrast}()},
\code{\link{draw_twoway_contrast}()},
\code{\link{filter_contrast_names}()},
\code{\link{groups_to_sedesign}()},
\code{\link{plot_sedesign}()},
\code{\link{validate_sedesign}()}
}
\concept{jam experiment design}
