% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/jam_dfs_to_sestats.R
\name{list_to_sestats}
\alias{list_to_sestats}
\title{Prepare SEStats from a list of stat data.frame}
\usage{
list_to_sestats(
  stats_dfs,
  use_assay_name = "norm",
  p_cutoff = 1,
  adjp_cutoff = 0.05,
  fold_cutoff = 1.5,
  mgm_cutoff = 0,
  hit_pattern = "hit",
  fold_pattern = "fold",
  lfc_pattern = "^logFC|^log2F|^logfold|^log.fold|^lfc",
  p_pattern = "p.{0,1}val(ue|)",
  adjp_pattern = "adj.{0,1}p.{0,1}val(ue|)|p.{0,1}adj|fdr|q.{0,1}val(ue|)",
  mgm_pattern = "mgm|max.{0,1}group.{0,1}mean",
  contrast_pattern = "^.*[ ]([^ ]+-[^ ]+)$",
  verbose = FALSE,
  ...
)
}
\arguments{
\item{stats_dfs}{\code{list} with one of two formats:
\enumerate{
\item Containing a \code{list} named by \code{assay_names} (signal), which
then contains a \code{list} of \code{data.frame} objects.
\item Containing \code{data.frame} objects.
}

Note: The \code{list} of \code{data.frame} objects can be named by contrast,
and these contrast names will be used if the contrast is not already
encoded in the colnames the corresponding \code{data.frame}.}

\item{use_assay_name}{\code{character} string, default "norm", used when
argument 'stats_dfs' is supplied as a \code{list} of \code{data.frames}
(option 2 described for 'stats_dfs'). In this case, the assay name
will be 'use_assay_name'.}

\item{p_cutoff, adjp_cutoff, fold_cutoff, mgm_cutoff}{\code{numeric} values used
when there is no matching hit column in each \code{data.frame}, matching
the \code{hit_pattern}.}

\item{hit_pattern, fold_pattern, lfc_pattern, p_pattern, adjp_pattern, mgm_pattern}{\code{character} string with regular expression pattern used to match
each corresponding column type: Hit column, fold change, log fold change,
P-value (unadjusted), adjusted P-value (or FDR or Q-value),
max group mean (mgm).
\itemize{
\item The pattern is assumed to be at the start of each column name string.
}}

\item{contrast_pattern}{\code{character} string used to match the contrast
encoded in any of the cutoff columns for the '_pattern' arguments.
\itemize{
\item The pattern is essentially any non-whitespace string that contains
a hyphen '-' inside it. If it also contains a colon ':' the string
is assumed to be a comp (see \code{comp2contrast()}) otherwise it is
considered a contrast name.
\item When present, the contrast is extracted from the column name.
\item When not present, the name from the \code{list} of \code{data.frame} objects
is assumed to be the contrast name.
}}

\item{verbose}{\code{logical} indicating whether to print verbose output.}

\item{...}{additional arguments are ignored.}
}
\value{
\code{list} consistent with \code{se_contrast_stats()} output, except
limited to elements: 'stats_df', 'hit_array', 'hit_list'.
The content should be sufficient for use in \code{heatmap_se()} and
other related functions.
}
\description{
Prepare SEStats from a list of stat data.frame
}
\details{
This function converts a list of stat \code{data.frame} objects
to a \code{list} object as returned by \code{se_contrast_stats()}.
In future this function will return a S4 \code{SEStats} object.
\subsection{Limitations}{

This function only populates certain components:
\itemize{
\item \code{stats_dfs} as a \code{list} by assay_name (signal), with \code{list}
by contrast name with \code{data.frame} objects.
\item \code{hit_array} as a 3-dimension array with 'Cutoffs', 'Contrasts',
and 'Signal' dimensions.
\item \code{hit_list} as a \code{list} by assay name (signal), with \code{list} by
contrast names, containing \code{numeric} values named by measurement.
}

This function does not return certain data which is not described
in a \code{list} of \code{data.frame} objects:
\itemize{
\item \code{idesign}, \code{icontrasts}, \code{normgroup} cannot be defined or inferred.
}

Other limitations:
\itemize{
\item \code{stats_df} with the combined stats across contrasts as
one wide \code{data.frame}, is not created, partly because it does not
assume the contrast name is included in each corresponding
stat colname in each \code{data.frame}. Potential future enhancement.
}
}

\subsection{Rules Used}{

In each \code{data.frame} certain colnames are recognized:
\itemize{
\item The hit columns is recognized by one or more colnames
that begin with \code{"hit "}. The hit column should have values
of \code{-1}, \code{0}, or \code{1} to indicate whether the row met the
statistical criteria. Typically the statistical criteria
are also included in the column header, followed by the
contrast name.
\itemize{
\item If there is no hit column, the arguments '_cutoff' are applied
to each row, and a new hit column is created accordingly.
If there are multiple cutoff values, multiple hit columns are
created.
}
\item Fold change column is recognized by a column beginning \code{"fold "}
(with space), typically followed by the contrast name. For example
\code{"fold Dex-Ctrl"}.
\itemize{
\item If no fold change column exists, it searches for log fold column,
specifically assumed to be log2 fold change even when \code{"logFC"}.
By convention, edgeR and limma use \code{"logFC"} for log2 fold change.
\item If neither fold change, nor log fold change, columns are found,
this function stops.
\item The log2 fold change is converted to normal fold change for
filtering.
}
\item The raw P-value column should begin \code{"P-Value "} or any variation
of "pval", "p.val", "pvalue", "p.value", case-insensitive.
\item The adjusted P-value column should begin \code{"adj-P-Val "} or any variation
of "adjp", "padj", "pvalue", "p.value", case-insensitive.
}
}
}
\seealso{
Other jamses utilities: 
\code{\link{choose_annotation_colnames}()},
\code{\link{combine_sestats}()},
\code{\link{contrast2comp_dev}()},
\code{\link{fold_to_log2fold}()},
\code{\link{intercalate}()},
\code{\link{list2im_opt}()},
\code{\link{log2fold_to_fold}()},
\code{\link{make_block_arrow_polygon}()},
\code{\link{mark_stat_hits}()},
\code{\link{matrix_normalize}()},
\code{\link{merge_statdf_all_test}()},
\code{\link{point_handedness}()},
\code{\link{point_slope_intercept}()},
\code{\link{shortest_unique_abbreviation}()},
\code{\link{shrinkDataFrame}()},
\code{\link{shrink_df}()},
\code{\link{shrink_matrix}()},
\code{\link{sort_samples}()},
\code{\link{strsplitOrdered}()},
\code{\link{sub_split_vector}()},
\code{\link{update_function_params}()},
\code{\link{update_list_elements}()}
}
\concept{jamses utilities}
