% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/jam_secontrasts.R
\name{se_contrast_stats}
\alias{se_contrast_stats}
\title{Compute contrast statistics on SummarizedExperiment data}
\usage{
se_contrast_stats(
  se,
  assay_names,
  adjp_cutoff = 0.05,
  p_cutoff = NULL,
  fold_cutoff = 1.5,
  int_adjp_cutoff = adjp_cutoff,
  int_p_cutoff = p_cutoff,
  int_fold_cutoff = fold_cutoff,
  mgm_cutoff = NULL,
  ave_cutoff = NULL,
  confint = FALSE,
  floor_min = NULL,
  floor_value = NULL,
  icontrasts = NULL,
  idesign = NULL,
  igenes = NULL,
  isamples = NULL,
  enforce_design = TRUE,
  use_voom = FALSE,
  weights = NULL,
  robust = FALSE,
  handle_na = c("partial", "full", "none"),
  collapse_by_gene = FALSE,
  block = NULL,
  correlation = NULL,
  verbose = FALSE,
  ...
)
}
\arguments{
\item{se}{\code{SummarizedExperiment} object}

\item{assay_names}{\code{character} vector with one or more assay names
from \code{names(assays(se))}.}
}
\description{
Compute contrast statistics on SummarizedExperiment data
}
\details{
This function is essentially a wrapper around statistical methods
in the \code{limma} package, with additional steps to apply statistical
thresholds to define "statistical hits" by three main criteria:
\itemize{
\item P-value or adjusted P-value
\item fold change
\item max group mean
}

This function is unique in that it applies the statistical methods
to one or more "signals" in the input \code{SummarizedExperiment} assays,
specifically intended to compare things like normalization methods.

If multiple statistical thresholds are defined, each one is applied
in order, which is specifically designed to compare the effect of
applying different statistical thresholds. For example one may want
to pre-compute "statistical hits" using adjusted P-value 0.05, and 0.01;
or using fold change >= 1.5, or fold change >= 2.0. The underlying
statistics are the same, but a column indicating hits is created
for each set of thresholds.

Hits are annotated:
\itemize{
\item \code{-1} for down-regulation
\item \code{0} for un-changed (by the given criteria)
\item \code{1} for up-regulation
}

The results are therefore intended to feed directional Venn
diagrams, which display the overlapping gene hits, and whether the
directions are shared or opposed.

This function can optionally apply the limma-voom workflow,
which involves calculating matrix weights using \code{limma::voom()},
then applying those weights during the model fit.

The output is intended to include several convenient formats:
\itemize{
\item \code{statsDFs} - list of \code{data.frame} stats one per contrast
\item \code{statsDF} - one \code{data.frame} with all stats together
\item \code{statsHitsA} - \code{array} with three dimensions: signal; contrast; threshold
whose cells contain hit flags (-1, 0, 1) named by \code{rownames(se)}.
}

Design and contrast matrices can be defined using the function
\code{splicejam::groups2contrasts()}. That function assigns each sample
to a sample group, then assembles all relevant group contrasts
which involve only one-factor contrast at a time. It optionally
defines two-factor contrasts (contrast of contrasts) where
applicable.

A subset of genes (\code{rownames(se)}) or samples (\code{colnames(se)}) can
be defined, to restrict calculations to use only the subset data.
}
\seealso{
Other jamses stats: 
\code{\link{ebayes2dfs}()},
\code{\link{handle_na_values}()},
\code{\link{matrix_normalize}()},
\code{\link{run_limma_replicate}()},
\code{\link{se_normalize}()},
\code{\link{voom_jam}()}
}
\concept{jamses stats}
