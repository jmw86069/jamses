% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/jam_collapse_by_column.R
\name{se_collapse_by_column}
\alias{se_collapse_by_column}
\title{Collapse SummarizedExperiment data by column}
\usage{
se_collapse_by_column(
  se,
  columns = colnames(se),
  column_groups,
  assay_names = NULL,
  colDataColnames = colnames(SummarizedExperiment::colData(se)),
  keepNULLlevels = FALSE,
  groupFunc = jamba::rowGroupMeans,
  noise_floor = 0,
  noise_floor_value = 0,
  rmOutliers = FALSE,
  madFactor = 5,
  useMedian = FALSE,
  verbose = FALSE,
  ...
)
}
\arguments{
\item{se}{\code{SummarizedExperiment} object}

\item{columns}{\code{character} vector of \code{colnames(se)} to include in the
process.}

\item{column_groups}{\code{character} vector of column groupings, or
\code{character} vector of \code{colnames(colData(se))} used to define the
column groupings.}

\item{assay_names}{\code{character} vector with one or more \code{assayNames(se)}
to apply the column grouping calculation defined in \code{groupFunc}.
By default, all assay names in \code{assayNames(se)} are used.}

\item{colDataColnames}{\code{character} vector of \code{colData(se)} colnames to
be included in the returned \code{SummarizedExperiment} after the column
grouping. This argument is used to subset the columns, in cases where
some columns do not need to be combined and returned in the output
data.}

\item{keepNULLlevels}{\code{logical} indicating whether to return empty columns
when there are not factor levels present in the data. This option is
intended when \code{column_group} references a \code{factor} type, whose factor
levels are not present in the current data, using \code{columns}. When
\code{keepNULLlevels=TRUE} any missing levels will be present with \code{NA}
values, which can be helpful for generating a consistent output.}

\item{groupFunc}{\code{function} used to perform row group calculations on a
\code{numeric} matrix. The default is passed to \code{jamba::rowGroupMeans()},
but can be substituted with another row-based function.
It must accept arguments \code{x} and \code{groups}, but the other arguments
are passed only if \code{groupFunc} permits these argument names, or \code{...}:
\itemize{
\item \code{x} as a \code{numeric} matrix (required),
\item \code{groups} as a \code{character} vector of column groups, in order of
\code{colnames(x)} (required)
\item \code{rmOutliers} a \code{logical} indicating whether to apply outlier removal,
though the function can ignore this value (optional).
\item \code{madFactor} a \code{numeric} value indicating the MAD threshold used when
\code{rmOutliers=TRUE}; though again the function can ignore this value
(optional).
\item \code{useMedian=FALSE} is \code{logical} and when \code{useMedian=FALSE} it disables
calculating the \code{median()} value per group, and instead takes the
group \code{mean()} value.
\item \code{...} additional arguments in \code{...} will be passed only if permitted
by \code{groupFunc}.
}}

\item{noise_floor}{\code{numeric} value indicating the minimum numeric value
permitted, \emph{at or below} this value will be replaced with
\code{noise_floor_value}.
The default value \code{noise_floor=0} will therefore change all values
at or below zero to \code{noise_floor_value=0} by default.
Another alternative is to change abnormally low
values such as zero \code{0} to \code{NA} so these values are not
treated as actual measurements during the group summary calculation.
This value and the replacement should be adjusted
with caution. Use \code{noise_floor=NULL} or \code{noise_floor=-Inf} to disable
this step.}

\item{noise_floor_value}{\code{numeric} or \code{NA} used as a replacement for
\code{numeric} values \emph{at or below} \code{noise_floor}, which occurs prior to
calling the \code{groupFunc} summary calculation.}

\item{rmOutliers, madFactor}{\code{logical} and \code{numeric}, respectively, passed
to \code{groupFunc} which by default is \code{jamba::rowGroupMeans()}.}

\item{useMedian}{\code{logical} passed to argument \code{groupFunc()}, intended
to be used by \code{jamba::rowGroupMeans()} to specify taking the mean
and not the median value per row group.}

\item{verbose}{\code{logical} indicating whether to print verbose output.}

\item{...}{additional arguments are passed through \code{groupFunc}.}
}
\value{
\code{SummarizedExperiment} object with these changes:
\itemize{
\item columns will be collapsed by \code{column_groups}, for each \code{assays(se)}
\code{numeric} matrix defined by \code{assay_names}.
\item \code{colData(se)} will also be collapsed by \code{shrinkDataFrame()} to
combine unique values from each column annotation.
}
}
\description{
Collapse SummarizedExperiment data by column
}
\details{
Purpose is to collapse columns of a \code{SummarizedExperiment} object,
where measurements for a given entity, usually a gene, are split
across multiple rows in the source data. The output of this function
should be measurements appropriately summarized to the gene level.

The driving use case is slightly different than with \code{se_collapse_by_row()},
in this case the function is mostly convenient method to calculate
group mean values in context of a \code{SummarizedExperiment} object,
so it can be used with \code{jamses::heatmap_se()} for example.

This function retains associated column annotations \code{colData(se)},
after combining multiple values in an appropriate manner.

Optionally, this function will detect and remove individual outlier
values before calculating the group mean.
}
\seealso{
Other jamses utilities: 
\code{\link{fold_to_log2fold}()},
\code{\link{log2fold_to_fold}()},
\code{\link{mark_stat_hits}()},
\code{\link{se_collapse_by_row}()},
\code{\link{se_rbind}()},
\code{\link{shortest_unique_abbreviation}()},
\code{\link{shrinkDataFrame}()},
\code{\link{shrink_df}()},
\code{\link{strsplitOrdered}()},
\code{\link{sub_split_vector}()},
\code{\link{update_function_params}()},
\code{\link{update_list_elements}()}
}
\concept{jamses utilities}
