% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/jam_secontrasts.R
\name{ebayes2dfs}
\alias{ebayes2dfs}
\title{Convert limma eBayes fit to data.frame with annotated hits}
\usage{
ebayes2dfs(
  lmFit3 = NULL,
  lmFit1 = NULL,
  lmFit4 = NULL,
  define_hits = TRUE,
  adjp_cutoff = 0.05,
  p_cutoff = NULL,
  fold_cutoff = 1.5,
  int_adjp_cutoff = adjp_cutoff,
  int_p_cutoff = p_cutoff,
  int_fold_cutoff = fold_cutoff,
  mgm_cutoff = NULL,
  ave_cutoff = NULL,
  confint = FALSE,
  use_cutoff_colnames = TRUE,
  rename_headers = TRUE,
  return_fold = TRUE,
  merge_df = FALSE,
  include_ave_expr = FALSE,
  include_group_means = TRUE,
  transform_means = c("none", "exp2signed", "10^"),
  rowData_df = NULL,
  collapse_by_gene = FALSE,
  rename_contrasts = FALSE,
  sep = " ",
  int_grep = "[(].+-.+-.+[)]|-.+-",
  trim_colnames = c("t", "B", "F", "sca.t"),
  posthoc_test = c("none", "DEqMS"),
  verbose = FALSE,
  ...
)
}
\arguments{
\item{lmFit3}{object returned by \code{limma::eBayes()}.}

\item{lmFit1}{object returned by \code{limma::lmFit()}, optional.}

\item{lmFit4}{object returned by \code{posthoc_test="DEqMS"} in
\code{run_limma_replicate()}.}

\item{define_hits}{\code{logical} indicating whether to define hits
using the statistical thresholds.}

\item{adjp_cutoff, p_cutoff, fold_cutoff, mgm_cutoff, ave_cutoff}{\code{numeric}
values representing the appropriate statistical threshold,
or \code{NULL} when a threshold should not be applied.}

\item{int_adjp_cutoff, int_p_cutoff, int_fold_cutoff}{\code{numeric}
thresholds to apply only to interaction contrasts.}

\item{confint}{\code{logical} passed to \code{limma::topTable()}, which defines
whether to return confidence intervals for each log2 fold change.}

\item{use_cutoff_colnames}{\code{logical} whether to include the
statistical thresholds abbreviated in the \code{"hit"} colname,
when \code{define_hits=TRUE}.}

\item{rename_headers}{\code{logical} indicating whether to rename
statistical colnames returned by \code{limma::topTable()} to the
colnames include the contrast name.}

\item{return_fold}{\code{logical} whether to return an additional column
with the signed fold change, see \code{log2fold_to_fold()}.}

\item{merge_df}{\code{logical} indicating whether to merge the final
\code{data.frame} list into one \code{data.frame}.}

\item{include_ave_expr}{\code{logical} indicating whether to retain
the column \code{"AveExpr"}. This column can be misleading, especially
if the \code{mgm} (max group mean) threshold is used when determining
statistical hits. This column is mainly useful in reviewing limma
output, since it uses the \code{"AveExpr"} values to apply its moderated
variance statistic.}

\item{include_group_means}{\code{logical} indicating whether to include each
group mean along with the relevant contrast. These values are
helpful, in that they should exactly represent the reported \code{logFC}
value. Sometimes it is helpful and comforting to see the exact values
used in that calculation.}

\item{rowData_df}{\code{data.frame} representing optional rowData annotation
to be retained in the resulting stat \code{data.frame}. This argument
is usually defined using \code{rowData_colnames} in \code{se_contrast_stats()},
which uses corresponding columns from \code{rowData(se)}.}

\item{collapse_by_gene}{\code{logical} indicating whether to apply
\code{collapse_stats_by_gene} which chooses one "best" exemplar per gene
when there are multiple rows that represent the same gene.}

\item{rename_contrasts}{\code{logical} (inactive) which will in future allow
for automated renaming of contrasts.}

\item{sep}{\code{character} string used as a delimiter in certain output
colnames.}

\item{int_grep}{\code{character} string used to recognize contrasts which
are considered "interaction contrasts". The default pattern recognizes
any contrasts that contain multiple fold changes, recognized by the
presence of more than one hypen \code{"-"} in the contrast name.}

\item{verbose}{\code{logical} indicating whether to print verbose output.}
}
\value{
\code{list} with one \code{data.frame} per contrast defined in
the input \code{lmFit3} object. When \code{define_hits=TRUE} there
will be one column per statistical threshold, named \code{"hit"}
followed by an abbreviation of the statistical thresholds
which were applied.
When \code{merge_df=TRUE} the returned data will be one
\code{data.frame} object.
}
\description{
Convert limma eBayes fit to data.frame with annotated hits
}
\details{
This function is called by \code{run_limma_replicate()} as
an extension to \code{limma::topTable()}, that differs in that
it is performed for each contrast in the input \code{lmFit3} object.

By default the columns include the contrast, so that each \code{data.frame}
is self-described.

When \code{define_hits=TRUE}, then statistical thresholds are applied
to define a set of statistical hits. The thresholds available include:
\enumerate{
\item \code{adjp_cutoff} - applied to \code{"adj.P.Val"} for adjusted P-value.
\item \code{p_cutoff} - applied to \code{"P.Value"} for raw, unadjusted P-value.
\item \code{fold_cutoff} - normal space fold change, applied to \code{"logFC"}
by using \code{log2(fold_cutoff)}.
\item \code{mgm_cutoff} - max group mean, applied to the highest group mean
value involved in each specific contrast.
\item \code{ave_cutoff} - applied to \code{"AveExpr"} which represents the mean
value across all sample groups.
}

Note that \code{mgm_cutoff} requires input \code{lmFit1} which stores the
group mean values used in the limma workflow.

Note also there are optional arguments specific to interaction
contrasts, which in this context is assumed to be a
"fold change of fold changes" style of contrast, for example:
\code{(groupA-groupB)-(groupC-groupD)}. The purpose is distinct interaction
thresholds is to enable reasonable data mining, sometimes with
somewhat more lenient thresholds for interaction contrasts.
For example, one may use \code{adjp_cutoff=0.01} and \code{int_adjp_cutoff=0.05},
or \code{fold_cutoff=2} and \code{int_fold_cutoff=1.5}.

By default, \code{rename_headers=TRUE} causes colnames to include the
contrast, for example renaming colname \code{"logFC"} to \code{"logFC contrastA"}.
This change helps reinforce the source of the statistical results,
and allows the \code{data.frame} results to be merged together using
\code{base::merge()}.

Indeed, \code{merge_df=TRUE} will cause all \code{data.frame} results to be
merged into one large \code{data.frame}, using \code{jamba::mergeAllXY()}.
}
\seealso{
Other jamses stats: 
\code{\link{format_hits}()},
\code{\link{handle_na_values}()},
\code{\link{hit_array_to_list}()},
\code{\link{process_sestats_to_hitim}()},
\code{\link{run_limma_replicate}()},
\code{\link{save_sestats}()},
\code{\link{se_contrast_stats}()},
\code{\link{sestats_to_dfs}()},
\code{\link{sestats_to_df}()},
\code{\link{voom_jam}()}
}
\concept{jamses stats}
